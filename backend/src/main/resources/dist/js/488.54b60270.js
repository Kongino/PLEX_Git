(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[488],{4910:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container",attrs:{id:"main-container"}},[e.session?e._e():t("div",{attrs:{id:"join"}},[e._m(0),t("div",{staticClass:"jumbotron vertical-center",attrs:{id:"join-dialog"}},[t("h1",[e._v("Join a video session")]),t("div",{staticClass:"form-group"},[t("p",[t("label",[e._v("Participant")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.myUserName,expression:"myUserName"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:e.myUserName},on:{input:function(t){t.target.composing||(e.myUserName=t.target.value)}}})]),t("p",[t("label",[e._v("Session")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.mySessionId,expression:"mySessionId"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:e.mySessionId},on:{input:function(t){t.target.composing||(e.mySessionId=t.target.value)}}})]),t("p",{staticClass:"text-center"},[t("button",{staticClass:"btn btn-lg btn-success",on:{click:function(t){return e.joinSession()}}},[e._v("Join!")])])])])]),e.session?t("div",{attrs:{id:"session"}},[t("div",{attrs:{id:"session-header"}},[t("h1",{attrs:{id:"session-title"}},[e._v(e._s(e.mySessionId))]),t("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"Leave session"},on:{click:e.leaveSession}}),e.videoMute?e._e():t("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"비디오 중지"},on:{click:e.videoControl}}),e.videoMute?t("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"비디오 시작"},on:{click:e.videoControl}}):e._e(),e.audioMute?e._e():t("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"오디오 중지"},on:{click:e.audioControl}}),e.audioMute?t("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"오디오 시작"},on:{click:e.audioControl}}):e._e(),t("input",{directives:[{name:"model",rawName:"v-model",value:e.msg,expression:"msg"}],attrs:{type:"text"},domProps:{value:e.msg},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMSG.apply(null,arguments)},input:function(t){t.target.composing||(e.msg=t.target.value)}}}),t("h1",[e._v("팀 점수")]),t("h2",[e._v("team1 "+e._s(e.score1))]),t("h2",[e._v("team2 "+e._s(e.score2))])]),t("div",{staticClass:"col-md-6",attrs:{id:"main-video"}},[t("user-video",{attrs:{"stream-manager":e.mainStreamManager}}),t("canvas",{staticStyle:{display:"none"},attrs:{id:"main-video-canvas"}})],1),t("div",{attrs:{id:"label-container"}}),t("div",{staticClass:"col-md-6",attrs:{id:"video-container"}},[t("user-video",{attrs:{"stream-manager":e.publisher},nativeOn:{click:function(t){return e.updateMainVideoStreamManager(e.publisher)}}}),e._l(e.subscribers,(function(n){return t("user-video",{key:n.stream.connection.connectionId,attrs:{"stream-manager":n},nativeOn:{click:function(t){return e.updateMainVideoStreamManager(n)}}})}))],2)]):e._e(),e.session?t("div",[t("h2",[e._v("채팅")]),e._l(e.chat,(function(n){return t("p",{key:n},[e._v(e._s(n))])})),t("h1",[e._v("개인 점수")]),e._l(e.personalScore,(function(n,r){return t("p",{key:r},[e._v(e._s(n))])}))],2):e._e()])},i=[function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"img-div"}},[t("img",{attrs:{src:n(9713)}})])}],o=(n(6699),n(9669)),s=n.n(o),a=n(4905),c=function(){var e=this,t=e._self._c;return e.streamManager?t("div",[t("ov-video",{attrs:{"stream-manager":e.streamManager}}),t("div",[t("p",[e._v(e._s(e.clientData))])])],1):e._e()},u=[],d=function(){var e=this,t=e._self._c;return t("video",{attrs:{autoplay:""}})},l=[],p={name:"OvVideo",props:{streamManager:Object},mounted(){this.streamManager.addVideoElement(this.$el)}},h=p,f=n(1001),m=(0,f.Z)(h,d,l,!1,null,null,null),v=m.exports,g={name:"UserVideo",components:{OvVideo:v},props:{streamManager:Object},computed:{clientData(){const{clientData:e}=this.getConnectionData();return e}},methods:{getConnectionData(){const{connection:e}=this.streamManager.stream;return JSON.parse(e.data.split("%/%")[0])}}},b=g,E=(0,f.Z)(b,c,u,!1,null,null,null),y=E.exports;s().defaults.headers.post["Content-Type"]="application/json";const S="https://teachablemachine.withgoogle.com/models/w6iITyYRf/";let w,O,C,R,I;var k={name:"App",components:{UserVideo:y},data(){return{OV:void 0,session:void 0,mainStreamManager:void 0,publisher:void 0,subscribers:[],mySessionId:"SessionA",myUserName:"Participant"+Math.floor(100*Math.random()),videoMute:!1,audioMute:!1,msg:"",chat:[],status:0,team1:["a","b","c"],team2:["d","e","f"],personalScore:{a:0,b:0,c:0,d:0,e:0,f:0},score1:0,score2:0}},methods:{sendMSG(){this.session.signal({data:`${this.myUserName} : ${this.msg}`,to:[],type:"my-chat"}).then((()=>{console.log("Message successfully sent")})).catch((e=>{console.error(e)})),this.msg=""},joinSession(){this.OV=new a.Dn,this.session=this.OV.initSession(),this.session.on("streamCreated",(({stream:e})=>{const t=this.session.subscribe(e);this.subscribers.push(t)})),this.session.on("streamDestroyed",(({stream:e})=>{const t=this.subscribers.indexOf(e.streamManager,0);t>=0&&this.subscribers.splice(t,1)})),this.session.on("exception",(({exception:e})=>{console.warn(e)})),this.session.on("signal:my-chat",(e=>{console.log(`메시지 수신: ${e.data}`),this.chat.push(e.data),console.log(e.from),console.log(e.type)})),this.session.on("signal:score",(e=>{console.log(e.data),this.team1.includes(e.data)?this.score1+=1:this.score2+=1,this.personalScore[`${e.data}`]+=1,console.log(e.from),console.log(e.type)})),this.getToken(this.mySessionId,this.myUserName),this.init(),window.addEventListener("beforeunload",this.leaveSession)},leaveSession(){this.session&&this.session.disconnect(),this.session=void 0,this.mainStreamManager=void 0,this.publisher=void 0,this.subscribers=[],this.OV=void 0,window.removeEventListener("beforeunload",this.leaveSession)},updateMainVideoStreamManager(e){this.mainStreamManager!==e&&(this.mainStreamManager=e)},videoControl(){this.videoMute?(this.publisher.publishVideo(!0),this.videoMute=!1):(this.publisher.publishVideo(!1),this.videoMute=!0)},audioControl(){this.audioMute?(this.publisher.publishAudio(!0),this.audioMute=!1):(this.publisher.publishAudio(!1),this.audioMute=!0)},async init(){const e=S+"model.json",t=S+"metadata.json";w=await tmPose.load(e,t),I=w.getTotalClasses();const n=!0;O=new tmPose.Webcam(200,200,n),await O.setup(),O.play(),window.requestAnimationFrame(this.loop);const r=document.getElementById("main-video-canvas");r.width=200,r.height=200,C=r.getContext("2d"),R=document.getElementById("label-container");for(let i=0;i<I;i++)R.appendChild(document.createElement("div"))},async loop(e){O.update(),await this.predict(),window.requestAnimationFrame(this.loop)},async predict(){const{pose:e,posenetOutput:t}=await w.estimatePose(O.canvas),n=await w.predict(t);n[0].probability.toFixed(2)>=.99?(1==this.status&&this.session.signal({data:this.myUserName,to:[],type:"score"}).then((()=>{console.log("Message successfully sent")})).catch((e=>{console.error(e)})),this.status=0):n[1].probability.toFixed(2)>=.99&&(this.status=1);for(let r=0;r<I;r++){const e=n[r].className+": "+n[r].probability.toFixed(2);R.childNodes[r].innerHTML=e}},drawPose(e){if(C.drawImage(O.canvas,0,0),e){const t=.5;tmPose.drawKeypoints(e.keypoints,t,C),tmPose.drawSkeleton(e.keypoints,t,C)}},getToken(e,t){s().post("https://localhost:8080/api/v1/rooms/get-token",{sessionName:e,id:t}).then((e=>{console.log(e.data[0]);const t=e.data[0];this.session.connect(t,{clientData:this.myUserName}).then((()=>{let e=this.OV.initPublisher(void 0,{audioSource:void 0,videoSource:void 0,publishAudio:!0,publishVideo:!0,resolution:"640x480",frameRate:30,insertMode:"APPEND",mirror:!0});this.mainStreamManager=e,console.log(this.mainStreamManager),this.publisher=e,this.session.publish(this.publisher)})).catch((e=>{console.log("There was an error connecting to the session:",e.code,e.message)}))}))}}},x=k,P=(0,f.Z)(x,r,i,!1,null,null,null),T=P.exports},9669:function(e,t,n){e.exports=n(1609)},5448:function(e,t,n){"use strict";var r=n(4867),i=n(6026),o=n(4372),s=n(5327),a=n(4097),c=n(4109),u=n(7985),d=n(5061);e.exports=function(e){return new Promise((function(t,n){var l=e.data,p=e.headers;r.isFormData(l)&&delete p["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";p.Authorization="Basic "+btoa(f+":"+m)}var v=a(e.baseURL,e.url);if(h.open(e.method.toUpperCase(),s(v,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in h?c(h.getAllResponseHeaders()):null,o=e.responseType&&"text"!==e.responseType?h.response:h.responseText,s={data:o,status:h.status,statusText:h.statusText,headers:r,config:e,request:h};i(t,n,s),h=null}},h.onabort=function(){h&&(n(d("Request aborted",e,"ECONNABORTED",h)),h=null)},h.onerror=function(){n(d("Network Error",e,null,h)),h=null},h.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(d(t,e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var g=(e.withCredentials||u(v))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;g&&(p[e.xsrfHeaderName]=g)}if("setRequestHeader"in h&&r.forEach(p,(function(e,t){"undefined"===typeof l&&"content-type"===t.toLowerCase()?delete p[t]:h.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),e.responseType)try{h.responseType=e.responseType}catch(b){if("json"!==e.responseType)throw b}"function"===typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),n(e),h=null)})),l||(l=null),h.send(l)}))}},1609:function(e,t,n){"use strict";var r=n(4867),i=n(1849),o=n(321),s=n(7185),a=n(5655);function c(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var u=c(a);u.Axios=o,u.create=function(e){return c(s(u.defaults,e))},u.Cancel=n(5263),u.CancelToken=n(4972),u.isCancel=n(6502),u.all=function(e){return Promise.all(e)},u.spread=n(8713),u.isAxiosError=n(6268),e.exports=u,e.exports["default"]=u},5263:function(e){"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:function(e,t,n){"use strict";var r=n(5263);function i(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e,t=new i((function(t){e=t}));return{token:t,cancel:e}},e.exports=i},6502:function(e){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:function(e,t,n){"use strict";var r=n(4867),i=n(5327),o=n(782),s=n(3572),a=n(7185);function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"===typeof e?(e=arguments[1]||{},e.url=arguments[0]):e=e||{},e=a(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[s,void 0],n=Promise.resolve(e);this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));while(t.length)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=a(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,r){return this.request(a(r||{},{method:e,url:t,data:n}))}})),e.exports=c},782:function(e,t,n){"use strict";var r=n(4867);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},4097:function(e,t,n){"use strict";var r=n(1793),i=n(7303);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},5061:function(e,t,n){"use strict";var r=n(481);e.exports=function(e,t,n,i,o){var s=new Error(e);return r(s,t,n,i,o)}},3572:function(e,t,n){"use strict";var r=n(4867),i=n(8527),o=n(6502),s=n(5655);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){a(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]}));var t=e.adapter||s.adapter;return t(e).then((function(t){return a(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(a(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:function(e){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},7185:function(e,t,n){"use strict";var r=n(4867);e.exports=function(e,t){t=t||{};var n={},i=["url","method","data"],o=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function u(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=c(void 0,e[i])):n[i]=c(e[i],t[i])}r.forEach(i,(function(e){r.isUndefined(t[e])||(n[e]=c(void 0,t[e]))})),r.forEach(o,u),r.forEach(s,(function(i){r.isUndefined(t[i])?r.isUndefined(e[i])||(n[i]=c(void 0,e[i])):n[i]=c(void 0,t[i])})),r.forEach(a,(function(r){r in t?n[r]=c(e[r],t[r]):r in e&&(n[r]=c(void 0,e[r]))}));var d=i.concat(o).concat(s).concat(a),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return r.forEach(l,u),n}},6026:function(e,t,n){"use strict";var r=n(5061);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},8527:function(e,t,n){"use strict";var r=n(4867);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},5655:function(e,t,n){"use strict";var r=n(4867),i=n(6016),o={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function a(){var e;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(e=n(5448)),e}var c={adapter:a(),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"===typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(o)})),e.exports=c},1849:function(e){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},5327:function(e,t,n){"use strict";var r=n(4867);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var s=[];r.forEach(t,(function(e,t){null!==e&&"undefined"!==typeof e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))})))})),o=s.join("&")}if(o){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},7303:function(e){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:function(e,t,n){"use strict";var r=n(4867);e.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,n,i,o,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},1793:function(e){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},6268:function(e){"use strict";e.exports=function(e){return"object"===typeof e&&!0===e.isAxiosError}},7985:function(e,t,n){"use strict";var r=n(4867);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return function(){return!0}}()},6016:function(e,t,n){"use strict";var r=n(4867);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},4109:function(e,t,n){"use strict";var r=n(4867),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,s={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(s[t]&&i.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},8713:function(e){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},4867:function(e,t,n){"use strict";var r=n(1849),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function s(e){return"undefined"===typeof e}function a(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function c(e){return"[object ArrayBuffer]"===i.call(e)}function u(e){return"undefined"!==typeof FormData&&e instanceof FormData}function d(e){var t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer,t}function l(e){return"string"===typeof e}function p(e){return"number"===typeof e}function h(e){return null!==e&&"object"===typeof e}function f(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function m(e){return"[object Date]"===i.call(e)}function v(e){return"[object File]"===i.call(e)}function g(e){return"[object Blob]"===i.call(e)}function b(e){return"[object Function]"===i.call(e)}function E(e){return h(e)&&b(e.pipe)}function y(e){return"undefined"!==typeof URLSearchParams&&e instanceof URLSearchParams}function S(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function w(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function O(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),o(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function C(){var e={};function t(t,n){f(e[n])&&f(t)?e[n]=C(e[n],t):f(t)?e[n]=C({},t):o(t)?e[n]=t.slice():e[n]=t}for(var n=0,r=arguments.length;n<r;n++)O(arguments[n],t);return e}function R(e,t,n){return O(t,(function(t,i){e[i]=n&&"function"===typeof t?r(t,n):t})),e}function I(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}e.exports={isArray:o,isArrayBuffer:c,isBuffer:a,isFormData:u,isArrayBufferView:d,isString:l,isNumber:p,isObject:h,isPlainObject:f,isUndefined:s,isDate:m,isFile:v,isBlob:g,isFunction:b,isStream:E,isURLSearchParams:y,isStandardBrowserEnv:w,forEach:O,merge:C,extend:R,trim:S,stripBOM:I}},7187:function(e){"use strict";var t,n="object"===typeof Reflect?Reflect:null,r=n&&"function"===typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function i(e){console&&console.warn&&console.warn(e)}t=n&&"function"===typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!==e};function s(){s.init.call(this)}e.exports=s,e.exports.once=b,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function c(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var o,s,a;if(c(n),s=e._events,void 0===s?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),void 0===a)a=s[t]=n,++e._eventsCount;else if("function"===typeof a?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),o=u(e),o>0&&a.length>o&&!a.warned){a.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=a.length,i(d)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?g(i):m(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function g(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function b(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&E(e,i,{once:!0})}))}function E(e,t,n){"function"===typeof e.on&&y(e,"error",t,n)}function y(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!==typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"===typeof c)r(c,this,t);else{var u=c.length,d=m(c,u);for(n=0;n<u;++n)r(d[n],this,t)}return!0},s.prototype.addListener=function(e,t){return d(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return d(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,o,s;if(c(t),r=this._events,void 0===r)return this;if(n=r[e],void 0===n)return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():v(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)i=o[r],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],"function"===typeof t)this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},s.prototype.listenerCount=f,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},8483:function(e,t,n){"use strict";var r=n(7879),i=function(e){var t,i={stun:(e||{}).stun||n(8808),turn:(e||{}).turn||n(4576)},o=(e||{}).stunCount||2,s=(e||{}).turnCount||0;function a(e,t){var n,o=[],s=[].concat(i[e]);while(s.length&&o.length<t)n=Math.random()*s.length|0,o=o.concat(s.splice(n,1));return o.map((function(t){return"string"===typeof t||t instanceof String?r(e+":"+t):t}))}return t=[].concat(a("stun",o)),s&&(t=t.concat(a("turn",s))),t};e.exports=i},8233:function(e,t,n){var r,i=n(4114);function o(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,i=t.length;r<i;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}"undefined"!==typeof window&&(r=window.AudioContext||window.webkitAudioContext);var s=null;e.exports=function(e,t){var n=new i;if(!r)return n;t=t||{};var a,c,u,d=t.smoothing||.1,l=t.interval||50,p=t.threshold,h=t.play,f=t.history||10,m=!0;s=t.audioContext||s||new r,u=s.createAnalyser(),u.fftSize=512,u.smoothingTimeConstant=d,c=new Float32Array(u.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(a=s.createMediaElementSource(e),"undefined"===typeof h&&(h=!0),p=p||-50):(a=s.createMediaStreamSource(e),p=p||-50),a.connect(u),h&&u.connect(s.destination),n.speaking=!1,n.suspend=function(){return s.suspend()},n.resume=function(){return s.resume()},Object.defineProperty(n,"state",{get:function(){return s.state}}),s.onstatechange=function(){n.emit("state_change",s.state)},n.setThreshold=function(e){p=e},n.setInterval=function(e){l=e},n.stop=function(){m=!1,n.emit("volume_change",-100,p),n.speaking&&(n.speaking=!1,n.emit("stopped_speaking")),u.disconnect(),a.disconnect()},n.speakingHistory=[];for(var v=0;v<f;v++)n.speakingHistory.push(0);var g=function(){setTimeout((function(){if(m){var e=o(u,c);n.emit("volume_change",e,p);var t=0;if(e>p&&!n.speaking){for(var r=n.speakingHistory.length-3;r<n.speakingHistory.length;r++)t+=n.speakingHistory[r];t>=2&&(n.speaking=!0,n.emit("speaking"))}else if(e<p&&n.speaking){for(r=0;r<n.speakingHistory.length;r++)t+=n.speakingHistory[r];0==t&&(n.speaking=!1,n.emit("stopped_speaking"))}n.speakingHistory.shift(),n.speakingHistory.push(0+(e>p)),g()}}),l)};return g(),n}},5717:function(e){"function"===typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},3129:function(e,t){var n,r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function i(e){if(!e)return i.__;Array.prototype.reduce||(Array.prototype.reduce=function(e,t){for(var n=t,r=0;r<this.length;r++)n=e(n,this[r],r,this);return n});var t="",n=("."+e).split(".").reduce((function(e,n,r,o){t?t+="."+n:t=n;var s=e["__"+t];return void 0===s&&(i.Logger.prototype=e,s=new i.Logger(t),e["__"+t]=s),s}),i.__);return n}(function(e){function t(e,t,n){void 0!==t[e]&&(null!==t[e]?n[e]=t[e]:delete n[e])}function n(t){if(null!=e.enabled&&!e.enabled)return!1;try{if(t.userAgentRegex&&!new RegExp(t.userAgentRegex).test(navigator.userAgent))return!1}catch(n){}try{if(t.ipRegex&&e.clientIP&&!new RegExp(t.ipRegex).test(e.clientIP))return!1}catch(n){}return!0}function i(e,t){try{if(e.disallow&&new RegExp(e.disallow).test(t))return!1}catch(n){}return!0}function o(e){return"function"==typeof e?e instanceof RegExp?e.toString():e():e}e.requestId="",e.entryId=0,e._createXMLHttpRequest=function(){return new XMLHttpRequest},e._getTime=function(){return(new Date).getTime()},e._console=console,e._appenderNames=[];var s=function(){function e(e,t,n){this.msg=e,this.meta=t,this.finalString=n}return e}();function a(t){var n,r=o(t);switch(typeof r){case"string":return new s(r,null,r);case"number":return n=r.toString(),new s(n,null,n);case"boolean":return n=r.toString(),new s(n,null,n);case"undefined":return new s("undefined",null,"undefined");case"object":return r instanceof RegExp||r instanceof String||r instanceof Number||r instanceof Boolean?(n=r.toString(),new s(n,null,n)):(n="function"===typeof e.serialize?e.serialize.call(this,r):JSON.stringify(r),new s("",r,n));default:return new s("unknown",null,"unknown")}}function c(e){return t("enabled",e,this),t("maxMessages",e,this),t("defaultAjaxUrl",e,this),t("clientIP",e,this),t("requestId",e,this),t("defaultBeforeSend",e,this),t("serialize",e,this),this}function u(){return-2147483648}function d(){return 1e3}function l(){return 2e3}function p(){return 3e3}function h(){return 4e3}function f(){return 5e3}function m(){return 6e3}function v(){return 2147483647}function g(e){return e<=1e3?"trace":e<=2e3?"debug":e<=3e3?"info":e<=4e3?"warn":e<=5e3?"error":"fatal"}e.setOptions=c,e.getAllLevel=u,e.getTraceLevel=d,e.getDebugLevel=l,e.getInfoLevel=p,e.getWarnLevel=h,e.getErrorLevel=f,e.getFatalLevel=m,e.getOffLevel=v;var b=function(){function e(e,t){this.inner=t,this.name="JL.Exception",this.message=a(e).finalString}return e}();e.Exception=b,b.prototype=new Error;var E=function(){function e(e,t,n,r,i){this.l=e,this.m=t,this.n=n,this.t=r,this.u=i}return e}();function y(t,n,r){return e.entryId++,new E(t,n,r,e._getTime(),e.entryId)}function S(e){e.id&&(clearTimeout(e.id),e.id=null)}function w(e,t,n){var r=this;e.id||(e.id=setTimeout((function(){n.call(r)}),t))}e.LogItem=E;var O=function(){function r(t,n){this.appenderName=t,this.sendLogItems=n,this.level=e.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.maxBatchSize=20,this.batchTimeout=2147483647,this.sendTimeout=5e3,this.buffer=[],this.batchBuffer=[],this.batchTimeoutTimer={id:null},this.sendTimeoutTimer={id:null},this.nbrLogItemsSkipped=0,this.nbrLogItemsBeingSent=0;var r="Trying to create an appender without a name or with an empty name";if(void 0==t)throw r;if(-1!=e._appenderNames.indexOf(t)){if(!t)throw r;throw"Multiple appenders use the same name "+t}e._appenderNames.push(t)}return r.prototype.addLogItemsToBuffer=function(t){if(this.batchBuffer.length>=this.maxBatchSize)this.nbrLogItemsSkipped+=t.length;else{if(null!=e.maxMessages){if(e.maxMessages<1)return;e.maxMessages-=t.length}this.batchBuffer=this.batchBuffer.concat(t);var n=this;w(this.batchTimeoutTimer,this.batchTimeout,(function(){n.sendBatch.call(n)}))}},r.prototype.batchBufferHasOverdueMessages=function(){for(var t=0;t<this.batchBuffer.length;t++){var n=e._getTime()-this.batchBuffer[t].t;if(n>this.batchTimeout)return!0}return!1},r.prototype.batchBufferHasStrandedMessage=function(){return!(null==e.maxMessages)&&e.maxMessages<1&&this.batchBuffer.length>0},r.prototype.sendBatchIfComplete=function(){(this.batchBuffer.length>=this.batchSize||this.batchBufferHasOverdueMessages()||this.batchBufferHasStrandedMessage())&&this.sendBatch()},r.prototype.onSendingEnded=function(){S(this.sendTimeoutTimer),this.nbrLogItemsBeingSent=0,this.sendBatchIfComplete()},r.prototype.setOptions=function(n){if(t("level",n,this),t("ipRegex",n,this),t("userAgentRegex",n,this),t("disallow",n,this),t("sendWithBufferLevel",n,this),t("storeInBufferLevel",n,this),t("bufferSize",n,this),t("batchSize",n,this),t("maxBatchSize",n,this),t("batchTimeout",n,this),t("sendTimeout",n,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this.maxBatchSize<this.batchSize)throw new e.Exception({message:"maxBatchSize cannot be smaller than batchSize",maxBatchSize:this.maxBatchSize,batchSize:this.batchSize});return this},r.prototype.log=function(e,t,r,o,s,a,c){var u;n(this)&&i(this,a)&&(s<this.storeInBufferLevel||(u=y(s,a,c),s<this.level?this.bufferSize>0&&(this.buffer.push(u),this.buffer.length>this.bufferSize&&this.buffer.shift()):(this.addLogItemsToBuffer([u]),s>=this.sendWithBufferLevel&&this.buffer.length&&(this.addLogItemsToBuffer(this.buffer),this.buffer.length=0),this.sendBatchIfComplete())))},r.prototype.sendBatch=function(){if(!(this.nbrLogItemsBeingSent>0)&&(S(this.batchTimeoutTimer),0!=this.batchBuffer.length)){this.nbrLogItemsBeingSent=this.batchBuffer.length;var e=this;w(this.sendTimeoutTimer,this.sendTimeout,(function(){e.onSendingEnded.call(e)})),this.sendLogItems(this.batchBuffer,(function(){e.batchBuffer.splice(0,e.nbrLogItemsBeingSent),e.nbrLogItemsSkipped>0&&(e.batchBuffer.push(y(h(),"Lost "+e.nbrLogItemsSkipped+" messages. Either connection with the server was down or logging was disabled via the enabled option. Reduce lost messages by increasing the ajaxAppender option maxBatchSize.",e.appenderName)),e.nbrLogItemsSkipped=0),e.onSendingEnded.call(e)}))}},r}();e.Appender=O;var C=function(i){function o(e){return i.call(this,e,o.prototype.sendLogItemsAjax)||this}return r(o,i),o.prototype.setOptions=function(e){return t("url",e,this),t("beforeSend",e,this),i.prototype.setOptions.call(this,e),this},o.prototype.sendLogItemsAjax=function(t,r){try{if(!n(this))return;this.xhr&&0!=this.xhr.readyState&&4!=this.xhr.readyState&&this.xhr.abort(),this.xhr=e._createXMLHttpRequest();var i="/jsnlog.logger";null!=e.defaultAjaxUrl&&(i=e.defaultAjaxUrl),this.url&&(i=this.url),this.xhr.open("POST",i),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("JSNLog-RequestId",e.requestId);var o=this;this.xhr.onreadystatechange=function(){4==o.xhr.readyState&&o.xhr.status>=200&&o.xhr.status<300&&r()};var s={r:e.requestId,lg:t};"function"===typeof this.beforeSend?this.beforeSend.call(this,this.xhr,s):"function"===typeof e.defaultBeforeSend&&e.defaultBeforeSend.call(this,this.xhr,s);var a=JSON.stringify(s);this.xhr.send(a)}catch(c){}},o}(O);e.AjaxAppender=C;var R=function(t){function i(e){return t.call(this,e,i.prototype.sendLogItemsConsole)||this}return r(i,t),i.prototype.clog=function(t){e._console.log(t)},i.prototype.cerror=function(t){e._console.error?e._console.error(t):this.clog(t)},i.prototype.cwarn=function(t){e._console.warn?e._console.warn(t):this.clog(t)},i.prototype.cinfo=function(t){e._console.info?e._console.info(t):this.clog(t)},i.prototype.cdebug=function(t){e._console.debug?e._console.debug(t):this.cinfo(t)},i.prototype.sendLogItemsConsole=function(t,r){try{if(!n(this))return;if(!e._console)return;var i;for(i=0;i<t.length;++i){var o=t[i],s=o.n+": "+o.m;"undefined"===typeof window&&(s=new Date(o.t)+" | "+s),o.l<=e.getDebugLevel()?this.cdebug(s):o.l<=e.getInfoLevel()?this.cinfo(s):o.l<=e.getWarnLevel()?this.cwarn(s):this.cerror(s)}}catch(a){}r()},i}(O);e.ConsoleAppender=R;var I,k=function(){function e(e){this.loggerName=e,this.seenRegexes=[]}return e.prototype.setOptions=function(e){return t("level",e,this),t("userAgentRegex",e,this),t("disallow",e,this),t("ipRegex",e,this),t("appenders",e,this),t("onceOnly",e,this),this.seenRegexes=[],this},e.prototype.buildExceptionObject=function(e){var t={};return e.stack?t.stack=e.stack:t.e=e,e.message&&(t.message=e.message),e.name&&(t.name=e.name),e.data&&(t.data=e.data),e.inner&&(t.inner=this.buildExceptionObject(e.inner)),t},e.prototype.log=function(e,t,r){var s,c,u=0;if(!this.appenders)return this;if(e>=this.level&&n(this)&&(r?(c=this.buildExceptionObject(r),c.logData=o(t)):c=t,s=a(c),i(this,s.finalString))){if(this.onceOnly){u=this.onceOnly.length-1;while(u>=0){if(new RegExp(this.onceOnly[u]).test(s.finalString)){if(this.seenRegexes[u])return this;this.seenRegexes[u]=!0}u--}}s.meta=s.meta||{},u=this.appenders.length-1;while(u>=0)this.appenders[u].log(g(e),s.msg,s.meta,(function(){}),e,s.finalString,this.loggerName),u--}return this},e.prototype.trace=function(e){return this.log(d(),e)},e.prototype.debug=function(e){return this.log(l(),e)},e.prototype.info=function(e){return this.log(p(),e)},e.prototype.warn=function(e){return this.log(h(),e)},e.prototype.error=function(e){return this.log(f(),e)},e.prototype.fatal=function(e){return this.log(m(),e)},e.prototype.fatalException=function(e,t){return this.log(m(),e,t)},e}();function x(e){return new C(e)}function P(e){return new R(e)}e.Logger=k,e.createAjaxAppender=x,e.createConsoleAppender=P,I="undefined"!==typeof window?new C(""):new R(""),e.__=new e.Logger(""),e.__.setOptions({level:e.getDebugLevel(),appenders:[I]})})(i||(i={})),t.__esModule=!0,t.JL=i,"function"==typeof n&&n.amd&&n("jsnlog",[],(function(){return i})),"function"==typeof __jsnlog_configure&&__jsnlog_configure(i),"undefined"===typeof window||window.onerror||(window.onerror=function(e,t,n,r,o){return i("onerrorLogger").fatalException({msg:"Uncaught Exception",errorMsg:e?e.message||e:"",url:t,"line number":n,column:r},o),!1}),"undefined"===typeof window||window.onunhandledrejection||(window.onunhandledrejection=function(e){i("onerrorLogger").fatalException({msg:"unhandledrejection",errorMsg:e.reason?e.reason.message:e.message||null},e.reason)})},7879:function(e){var t=["stun:","turn:"];e.exports=function(e){var n,r,i=(e||{}).url||e,o={};return"string"==typeof i||i instanceof String?(i=i.trim(),n=t[t.indexOf(i.slice(0,5))],n?(i=i.slice(5),r=i.split("@"),o.username=e.username,o.credential=e.credential,r.length>1&&(i=r[1],r=r[0].split(":"),o.username=r[0],o.credential=(e||{}).credential||r[1]||""),o.url=n+i,o.urls=[o.url],o):e):e}},9690:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorderState=void 0,function(e){e["READY"]="READY",e["RECORDING"]="RECORDING",e["PAUSED"]="PAUSED",e["FINISHED"]="FINISHED"}(t.LocalRecorderState||(t.LocalRecorderState={}))},7009:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduError=t.OpenViduErrorName=void 0,function(e){e["BROWSER_NOT_SUPPORTED"]="BROWSER_NOT_SUPPORTED",e["DEVICE_ACCESS_DENIED"]="DEVICE_ACCESS_DENIED",e["DEVICE_ALREADY_IN_USE"]="DEVICE_ALREADY_IN_USE",e["SCREEN_CAPTURE_DENIED"]="SCREEN_CAPTURE_DENIED",e["SCREEN_SHARING_NOT_SUPPORTED"]="SCREEN_SHARING_NOT_SUPPORTED",e["SCREEN_EXTENSION_NOT_INSTALLED"]="SCREEN_EXTENSION_NOT_INSTALLED",e["SCREEN_EXTENSION_DISABLED"]="SCREEN_EXTENSION_DISABLED",e["INPUT_VIDEO_DEVICE_NOT_FOUND"]="INPUT_VIDEO_DEVICE_NOT_FOUND",e["INPUT_AUDIO_DEVICE_NOT_FOUND"]="INPUT_AUDIO_DEVICE_NOT_FOUND",e["INPUT_AUDIO_DEVICE_GENERIC_ERROR"]="INPUT_AUDIO_DEVICE_GENERIC_ERROR",e["NO_INPUT_SOURCE_SET"]="NO_INPUT_SOURCE_SET",e["PUBLISHER_PROPERTIES_ERROR"]="PUBLISHER_PROPERTIES_ERROR",e["OPENVIDU_PERMISSION_DENIED"]="OPENVIDU_PERMISSION_DENIED",e["OPENVIDU_NOT_CONNECTED"]="OPENVIDU_NOT_CONNECTED",e["VIRTUAL_BACKGROUND_ERROR"]="VIRTUAL_BACKGROUND_ERROR",e["GENERIC_ERROR"]="GENERIC_ERROR"}(t.OpenViduErrorName||(t.OpenViduErrorName={}));var n=function(){function e(e,t){this.name=e,this.message=t}return e}();t.OpenViduError=n},1513:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfVideo=void 0,function(e){e["CAMERA"]="CAMERA",e["SCREEN"]="SCREEN",e["CUSTOM"]="CUSTOM",e["IPCAM"]="IPCAM"}(t.TypeOfVideo||(t.TypeOfVideo={}))},4270:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoInsertMode=void 0,function(e){e["AFTER"]="AFTER",e["APPEND"]="APPEND",e["BEFORE"]="BEFORE",e["PREPEND"]="PREPEND",e["REPLACE"]="REPLACE"}(t.VideoInsertMode||(t.VideoInsertMode={}))},5223:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,r)||this;return s.connection=i,s.reason=o,s}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.ConnectionEvent=o},6203:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionPropertyChangedEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,"connectionPropertyChanged")||this;return s.connection=n,s.changedProperty=r,s.newValue=i,s.oldValue=o,s}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.ConnectionPropertyChangedEvent=o},6300:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=function(){function e(e,t,n){this.hasBeenPrevented=!1,this.cancelable=e,this.target=t,this.type=n}return e.prototype.isDefaultPrevented=function(){return this.hasBeenPrevented},e.prototype.preventDefault=function(){this.callDefaultBehavior=function(){},this.hasBeenPrevented=!0},e}();t.Event=n},6056:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ExceptionEvent=t.ExceptionEventName=void 0;var i=n(6300);(function(e){e["ICE_CANDIDATE_ERROR"]="ICE_CANDIDATE_ERROR",e["ICE_CONNECTION_FAILED"]="ICE_CONNECTION_FAILED",e["ICE_CONNECTION_DISCONNECTED"]="ICE_CONNECTION_DISCONNECTED",e["NO_STREAM_PLAYING_EVENT"]="NO_STREAM_PLAYING_EVENT"})(t.ExceptionEventName||(t.ExceptionEventName={}));var o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,"exception")||this;return s.name=n,s.origin=r,s.message=i,s.data=o,s}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.ExceptionEvent=o},146:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.FilterEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r){var i=e.call(this,!1,t,n)||this;return i.data=r,i}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.FilterEvent=o},9233:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkQualityLevelChangedEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,"networkQualityLevelChanged")||this;return o.newValue=n,o.oldValue=r,o.connection=i,o}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.NetworkQualityLevelChangedEvent=o},8271:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.PublisherSpeakingEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,n)||this;return o.type=n,o.connection=r,o.streamId=i,o}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.PublisherSpeakingEvent=o},8856:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.RecordingEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r,i,o){var s=e.call(this,!1,t,n)||this;return s.id=r,i!==r&&(s.name=i),s.reason=o,s}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.RecordingEvent=o},3439:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SessionDisconnectedEvent=void 0;var i=n(6300),o=n(5364),s=o.OpenViduLogger.getInstance(),a=function(e){function t(t,n){var r=e.call(this,!0,t,"sessionDisconnected")||this;return r.reason=n,r}return r(t,e),t.prototype.callDefaultBehavior=function(){s.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'");var e=this.target;e.remoteConnections.forEach((function(t){var n,r,i,o,s,a,c,u,d=t.connectionId;if(null===(n=e.remoteConnections.get(d))||void 0===n?void 0:n.stream){null===(r=e.remoteConnections.get(d))||void 0===r||r.stream.disposeWebRtcPeer(),null===(i=e.remoteConnections.get(d))||void 0===i||i.stream.disposeMediaStream(),(null===(o=e.remoteConnections.get(d))||void 0===o?void 0:o.stream.streamManager)&&(null===(s=e.remoteConnections.get(d))||void 0===s||s.stream.streamManager.removeAllVideos());var l=null===(c=null===(a=e.remoteConnections.get(d))||void 0===a?void 0:a.stream)||void 0===c?void 0:c.streamId;l&&e.remoteStreamsCreated.delete(l),null===(u=e.remoteConnections.get(d))||void 0===u||u.dispose()}e.remoteConnections.delete(d)}))},t}(i.Event);t.SessionDisconnectedEvent=a},3685:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SignalEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r,i){var o=e.call(this,!1,t,"signal")||this;return n&&(o.type="signal:"+n),o.data=r,o.from=i,o}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.SignalEvent=o},3590:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.StreamEvent=void 0;var i=n(6300),o=n(2917),s=n(8330),a=n(5364),c=a.OpenViduLogger.getInstance(),u=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,r)||this;return s.stream=i,s.reason=o,s}return r(t,e),t.prototype.callDefaultBehavior=function(){if("streamDestroyed"===this.type){if(this.target instanceof s.Session)c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Session'"),this.stream.disposeWebRtcPeer();else if(this.target instanceof o.Publisher){c.info("Calling default behavior upon '"+this.type+"' event dispatched by 'Publisher'"),clearInterval(this.target.screenShareResizeInterval),this.stream.isLocalStreamReadyToPublish=!1;for(var e=this.target.openvidu.publishers,t=0;t<e.length;t++)if(e[t]===this.target){e.splice(t,1);break}}this.stream.disposeMediaStream(),this.stream.streamManager&&this.stream.streamManager.removeAllVideos(),this.stream.session.remoteStreamsCreated.delete(this.stream.streamId);var n=this.stream.session.remoteConnections.get(this.stream.connection.connectionId);if(n&&n.remoteOptions){var r=n.remoteOptions.streams;for(t=r.length-1;t>=0;--t)r[t].id===this.stream.streamId&&r.splice(t,1)}}},t}(i.Event);t.StreamEvent=u},3977:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManagerEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r){var i=e.call(this,!1,t,n)||this;return i.value=r,i}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.StreamManagerEvent=o},7614:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.StreamPropertyChangedEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r,i,o,s){var a=e.call(this,!1,t,"streamPropertyChanged")||this;return a.stream=n,a.changedProperty=r,a.newValue=i,a.oldValue=o,a.reason=s,a}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.StreamPropertyChangedEvent=o},6367:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.VideoElementEvent=void 0;var i=n(6300),o=function(e){function t(t,n,r){var i=e.call(this,!1,n,r)||this;return i.element=t,i}return r(t,e),t.prototype.callDefaultBehavior=function(){},t}(i.Event);t.VideoElementEvent=o},4113:function(e){function t(){var e={};this.forEach=function(t){for(var n in e){var r=e[n];for(var i in r)t(r[i])}},this.get=function(t,n){var r=e[n];if(void 0!=r)return r[t]},this.remove=function(t,n){var r=e[n];if(void 0!=r){for(var i in delete r[t],r)return!1;delete e[n]}},this.set=function(t,n,r){if(void 0==t)return this.remove(n,r);var i=e[r];void 0==i&&(e[r]=i={}),i[n]=t}}t.prototype.pop=function(e,t){var n=this.get(e,t);if(void 0!=n)return this.remove(e,t),n},e.exports=t},264:function(e,t,n){var r=n(9972);t.JsonRpcClient=r},9972:function(e,t,n){var r=n(4834),i=n(1889),o=n(5364).OpenViduLogger;Date.now=Date.now||function(){return+new Date};var s=5e3,a="RECONNECTING",c="CONNECTED",u="DISCONNECTED",d=o.getInstance();function l(e){var t,n=this,o=e.ws,l=-1,p=0,h=!0,f=!1,m=u,v=o.onreconnecting,g=o.onreconnected,b=o.onconnected,E=o.onerror;e.rpc.pull=function(e,t){t.reply(null,"push")},o.onreconnecting=function(){d.debug("--------- ONRECONNECTING -----------"),m!==a?(I(),m=a,v&&v()):d.error("Websocket already in RECONNECTING state when receiving a new ONRECONNECTING message. Ignoring it")},o.onreconnected=function(){d.debug("--------- ONRECONNECTED -----------"),m!==c?(m=c,O(),g&&g()):d.error("Websocket already in CONNECTED state when receiving a new ONRECONNECTED message. Ignoring it")},o.onconnected=function(){d.debug("--------- ONCONNECTED -----------"),m!==c?(m=c,h=!0,R(),b&&b()):d.error("Websocket already in CONNECTED state when receiving a new ONCONNECTED message. Ignoring it")},o.onerror=function(e){d.debug("--------- ONERROR -----------"),m=u,I(),E&&E(e)};var y=new i(o);d.debug("Connecting websocket to URI: "+o.uri);var S={request_timeout:e.rpc.requestTimeout,ping_request_timeout:e.rpc.heartbeatRequestTimeout},w=new r(r.packers.JsonRPC,S,y,(function(t){d.debug("Received request: "+JSON.stringify(t));try{var n=e.rpc[t.method];void 0===n?d.error("Method "+t.method+" not registered in client"):n(t.params,t)}catch(r){d.error("Exception processing request: "+JSON.stringify(t)),d.error(r)}}));function O(){d.debug("notReconnectIfNumLessThan = "+p+" (old="+l+")"),l=p}function C(){if(h){var t=null;0!=p&&p!=l||(t={interval:e.heartbeat||s}),p++,n.send("ping",t,function(e){return function(t,n){t&&(d.debug("Error in ping request #"+e+" ("+t.message+")"),e>l&&(h=!1,O(),d.debug("Server did not respond to ping message #"+e+". Reconnecting... "),y.reconnectWs()))}}(p))}else d.debug("Trying to send ping, but ping is not enabled")}function R(){f||(d.debug("Starting ping (if configured)"),f=!0,void 0!=e.heartbeat&&(t=setInterval(C,e.heartbeat),C()))}function I(){clearInterval(t),f=!1,h=!1,p=-1,w.cancel()}this.send=function(e,t,n){var r=Date.now();w.encode(e,t,(function(i,o){if(i){try{d.error("ERROR:"+i.message+" in Request: method:"+e+" params:"+JSON.stringify(t)+" request:"+i.request),i.data&&d.error("ERROR DATA:"+JSON.stringify(i.data))}catch(s){}i.requestTime=r}n&&(void 0!=o&&"pong"!==o.value&&d.debug("Response: "+JSON.stringify(o)),n(i,o))}))},this.close=function(e,n){d.debug("Closing  with code: "+e+" because: "+n),void 0!=t&&(d.debug("Clearing ping interval"),clearInterval(t)),f=!1,h=!1,y.close(e,n)},this.reconnect=function(){y.reconnectWs()},this.resetPing=function(){h=!0,p=0,R()},this.getReadyState=function(){return y.getReadyState()}}e.exports=l},6115:function(e,t,n){var r=n(1889);t.WebSocketWithReconnection=r},1889:function(e,t,n){"use strict";var r=n(5364).OpenViduLogger,i=r.getInstance(),o=2e3,s=3e3,a=3;function c(e){var t,n=!1,r=e.uri,c=!1,u=new WebSocket(r);u.onopen=function(){i.debug("WebSocket connected to "+r),e.onconnected&&e.onconnected()},u.onerror=function(t){i.error("Could not connect to "+r+" (invoking onerror if defined)",t),e.onerror&&e.onerror(t)};var d=function(){u.readyState===a?n?i.debug("Connection closed by user"):e.ismasternodecrashed()?i.error("Master Node has crashed. Stopping reconnection process"):(i.debug("Connection closed unexpectedly. Reconnecting..."),l(o,1)):i.debug("Close callback from previous websocket. Ignoring it")};function l(t,n){if(i.debug("reconnect (attempt #"+n+", max="+t+")"),1===n){if(c)return void i.warn("Trying to reconnect when already reconnecting... Ignoring this reconnection.");c=!0,e.onreconnecting&&e.onreconnecting()}h(t,n)}function p(e){var t=new URLSearchParams(new URL(e).search);return t.has("reconnect")||(e=Array.from(t).length>0?e+"&reconnect=true":e+"?reconnect=true"),e}function h(n,o){i.debug("Reconnection attempt #"+o),u.close(4104,"Connection closed for reconnection"),r=p(r),u=new WebSocket(r),u.onopen=function(){i.debug("Reconnected to "+r+" after "+o+" attempts..."),c=!1,t(),e.onreconnected()&&e.onreconnected(),u.onclose=d},u.onerror=function(t){i.warn("Reconnection error: ",t),o===n?e.ondisconnect&&e.ondisconnect():setTimeout((function(){l(n,o+1)}),s)}}u.onclose=d,this.close=function(e,t){n=!0,u.close(e,t)},this.reconnectWs=function(){i.debug("reconnectWs"),l(o,1)},this.send=function(e){u.send(e)},this.addEventListener=function(e,n){t=function(){u.addEventListener(e,n)},t()},this.getReadyState=function(){return u.readyState}}e.exports=c},4834:function(e,t,n){var r=!1;if(Object.defineProperty)try{Object.defineProperty({},"x",{})}catch(m){r=!0}Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i});var i=n(7187).EventEmitter,o=n(5717),s=n(6622),a=n(4113),c=5e3;function u(e){if(!e)return{};for(var t in e){var n=e[t];"string"==typeof n&&(e[t]={response:n})}return e}function d(e){if(e){if(e instanceof Function)return{send:e};if(e.send instanceof Function)return e;if(e.postMessage instanceof Function)return e.send=e.postMessage,e;if(e.write instanceof Function)return e.send=e.write,e;if(void 0===e.onmessage&&!(e.pause instanceof Function))throw new SyntaxError("Transport is not a function nor a valid object")}}function l(e,t){r?(this.method=e,this.params=t):(Object.defineProperty(this,"method",{value:e,enumerable:!0}),Object.defineProperty(this,"params",{value:t,enumerable:!0}))}function p(e,t,n,s){var p=this;if(!e)throw new SyntaxError("Packer is not defined");if(!e.pack||!e.unpack)throw new SyntaxError("Packer is invalid");var h=u(e.responseMethods);if(t instanceof Function){if(void 0!=n)throw new SyntaxError("There can't be parameters after onRequest");s=t,n=void 0,t=void 0}if(t&&t.send instanceof Function){if(n&&!(n instanceof Function))throw new SyntaxError("Only a function can be after transport");s=n,n=t,t=void 0}if(n instanceof Function){if(void 0!=s)throw new SyntaxError("There can't be parameters after onRequest");s=n,n=void 0}if(n&&n.send instanceof Function&&s&&!(s instanceof Function))throw new SyntaxError("Only a function can be after transport");t=t||{},i.call(this),s&&this.on("request",s),r?this.peerID=t.peerID:Object.defineProperty(this,"peerID",{value:t.peerID});var f=t.max_retries||0;function v(e){p.decode(e.data||e)}this.getTransport=function(){return n},this.setTransport=function(e){n&&(n.removeEventListener?n.removeEventListener("message",v):n.removeListener&&n.removeListener("data",v)),e&&(e.addEventListener?e.addEventListener("message",v):e.addListener&&e.addListener("data",v)),n=d(e)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)}),this.setTransport(n);var g=t.request_timeout||c,b=t.ping_request_timeout||g,E=t.response_timeout||c,y=t.duplicates_timeout||c,S=0,w=new a,O=new a,C=new a,R={};function I(e,t,n){var r={message:e,timeout:setTimeout((function(){O.remove(t,n)}),E)};O.set(r,t,n)}function k(e,t){var n=setTimeout((function(){C.remove(e,t)}),y);C.set(n,e,t)}function x(t,n,i,o,s){l.call(this,t,n),this.getTransport=function(){return s},this.setTransport=function(e){s=d(e)},r||Object.defineProperty(this,"transport",{get:this.getTransport.bind(this),set:this.setTransport.bind(this)});var a=O.get(i,o);s||p.getTransport()||(r?this.duplicated=Boolean(a):Object.defineProperty(this,"duplicated",{value:Boolean(a)}));var c=h[t];this.pack=e.pack.bind(e,this,i),this.reply=function(t,n,r){if(t instanceof Function||t&&t.send instanceof Function){if(void 0!=n)throw new SyntaxError("There can't be parameters after callback");r=t,n=null,t=void 0}else if(n instanceof Function||n&&n.send instanceof Function){if(void 0!=r)throw new SyntaxError("There can't be parameters after callback");r=n,n=null}var s;if(r=d(r),a&&clearTimeout(a.timeout),void 0!=o&&(t&&(t.dest=o),n&&(n.dest=o)),t||void 0!=n){if(void 0!=p.peerID&&(t?t.from=p.peerID:n.from=p.peerID),c)if(void 0==c.error&&t)s={error:t};else{var u=t?c.error:c.response;s={method:u,params:t||n}}else s={error:t,result:n};s=e.pack(s,i)}else s=a?a.message:e.pack({result:null},i);return I(s,i,o),r=r||this.getTransport()||p.getTransport(),r?r.send(s):s}}function P(e){var t=R[e];if(t){delete R[e];var n=w.pop(t.id,t.dest);n&&(clearTimeout(n.timeout),k(t.id,t.dest))}}o(x,l),this.cancel=function(e){if(e)return P(e);for(var e in R)P(e)},this.close=function(){var e=this.getTransport();e&&e.close&&e.close(4003,"Cancel request"),this.cancel(),C.forEach(clearTimeout),O.forEach((function(e){clearTimeout(e.timeout)}))},this.encode=function(t,n,r,i,o){if(n instanceof Function){if(void 0!=r)throw new SyntaxError("There can't be parameters after callback");o=n,i=void 0,r=void 0,n=void 0}else if(r instanceof Function){if(void 0!=i)throw new SyntaxError("There can't be parameters after callback");o=r,i=void 0,r=void 0}else if(i instanceof Function){if(void 0!=o)throw new SyntaxError("There can't be parameters after callback");o=i,i=void 0}void 0!=p.peerID&&(n=n||{},n.from=p.peerID),void 0!=r&&(n=n||{},n.dest=r);var s={method:t,params:n};if(o){var a=S++,c=0;function u(e,t){p.cancel(s),o(e,t)}s=e.pack(s,a);var l={message:s,callback:u,responseMethods:h[t]||{}},m=d(i);function v(e){var n="ping"===t?b:g;return l.timeout=setTimeout(y,n*Math.pow(2,c++)),R[s]={id:a,dest:r},w.set(l,a,r),e=e||m||p.getTransport(),e?e.send(s):s}function E(e){e=d(e),console.warn(c+" retry for request message:",s);var t=C.pop(a,r);return clearTimeout(t),v(e)}function y(){if(c<f)return E(i);var e=new Error("Request has timed out");e.request=s,e.retry=E,u(e)}return v(i)}return s=e.pack(s),i=i||this.getTransport(),i?i.send(s):s},this.decode=function(t,n){if(!t)throw new TypeError("Message is not defined");try{t=e.unpack(t)}catch(m){return console.debug(m,t)}var r=t.id,i=t.ack,o=t.method,s=t.params||{},a=s.from,c=s.dest;if(void 0==p.peerID||a!=p.peerID){if(void 0==r&&void 0==i){var u=new l(o,s);if(p.emit("request",u))return;return u}if(o){if(void 0==c||c==p.peerID){var h=w.get(i,a);if(h){var f=h.responseMethods;return o==f.error?y(h,s):o==f.response?y(h,null,s):E()}var v=C.get(i,a);if(v)return S(v)}return E()}var g=t.error,b=t.result;if((!g||!g.dest||g.dest==p.peerID)&&(!b||!b.dest||b.dest==p.peerID)){h=w.get(i,a);if(!h){v=C.get(i,a);return v?S(v):console.warn("No callback was defined for this message",t)}y(h,g,b)}}function E(){if(n=d(n)||p.getTransport(),n){var e=O.get(r,a);if(e)return n.send(e.message)}var t=void 0!=r?r:i,c=new x(o,s,t,a,n);if(!p.emit("request",c))return c}function y(e,t,n){e.callback(t,n)}function S(e){console.warn("Response already processed",t),clearTimeout(e),k(i,a)}}}o(p,i),p.RpcNotification=l,e.exports=p;var h=n(264),f=n(6115);p.clients=h,p.clients.transports=f,p.packers=s},8447:function(e,t){function n(e,t){var n={jsonrpc:"2.0"};if(e.method)n.method=e.method,e.params&&(n.params=e.params),void 0!=t&&(n.id=t);else if(void 0!=t){if(e.error){if(void 0!==e.result)throw new TypeError("Both result and error are defined");n.error=e.error}else{if(void 0===e.result)throw new TypeError("No result or error is defined");n.result=e.result}n.id=t}return JSON.stringify(n)}function r(e){var t=e;("string"===typeof e||e instanceof String)&&(t=JSON.parse(e));var n=t.jsonrpc;if("2.0"!==n)throw new TypeError("Invalid JsonRPC version '"+n+"': "+e);if(void 0==t.method){if(void 0==t.id)throw new TypeError("Invalid message: "+e);var r=void 0!==t.result,i=void 0!==t.error;if(r&&i)throw new TypeError("Both result and error are defined: "+e);if(!r&&!i)throw new TypeError("No result or error is defined: "+e);t.ack=t.id,delete t.id}return t}t.pack=n,t.unpack=r},7632:function(e,t){function n(e){throw new TypeError("Not yet implemented")}function r(e){throw new TypeError("Not yet implemented")}t.pack=n,t.unpack=r},6622:function(e,t,n){var r=n(8447),i=n(7632);t.JsonRPC=r,t.XmlRPC=i},8982:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleLogger=void 0;var n=function(){function e(e){this.logger=e,this.log=window.console.log,this.info=window.console.info,this.debug=window.console.debug,this.warn=window.console.warn,this.error=window.console.error}return e}();t.ConsoleLogger=n},5364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLogger=void 0;var r=n(3129),i=n(8982),o=n(327),s=function(){function e(){this.JSNLOG_URL="/openvidu/elk/openvidu-browser-logs",this.MAX_JSNLOG_BATCH_LOG_MESSAGES=100,this.MAX_MSECONDS_BATCH_MESSAGES=5e3,this.MAX_LENGTH_STRING_JSON=1e3,this.defaultConsoleLogger=new i.ConsoleLogger(window.console),this.isProdMode=!1,this.isJSNLogSetup=!1}return e.configureJSNLog=function(e,t){var n=this;try{if(window["LOG_JSNLOG_RESULTS"]||this.instance&&e.isAtLeastPro&&this.instance.isOpenViduBrowserLogsDebugActive(e)&&this.instance.canConfigureJSNLog(e,this.instance)){e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app&&this.instance.replaceWindowConsole(),this.instance.isJSNLogSetup=!1,this.instance.info("Configuring JSNLogs.");var i=e.finalUserId,s=e.session.sessionId,a=function(e){var r=e.onreadystatechange;e.onreadystatechange=function(){n.isInvalidResponse(e)&&(Object.defineProperty(e,"readyState",{value:4}),Object.defineProperty(e,"status",{value:200}),n.instance.disableLogger()),r()},e.setRequestHeader("Authorization","Basic "+btoa("".concat(i,"%/%").concat(s)+":"+t)),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("OV-Final-User-Id",i),e.setRequestHeader("OV-Session-Id",s),e.setRequestHeader("OV-Token",t)};this.instance.currentAppender=r.JL.createAjaxAppender("appender-".concat(i,"-").concat(s)),this.instance.currentAppender.setOptions({beforeSend:a,maxBatchSize:1e3,batchSize:this.instance.MAX_JSNLOG_BATCH_LOG_MESSAGES,batchTimeout:this.instance.MAX_MSECONDS_BATCH_MESSAGES});var c=function(e){var t=function(){var e=new WeakSet;return function(t,n){if("object"===typeof n&&null!=n){if(e.has(n)||HTMLElement&&n instanceof HTMLElement)return;e.add(n)}return n}},r=JSON.stringify(e,t());return r.length>n.instance.MAX_LENGTH_STRING_JSON&&(r="".concat(r.substring(0,n.instance.MAX_LENGTH_STRING_JSON),"...")),window["LOG_JSNLOG_RESULTS"]&&console.log(r),r};r.JL.setOptions({defaultAjaxUrl:e.httpUri+this.instance.JSNLOG_URL,serialize:c,enabled:!0}),(0,r.JL)().setOptions({appenders:[this.instance.currentAppender]}),this.instance.isJSNLogSetup=!0,this.instance.loggingSessionId=s,this.instance.info("JSNLog configured.")}}catch(u){console.error("Error configuring JSNLog: "),console.error(u),this.instance.disableLogger()}},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.isInvalidResponse=function(e){return 401==e.status||403==e.status||404==e.status||0==e.status},e.prototype.canConfigureJSNLog=function(e,t){return e.session.sessionId!=t.loggingSessionId},e.prototype.isOpenViduBrowserLogsDebugActive=function(e){return e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug||e.sendBrowserLogs===o.OpenViduLoggerConfiguration.debug_app},e.prototype.getConsoleWithJSNLog=function(){return function(e){return{log:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.log.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().info(arguments)},info:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.info.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().info(arguments)},debug:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.debug.apply(e.defaultConsoleLogger.logger,arguments)},warn:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.warn.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().warn(arguments)},error:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.defaultConsoleLogger.error.apply(e.defaultConsoleLogger.logger,arguments),e.isJSNLogSetup&&(0,r.JL)().error(arguments)}}}(this)},e.prototype.replaceWindowConsole=function(){window.console=this.defaultConsoleLogger.logger,window.console.log=this.getConsoleWithJSNLog().log,window.console.info=this.getConsoleWithJSNLog().info,window.console.debug=this.getConsoleWithJSNLog().debug,window.console.warn=this.getConsoleWithJSNLog().warn,window.console.error=this.getConsoleWithJSNLog().error},e.prototype.disableLogger=function(){r.JL.setOptions({enabled:!1}),this.isJSNLogSetup=!1,this.loggingSessionId=void 0,this.currentAppender=void 0,window.console=this.defaultConsoleLogger.logger,window.console.log=this.defaultConsoleLogger.log,window.console.info=this.defaultConsoleLogger.info,window.console.debug=this.defaultConsoleLogger.debug,window.console.warn=this.defaultConsoleLogger.warn,window.console.error=this.defaultConsoleLogger.error},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.log.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().info(arguments)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.debug.apply(this.defaultConsoleLogger.logger,arguments)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isProdMode||this.defaultConsoleLogger.info.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().info(arguments)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.warn.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().warn(arguments)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.defaultConsoleLogger.error.apply(this.defaultConsoleLogger.logger,arguments),this.isJSNLogSetup&&(0,r.JL)().error(arguments)},e.prototype.flush=function(){this.isJSNLogSetup&&null!=this.currentAppender&&this.currentAppender.sendBatch()},e.prototype.enableProdMode=function(){this.isProdMode=!0},e}();t.OpenViduLogger=s},327:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenViduLoggerConfiguration=void 0,function(e){e["disabled"]="disabled",e["debug"]="debug",e["debug_app"]="debug_app"}(t.OpenViduLoggerConfiguration||(t.OpenViduLoggerConfiguration={}))},3061:function(e,t){function n(e,t,n){var r={audio:!1,video:{mandatory:{chromeMediaSource:e?"screen":"desktop",maxWidth:window.screen.width>1920?window.screen.width:1920,maxHeight:window.screen.height>1080?window.screen.height:1080},optional:[]}};return n&&(r.audio={mandatory:{chromeMediaSource:e?"screen":"desktop"},optional:[]}),t&&(r.video.mandatory.chromeMediaSourceId=t,r.audio&&r.audio.mandatory&&(r.audio.mandatory.chromeMediaSourceId=t)),r}function r(e){i?i.isLoaded?e?e.forEach?i.contentWindow.postMessage({captureCustomSourceId:e},"*"):i.contentWindow.postMessage({captureSourceIdWithAudio:!0},"*"):i.contentWindow.postMessage({captureSourceId:!0},"*"):setTimeout((function(){r(e)}),100):o((function(){r(e)}))}var i;function o(e){i?e():(i=document.createElement("iframe"),i.onload=function(){i.isLoaded=!0,e()},i.src="https://openvidu.github.io/openvidu-screen-sharing-chrome-extension/",i.style.display="none",(document.body||document.documentElement).appendChild(i))}function s(){i?i.isLoaded?i.contentWindow.postMessage({getChromeExtensionStatus:!0},"*"):setTimeout(s,100):o(s)}window.getScreenId=function(e,t,i){function o(e){e.data&&(e.data.chromeMediaSourceId&&("PermissionDeniedError"===e.data.chromeMediaSourceId?t("permission-denied"):t(null,e.data.chromeMediaSourceId,n(null,e.data.chromeMediaSourceId,e.data.canRequestAudioTrack)),window.removeEventListener("message",o)),e.data.chromeExtensionStatus&&(t(e.data.chromeExtensionStatus,null,n(e.data.chromeExtensionStatus)),window.removeEventListener("message",o)))}-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveOrOpenBlob&&!navigator.msSaveBlob?navigator.mozGetUserMedia?t(null,"firefox",{video:{mozMediaSource:e,mediaSource:e}}):(window.addEventListener("message",o),i?setTimeout((function(){r(i)}),100):setTimeout(r,100)):t({video:!0})},window.getScreenConstraints=function(e){o((function(){getScreenId((function(t,n,r){r||(r={video:!0}),e(t,r.video)}))}))},window.getChromeExtensionStatus=function(e){function t(n){n.data&&n.data.chromeExtensionStatus&&(e(n.data.chromeExtensionStatus),window.removeEventListener("message",t))}navigator.mozGetUserMedia?e("installed-enabled"):(window.addEventListener("message",t),setTimeout(s,100))},t.getScreenId=window.getScreenId},9544:function(e,t){var n,r,i="screen";if("undefined"!==typeof window&&"undefined"!==typeof navigator&&"undefined"!==typeof navigator.userAgent){var o="undefined"!==typeof window.InstallTrigger,s=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;window.chrome;window.addEventListener("message",(function(e){e.origin==window.location.origin&&a(e.data)}))}function a(e){if("PermissionDeniedError"==e){if(r)return r("PermissionDeniedError");throw new Error("PermissionDeniedError")}"rtcmulticonnection-extension-loaded"==e&&(i="desktop"),e.sourceId&&r&&r(n=e.sourceId,!0===e.canRequestAudioTrack)}function c(e){if(e){if("desktop"==i)return e(!0);window.postMessage("are-you-there","*"),setTimeout((function(){e("screen"!=i)}),2e3)}}function u(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);r=e,window.postMessage("get-sourceId","*")}function d(e){if(!e)throw'"callback" parameter is mandatory.';if(n)return e(n);r=e,window.postMessage("audio-plus-tab","*")}function l(e,t){if(o)return t("not-chrome");2!=arguments.length&&(t=e,e="lfcgfepafnobdloecchnfaclibenjold");var n=document.createElement("img");n.src="chrome-extension://"+e+"/icon.png",n.onload=function(){i="screen",window.postMessage("are-you-there","*"),setTimeout((function(){t("screen"==i?"installed-disabled":"installed-enabled")}),2e3)},n.onerror=function(){t("not-installed")}}function p(e){h(e,!0)}function h(e,t){n="";var r={mozMediaSource:"window",mediaSource:"window"};if(o)return e(null,r);var s={mandatory:{chromeMediaSource:i,maxWidth:screen.width>1920?screen.width:1920,maxHeight:screen.height>1080?screen.height:1080},optional:[]};"desktop"!=i||n?("desktop"==i&&(s.mandatory.chromeMediaSourceId=n),e(null,s)):t?d((function(t,n){s.mandatory.chromeMediaSourceId=t,n&&(s.canRequestAudioTrack=!0),e("PermissionDeniedError"==t?t:null,s)})):u((function(t){s.mandatory.chromeMediaSourceId=t,e("PermissionDeniedError"==t?t:null,s)}))}t.getScreenConstraints=h,t.getScreenConstraintsWithAudio=p,t.isChromeExtensionAvailable=c,t.getChromeExtensionStatus=l,t.getSourceId=u},5971:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformUtils=void 0;var r=n(1795),i=function(){function e(){}return e.getInstance=function(){return this.instance||(this.instance=new e),e.instance},e.prototype.isChromeBrowser=function(){return"Chrome"===r.name},e.prototype.isSafariBrowser=function(){return"Safari"===r.name},e.prototype.isChromeMobileBrowser=function(){return"Chrome Mobile"===r.name},e.prototype.isFirefoxBrowser=function(){return"Firefox"===r.name},e.prototype.isFirefoxMobileBrowser=function(){return"Firefox Mobile"===r.name||"Firefox for iOS"===r.name},e.prototype.isOperaBrowser=function(){return"Opera"===r.name},e.prototype.isOperaMobileBrowser=function(){return"Opera Mobile"===r.name},e.prototype.isEdgeBrowser=function(){var e=(null===r||void 0===r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&e>=80},e.prototype.isEdgeMobileBrowser=function(){var e,t,n=(null===r||void 0===r?void 0:r.version)?parseFloat(r.version):-1;return"Microsoft Edge"===r.name&&("Android"===(null===(e=r.os)||void 0===e?void 0:e.family)||"iOS"===(null===(t=r.os)||void 0===t?void 0:t.family))&&n>45},e.prototype.isAndroidBrowser=function(){return"Android Browser"===r.name},e.prototype.isElectron=function(){return"Electron"===r.name},e.prototype.isSamsungBrowser=function(){return"Samsung Internet Mobile"===r.name||"Samsung Internet"===r.name},e.prototype.isIPhoneOrIPad=function(){var e=r.ua?r.ua:navigator.userAgent,t="ontouchend"in document,n=/\b(\w*Macintosh\w*)\b/.test(e)&&t,i=/\b(\w*iPhone\w*)\b/.test(e)&&/\b(\w*Mobile\w*)\b/.test(e)&&t;return n||i},e.prototype.isIOSWithSafari=function(){var e=r.ua?r.ua:navigator.userAgent;return this.isIPhoneOrIPad()&&/\b(\w*Apple\w*)\b/.test(navigator.vendor)&&/\b(\w*Safari\w*)\b/.test(e)&&!/\b(\w*CriOS\w*)\b/.test(e)&&!/\b(\w*FxiOS\w*)\b/.test(e)},e.prototype.isIonicIos=function(){return this.isIPhoneOrIPad()&&-1===r.ua.indexOf("Safari")},e.prototype.isIonicAndroid=function(){return"Android"===r.os.family&&"Android Browser"==r.name},e.prototype.isMobileDevice=function(){return"iOS"===r.os.family||"Android"===r.os.family},e.prototype.isReactNative=function(){return!1},e.prototype.isChromium=function(){return this.isChromeBrowser()||this.isChromeMobileBrowser()||this.isOperaBrowser()||this.isOperaMobileBrowser()||this.isEdgeBrowser()||this.isEdgeMobileBrowser()||this.isSamsungBrowser()||this.isIonicAndroid()||this.isIonicIos()||this.isElectron()},e.prototype.canScreenShare=function(){var e=(null===r||void 0===r?void 0:r.version)?parseFloat(r.version):-1;return!this.isMobileDevice()&&(this.isChromeBrowser()||this.isFirefoxBrowser()||this.isOperaBrowser()||this.isElectron()||this.isEdgeBrowser()||this.isSafariBrowser()&&e>=13)},e.prototype.getName=function(){return r.name||""},e.prototype.getVersion=function(){return r.version||""},e.prototype.getFamily=function(){return r.os.family||""},e.prototype.getDescription=function(){return r.description||""},e}();t.PlatformUtils=i},734:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcPeerSendrecv=t.WebRtcPeerSendonly=t.WebRtcPeerRecvonly=t.WebRtcPeer=void 0;var a=n(8483),c=n(812),u=n(6056),d=n(5364),l=n(5971),p=d.OpenViduLogger.getInstance(),h=function(){function e(e){var t=this;this.remoteCandidatesQueue=[],this.localCandidatesQueue=[],this.iceCandidateList=[],this.candidategatheringdone=!1,l.PlatformUtils.getInstance(),this.configuration=i(i({},e),{iceServers:e.iceServers&&e.iceServers.length>0?e.iceServers:a(),mediaStream:void 0!==e.mediaStream?e.mediaStream:null,mode:e.mode?e.mode:"sendrecv",id:e.id?e.id:this.generateUniqueId()}),p.debug("[WebRtcPeer] configuration:\n".concat(JSON.stringify(this.configuration,null,2))),this.pc=new RTCPeerConnection({iceServers:this.configuration.iceServers}),this.pc.addEventListener("icecandidate",(function(e){if(null!==e.candidate){var n=e.candidate,r=new RTCIceCandidate(n);t.configuration.onIceCandidate(r),""!==r.candidate&&t.localCandidatesQueue.push(r)}})),this.pc.addEventListener("signalingstatechange",(function(){if("stable"===t.pc.signalingState)while(t.iceCandidateList.length>0){var e=t.iceCandidateList.shift();t.pc.addIceCandidate(e)}}))}return e.prototype.getId=function(){return this.configuration.id},e.prototype.dispose=function(){if(p.debug("Disposing WebRtcPeer"),this.pc){if("closed"===this.pc.signalingState)return;this.pc.close(),this.remoteCandidatesQueue=[],this.localCandidatesQueue=[]}},e.prototype.createOfferLegacy=function(){this.configuration.mediaStream&&this.deprecatedPeerConnectionTrackApi();var e=this.configuration.mediaConstraints.audio,t=this.configuration.mediaConstraints.video,n={offerToReceiveAudio:"sendonly"!==this.configuration.mode&&e,offerToReceiveVideo:"sendonly"!==this.configuration.mode&&t};return p.debug("[createOfferLegacy] RTCPeerConnection.createOffer() options:",JSON.stringify(n)),this.pc.createOffer(n)},e.prototype.createOffer=function(){var e,t,n,r,i,a,c,u;return o(this,void 0,void 0,(function(){var o,d,l,h,f,m,v,g,b,E,y,S,w,O,C,R,I,k,x,P,T,N,_;return s(this,(function(s){switch(s.label){case 0:if(!("addTransceiver"in this.pc))return p.warn("[createOffer] Method RTCPeerConnection.addTransceiver() is NOT available; using LEGACY offerToReceive{Audio,Video}"),[2,this.createOfferLegacy()];if(p.debug("[createOffer] Method RTCPeerConnection.addTransceiver() is available; using it"),"recvonly"===this.configuration.mode)return[3,7];if(!this.configuration.mediaStream)throw new Error("[WebRtcPeer.createOffer] Direction is '".concat(this.configuration.mode,"', but no stream was configured to be sent"));o=0,d=this.configuration.mediaStream.getTracks(),s.label=1;case 1:if(!(o<d.length))return[3,6];if(l=d[o],h={direction:this.configuration.mode,streams:[this.configuration.mediaStream]},"video"===l.kind&&this.configuration.simulcast)for(f=l.getSettings(),m=l.getConstraints(),v=null!==(n=null!==(t=null!==(e=f.width)&&void 0!==e?e:m.width.ideal)&&void 0!==t?t:m.width)&&void 0!==n?n:0,g=null!==(a=null!==(i=null!==(r=f.height)&&void 0!==r?r:m.height.ideal)&&void 0!==i?i:m.height)&&void 0!==a?a:0,p.info("[createOffer] Video track dimensions: ".concat(v,"x").concat(g)),b=v*g,E=0,E=b>=518400?3:b>=129600?2:1,h.sendEncodings=[],y=0;y<E;y++)S=Math.pow(2,E-y-1),w={rid:"rdiv"+S.toString(),scalabilityMode:"L1T1"},["detail","text"].includes(l.contentHint)?(w.scaleResolutionDownBy=1,w.maxFramerate=Math.floor(30/S)):w.scaleResolutionDownBy=S,h.sendEncodings.push(w);if(O=this.pc.addTransceiver(l,h),"video"!==l.kind)return[3,5];if(C=O.sender.getParameters(),R=!1,(null===(c=C.degradationPreference)||void 0===c?void 0:c.length)||(["detail","text"].includes(l.contentHint)?C.degradationPreference="maintain-resolution":C.degradationPreference="balanced",p.info("[createOffer] Video sender Degradation Preference set: ".concat(C.degradationPreference)),R=!0),this.configuration.simulcast&&(null===(u=C.encodings)||void 0===u?void 0:u.length)!==h.sendEncodings.length&&(C.encodings=h.sendEncodings,R=!0),!R)return[3,5];p.debug("[createOffer] Setting new RTCRtpSendParameters to video sender"),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,O.sender.setParameters(C)];case 3:return s.sent(),[3,5];case 4:throw I=s.sent(),_="[WebRtcPeer.createOffer] Cannot set RTCRtpSendParameters to video sender",I instanceof Error&&(_+=": ".concat(I.message)),new Error(_);case 5:return o++,[3,1];case 6:return[3,8];case 7:for(k=0,x=["audio","video"];k<x.length;k++)P=x[k],this.configuration.mediaConstraints[P]&&(this.configuration.mediaStream=new MediaStream,this.pc.addTransceiver(P,{direction:this.configuration.mode,streams:[this.configuration.mediaStream]}));s.label=8;case 8:return s.trys.push([8,10,,11]),[4,this.pc.createOffer()];case 9:return T=s.sent(),[3,11];case 10:throw N=s.sent(),_="[WebRtcPeer.createOffer] Browser failed creating an SDP Offer",N instanceof Error&&(_+=": ".concat(N.message)),new Error(_);case 11:return[2,T]}}))}))},e.prototype.deprecatedPeerConnectionTrackApi=function(){for(var e=0,t=this.configuration.mediaStream.getTracks();e<t.length;e++){var n=t[e];this.pc.addTrack(n,this.configuration.mediaStream)}},e.prototype.createAnswer=function(){var e=this;return new Promise((function(t,n){if("getTransceivers"in e.pc){p.debug("[createAnswer] Method RTCPeerConnection.getTransceivers() is available; using it");for(var r=function(t){if(!e.configuration.mediaConstraints[t])return"continue";var r=e.pc.getTransceivers().find((function(e){return e.receiver.track.kind===t}));if(!r)return{value:n(new Error("".concat(t," requested, but no transceiver was created from remote description")))};r.direction=e.configuration.mode},i=0,o=["audio","video"];i<o.length;i++){var s=o[i],a=r(s);if("object"===typeof a)return a.value}e.pc.createAnswer().then((function(e){return t(e)})).catch((function(e){return n(e)}))}else{var c=void 0,u=!0;if(e.configuration.mediaConstraints){c="boolean"!==typeof e.configuration.mediaConstraints.audio||e.configuration.mediaConstraints.audio,u="boolean"!==typeof e.configuration.mediaConstraints.video||e.configuration.mediaConstraints.video;var d={offerToReceiveAudio:c,offerToReceiveVideo:u};e.pc.createAnswer(d).then((function(e){return t(e)})).catch((function(e){return n(e)}))}}}))},e.prototype.processLocalOffer=function(e){var t=this;return new Promise((function(n,r){t.pc.setLocalDescription(e).then((function(){var e=t.pc.localDescription;return e?(p.debug("Local description set",e.sdp),n()):r("Local description is not defined")})).catch((function(e){return r(e)}))}))},e.prototype.processRemoteOffer=function(e){var t=this;return new Promise((function(n,r){var i={type:"offer",sdp:e};if(p.debug("SDP offer received, setting remote description",i),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set remote description");t.setRemoteDescription(i).then((function(){return n()})).catch((function(e){return r(e)}))}))},e.prototype.processLocalAnswer=function(e){var t=this;return new Promise((function(n,r){if(p.debug("SDP answer created, setting local description"),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set local description");t.pc.setLocalDescription(e).then((function(){return n()})).catch((function(e){return r(e)}))}))},e.prototype.processRemoteAnswer=function(e){var t=this;return new Promise((function(n,r){var i={type:"answer",sdp:e};if(p.debug("SDP answer received, setting remote description"),"closed"===t.pc.signalingState)return r("RTCPeerConnection is closed when trying to set remote description");t.setRemoteDescription(i).then((function(){n()})).catch((function(e){return r(e)}))}))},e.prototype.setRemoteDescription=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.pc.setRemoteDescription(e)]}))}))},e.prototype.addIceCandidate=function(e){var t=this;return new Promise((function(n,r){switch(p.debug("Remote ICE candidate received",e),t.remoteCandidatesQueue.push(e),t.pc.signalingState){case"closed":r(new Error("PeerConnection object is closed"));break;case"stable":t.pc.remoteDescription?t.pc.addIceCandidate(e).then((function(){return n()})).catch((function(e){return r(e)})):(t.iceCandidateList.push(e),n());break;default:t.iceCandidateList.push(e),n()}}))},e.prototype.addIceConnectionStateChangeListener=function(e){var t=this;this.pc.addEventListener("iceconnectionstatechange",(function(){var n=t.pc.iceConnectionState;switch(n){case"disconnected":var r="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "disconnected". Possible network disconnection';p.warn(r),t.configuration.onIceConnectionStateException(u.ExceptionEventName.ICE_CONNECTION_DISCONNECTED,r);break;case"failed":var i="IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') to "failed"';p.error(i),t.configuration.onIceConnectionStateException(u.ExceptionEventName.ICE_CONNECTION_FAILED,i);break;case"closed":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "closed"');break;case"new":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "new"');break;case"checking":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "checking"');break;case"connected":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "connected"');break;case"completed":p.log("IceConnectionState of RTCPeerConnection "+t.configuration.id+" ("+e+') change to "completed"');break}}))},e.prototype.generateUniqueId=function(){return(0,c.v4)()},e}();t.WebRtcPeer=h;var f=function(e){function t(t){var n=this;return t.mode="recvonly",n=e.call(this,t)||this,n}return r(t,e),t}(h);t.WebRtcPeerRecvonly=f;var m=function(e){function t(t){var n=this;return t.mode="sendonly",n=e.call(this,t)||this,n}return r(t,e),t}(h);t.WebRtcPeerSendonly=m;var v=function(e){function t(t){var n=this;return t.mode="sendrecv",n=e.call(this,t)||this,n}return r(t,e),t}(h);t.WebRtcPeerSendrecv=v},7137:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRtcStats=void 0;var o,s=n(5364),a=n(5971),c=s.OpenViduLogger.getInstance(),u=function(){function e(e){this.stream=e,this.STATS_ITEM_NAME="webrtc-stats-config",this.webRtcStatsEnabled=!1,this.statsInterval=1,o=a.PlatformUtils.getInstance()}return e.prototype.isEnabled=function(){return this.webRtcStatsEnabled},e.prototype.initWebRtcStats=function(){var e=this,t=localStorage.getItem(this.STATS_ITEM_NAME);if(t){this.webRtcStatsEnabled=!0;var n=JSON.parse(t);c.warn("WebRtc stats enabled for stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId),c.warn("localStorage item: "+JSON.stringify(n)),this.POST_URL=n.httpEndpoint,this.statsInterval=n.interval,this.webRtcStatsIntervalId=setInterval((function(){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.sendStatsToHttpEndpoint()];case 1:return e.sent(),[2]}}))}))}),1e3*this.statsInterval)}else c.debug("WebRtc stats not enabled")},e.prototype.getSelectedIceCandidateInfo=function(){var e=this;return new Promise((function(t,n){return r(e,void 0,void 0,(function(){var e,n,r,s,a,c,u,d,l,p,h,f,m,v,g,b,E,y,S,w,O,C;return i(this,(function(i){switch(i.label){case 0:return[4,this.stream.getRTCPeerConnection().getStats()];case 1:if(e=i.sent(),r=new Map,s=new Map,a=new Map,e.forEach((function(e){switch("transport"===e.type&&(o.isChromium()||o.isSafariBrowser()||o.isReactNative())&&(n=e),e.type){case"candidate-pair":r.set(e.id,e);break;case"local-candidate":s.set(e.id,e);break;case"remote-candidate":a.set(e.id,e);break}})),null!=n)u=n.selectedCandidatePairId,c=r.get(u);else for(d=r.size,l=r.values(),p=0;p<d;p++)if(h=l.next().value,h["selected"]){c=h;break}if(f=c.localCandidateId,m=c.remoteCandidateId,v=s.get(f),v)for(y=this.stream.getLocalIceCandidateList(),S=y.filter((function(e){return!!e.candidate&&(e.candidate.indexOf(v.ip)>=0||e.candidate.indexOf(v.address)>=0)&&e.candidate.indexOf(v.port)>=0})),v.raw=[],g=0,b=S;g<b.length;g++)C=b[g],v.raw.push(C.candidate);else v="ERROR: No active local ICE candidate. Probably ICE-TCP is being used";if(E=a.get(m),E)for(y=this.stream.getRemoteIceCandidateList(),S=y.filter((function(e){return!!e.candidate&&(e.candidate.indexOf(E.ip)>=0||e.candidate.indexOf(E.address)>=0)&&e.candidate.indexOf(E.port)>=0})),E.raw=[],w=0,O=S;w<O.length;w++)C=O[w],E.raw.push(C.candidate);else E="ERROR: No active remote ICE candidate. Probably ICE-TCP is being used";return[2,t({localCandidate:v,remoteCandidate:E})]}}))}))}))},e.prototype.stopWebRtcStats=function(){this.webRtcStatsEnabled&&(clearInterval(this.webRtcStatsIntervalId),c.warn("WebRtc stats stopped for disposed stream "+this.stream.streamId+" of connection "+this.stream.connection.connectionId))},e.prototype.sendStats=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n={headers:{"Content-type":"application/json"},body:JSON.stringify(t),method:"POST"},[4,fetch(e,n)];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),c.error("sendStats error: ".concat(JSON.stringify(r))),[3,3];case 3:return[2]}}))}))},e.prototype.sendStatsToHttpEndpoint=function(){return r(this,void 0,void 0,(function(){var e,t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.getCommonStats()];case 1:return e=r.sent(),t=this.generateJSONStatsResponse(e),[4,this.sendStats(this.POST_URL,t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),c.log(n),[3,4];case 4:return[2]}}))}))},e.prototype.getCommonStats=function(){return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){return r(e,void 0,void 0,(function(){var e,r,o,s,a,u=this;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.stream.getRTCPeerConnection().getStats()];case 1:return e=i.sent(),r=this.getWebRtcStatsResponseOutline(),o=["framesReceived","framesDropped","framesSent","frameHeight","frameWidth"],s=["availableOutgoingBitrate","currentRoundTripTime"],e.forEach((function(e){var t=null!=e.mediaType?e.mediaType:e.kind,n=function(n,i){null!=e[i]&&null!=r[n]&&(!t&&o.indexOf(i)>-1&&(t="video"),null!=n&&null!=t&&null!=i&&null!=r[n][t]?r[n][t][i]=Number(e[i]):null!=n&&null!=i&&s.includes(i)&&(r[n][i]=Number(e[i])))};switch(e.type){case"outbound-rtp":n("outbound","bytesSent"),n("outbound","packetsSent"),n("outbound","framesEncoded"),n("outbound","nackCount"),n("outbound","firCount"),n("outbound","pliCount"),n("outbound","qpSum");break;case"inbound-rtp":n("inbound","bytesReceived"),n("inbound","packetsReceived"),n("inbound","packetsLost"),n("inbound","jitter"),n("inbound","framesDecoded"),n("inbound","nackCount"),n("inbound","firCount"),n("inbound","pliCount");break;case"track":n("inbound","jitterBufferDelay"),n("inbound","framesReceived"),n("outbound","framesDropped"),n("outbound","framesSent"),n(u.stream.isLocal()?"outbound":"inbound","frameHeight"),n(u.stream.isLocal()?"outbound":"inbound","frameWidth");break;case"candidate-pair":n("candidatepair","currentRoundTripTime"),n("candidatepair","availableOutgoingBitrate");break}})),(null===r||void 0===r?void 0:r.candidatepair)&&0!==Object.keys(r.candidatepair).length||delete r.candidatepair,[2,t(r)];case 2:return a=i.sent(),c.error("Error getting common stats: ",a),[2,n(a)];case 3:return[2]}}))}))}))]}))}))},e.prototype.generateJSONStatsResponse=function(e){return{"@timestamp":(new Date).toISOString(),participant_id:this.stream.connection.data,session_id:this.stream.session.sessionId,platform:o.getName(),platform_description:o.getDescription(),stream:"webRTC",webrtc_stats:e}},e.prototype.getWebRtcStatsResponseOutline=function(){return this.stream.isLocal()?{outbound:{audio:{},video:{}},candidatepair:{}}:{inbound:{audio:{},video:{}}}},e}();t.WebRtcStats=u},3274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Connection=void 0;var r=n(7686),i=n(5364),o=n(6056),s=i.OpenViduLogger.getInstance(),a=function(){function e(e,t){this.session=e,this.disposed=!1;var n="'Connection' created ";t.role?(this.localOptions=t,this.connectionId=this.localOptions.id,this.creationTime=this.localOptions.createdAt,this.data=this.localOptions.metadata,this.rpcSessionId=this.localOptions.sessionId,this.role=this.localOptions.role,this.record=this.localOptions.record,n+="(local)"):(this.remoteOptions=t,this.connectionId=this.remoteOptions.id,this.creationTime=this.remoteOptions.createdAt,this.remoteOptions.metadata&&(this.data=this.remoteOptions.metadata),this.remoteOptions.streams&&this.initRemoteStreams(this.remoteOptions.streams),n+="(remote) with 'connectionId' ["+this.remoteOptions.id+"]"),s.info(n)}return e.prototype.sendIceCandidate=function(e){var t=this;s.debug((this.stream.outboundStreamOpts?"Local":"Remote")+"candidate for"+this.connectionId,e),this.session.openvidu.sendRequest("onIceCandidate",{endpointName:this.connectionId,candidate:e.candidate,sdpMid:e.sdpMid,sdpMLineIndex:e.sdpMLineIndex},(function(e,n){e&&(s.error("Error sending ICE candidate: "+JSON.stringify(e)),t.session.emitEvent("exception",[new o.ExceptionEvent(t.session,o.ExceptionEventName.ICE_CANDIDATE_ERROR,t.session,"There was an unexpected error on the server-side processing an ICE candidate generated and sent by the client-side",e)]))}))},e.prototype.initRemoteStreams=function(e){var t=this;e.forEach((function(e){var n={id:e.id,createdAt:e.createdAt,connection:t,hasAudio:e.hasAudio,hasVideo:e.hasVideo,audioActive:e.audioActive,videoActive:e.videoActive,typeOfVideo:e.typeOfVideo,frameRate:e.frameRate,videoDimensions:e.videoDimensions?JSON.parse(e.videoDimensions):void 0,filter:e.filter?e.filter:void 0},i=new r.Stream(t.session,n);t.addStream(i)})),s.info("Remote 'Connection' with 'connectionId' ["+this.connectionId+"] is now configured for receiving Streams with options: ",this.stream.inboundStreamOpts)},e.prototype.addStream=function(e){e.connection=this,this.stream=e},e.prototype.removeStream=function(e){delete this.stream},e.prototype.dispose=function(){this.stream&&delete this.stream,this.disposed=!0},e}();t.Connection=a},3013:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=void 0;var r=n(4795),i=n(5364),o=i.OpenViduLogger.getInstance(),s=function(){function e(){this.userHandlerArrowHandler=new WeakMap,this.ee=new r}return e.prototype.onAux=function(e,t,n){var r=function(e){e?o.info(t,e):o.info(t),n(e)};return this.userHandlerArrowHandler.set(n,r),this.ee.on(e,r),this},e.prototype.onceAux=function(e,t,n){var r=this,i=function(e){e?o.info(t,e):o.info(t),n(e),r.userHandlerArrowHandler.delete(n)};return this.userHandlerArrowHandler.set(n,i),this.ee.once(e,i),this},e.prototype.offAux=function(e,t){if(t){var n=this.userHandlerArrowHandler.get(t);n&&this.ee.off(e,n),this.userHandlerArrowHandler.delete(t)}else this.ee.removeAllListeners(e);return this},e}();t.EventDispatcher=s},6153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Filter=void 0;var r=n(7614),i=n(7009),o=n(5364),s=o.OpenViduLogger.getInstance(),a=function(){function e(e,t){this.handlers=new Map,this.type=e,this.options=t}return e.prototype.execMethod=function(e,t){var n=this;return new Promise((function(o,a){var c,u;s.info("Executing filter method to stream "+n.stream.streamId);var d=function(t){s.info("Filter method successfully executed on Stream "+n.stream.streamId);var i=Object.assign({},n.stream.filter);return n.stream.filter.lastExecMethod={method:e,params:u},t&&(n.stream.session.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.session,n.stream,"filter",n.stream.filter,i,"execFilterMethod")]),n.stream.streamManager.emitEvent("streamPropertyChanged",[new r.StreamPropertyChangedEvent(n.stream.streamManager,n.stream,"filter",n.stream.filter,i,"execFilterMethod")])),o()};if(n.type.startsWith("VB:")){if("string"===typeof t)try{t=JSON.parse(t)}catch(h){return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Wrong params syntax: "+h))}if(u=t,"update"!==e)return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Unknown Virtual Background method "'.concat(e,'"')));if(!(null===(c=n.stream.virtualBackgroundSinkElements)||void 0===c?void 0:c.VB))return a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"There is no Virtual Background filter applied"));n.stream.virtualBackgroundSinkElements.VB.updateValues(t).then((function(){return d(!1)})).catch((function(e){return e.name===i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?a(new i.OpenViduError(e.name,e.message)):a(new i.OpenViduError(i.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"Error updating values on Virtual Background filter: "+e))}))}else{var l=void 0;if("string"!==typeof t)try{l=JSON.stringify(t)}catch(h){var p="'params' property must be a JSON formatted object";return s.error(p),a(p)}else l=t;u=l,n.stream.session.openvidu.sendRequest("execFilterMethod",{streamId:n.stream.streamId,method:e,params:l},(function(e,t){return e?(s.error("Error executing filter method for Stream "+n.stream.streamId,e),401===e.code?a(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to execute a filter method")):a(e)):d(!0)}))}}))},e.prototype.addEventListener=function(e,t){var n=this;return new Promise((function(r,o){s.info("Adding filter event listener to event "+e+" to stream "+n.stream.streamId),n.stream.session.openvidu.sendRequest("addFilterEventListener",{streamId:n.stream.streamId,eventType:e},(function(a,c){return a?(s.error("Error adding filter event listener to event "+e+"for Stream "+n.stream.streamId,a),401===a.code?o(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):o(a)):(n.handlers.set(e,t),s.info("Filter event listener to event "+e+" successfully applied on Stream "+n.stream.streamId),r())}))}))},e.prototype.removeEventListener=function(e){var t=this;return new Promise((function(n,r){s.info("Removing filter event listener to event "+e+" to stream "+t.stream.streamId),t.stream.session.openvidu.sendRequest("removeFilterEventListener",{streamId:t.stream.streamId,eventType:e},(function(o,a){return o?(s.error("Error removing filter event listener to event "+e+"for Stream "+t.stream.streamId,o),401===o.code?r(new i.OpenViduError(i.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to add a filter event listener")):r(o)):(t.handlers.delete(e),s.info("Filter event listener to event "+e+" successfully removed on Stream "+t.stream.streamId),n())}))}))},e}();t.Filter=a},1944:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalRecorder=void 0;var r,i=n(9690),o=n(5364),s=n(5971),a=n(4026),c=o.OpenViduLogger.getInstance(),u=function(){function e(e){this.stream=e,this.chunks=[],r=s.PlatformUtils.getInstance(),this.connectionId=this.stream.connection?this.stream.connection.connectionId:"default-connection",this.id=this.stream.streamId+"_"+this.connectionId+"_localrecord",this.state=i.LocalRecorderState.READY}return e.prototype.record=function(e){var t=this;return new Promise((function(n,r){try{if("string"===typeof e||e instanceof String)return r("When calling LocalRecorder.record(options) parameter 'options' cannot be a string. Must be an object like { mimeType: \"".concat(e,'" }'));if("undefined"===typeof MediaRecorder)throw c.error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder"),Error("MediaRecorder not supported on your device. See compatibility in https://caniuse.com/#search=MediaRecorder");if(t.state!==i.LocalRecorderState.READY)throw Error("'LocalRecord.record()' needs 'LocalRecord.state' to be 'READY' (current value: '"+t.state+"'). Call 'LocalRecorder.clean()' or init a new LocalRecorder before");c.log("Starting local recording of stream '"+t.stream.streamId+"' of connection '"+t.connectionId+"'"),e?e.mimeType||(e.mimeType="video/webm"):e={mimeType:"video/webm"},t.mediaRecorder=new MediaRecorder(t.stream.getMediaStream(),e),t.mediaRecorder.start()}catch(o){return r(o)}return t.mediaRecorder.ondataavailable=function(e){e.data.size>0&&t.chunks.push(e.data)},t.mediaRecorder.onerror=function(e){c.error("MediaRecorder error: ",e)},t.mediaRecorder.onstart=function(){c.log("MediaRecorder started (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onstop=function(){t.onStopDefault()},t.mediaRecorder.onpause=function(){c.log("MediaRecorder paused (state="+t.mediaRecorder.state+")")},t.mediaRecorder.onresume=function(){c.log("MediaRecorder resumed (state="+t.mediaRecorder.state+")")},t.state=i.LocalRecorderState.RECORDING,n()}))},e.prototype.stop=function(){var e=this;return new Promise((function(t,n){try{if(e.state===i.LocalRecorderState.READY||e.state===i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.stop()' needs 'LocalRecord.state' to be 'RECORDING' or 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' before");e.mediaRecorder.onstop=function(){return e.onStopDefault(),t()},e.mediaRecorder.stop()}catch(r){return n(r)}}))},e.prototype.pause=function(){var e=this;return new Promise((function(t,n){try{return e.state!==i.LocalRecorderState.RECORDING?n(Error("'LocalRecord.pause()' needs 'LocalRecord.state' to be 'RECORDING' (current value: '"+e.state+"'). Call 'LocalRecorder.start()' or 'LocalRecorder.resume()' before")):(e.mediaRecorder.pause(),e.state=i.LocalRecorderState.PAUSED,t())}catch(r){return n(r)}}))},e.prototype.resume=function(){var e=this;return new Promise((function(t,n){try{if(e.state!==i.LocalRecorderState.PAUSED)throw Error("'LocalRecord.resume()' needs 'LocalRecord.state' to be 'PAUSED' (current value: '"+e.state+"'). Call 'LocalRecorder.pause()' before");return e.mediaRecorder.resume(),e.state=i.LocalRecorderState.RECORDING,t()}catch(r){return n(r)}}))},e.prototype.preview=function(e){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.preview()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");if(this.videoPreview=document.createElement("video"),this.videoPreview.id=this.id,this.videoPreview.autoplay=!0,r.isSafariBrowser()&&this.videoPreview.setAttribute("playsinline","true"),"string"===typeof e){var t=document.getElementById(e);t&&(this.videoPreview=t.appendChild(this.videoPreview))}else this.videoPreview=e.appendChild(this.videoPreview);return this.videoPreview.src=this.videoPreviewSrc,this.videoPreview},e.prototype.clean=function(){var e=this,t=function(){delete e.blob,e.chunks=[],e.state=i.LocalRecorderState.READY};this.state===i.LocalRecorderState.RECORDING||this.state===i.LocalRecorderState.PAUSED?this.stop().then((function(){return t()})).catch((function(){return t()})):t()},e.prototype.download=function(){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("'LocalRecord.download()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+this.state+"'). Call 'LocalRecorder.stop()' before");var e=document.createElement("a");e.style.display="none",document.body.appendChild(e);var t=window.URL.createObjectURL(this.blob);e.href=t,e.download=this.id+"."+a.getExtension(this.blob.type),e.click(),window.URL.revokeObjectURL(t),document.body.removeChild(e)},e.prototype.getBlob=function(){if(this.state!==i.LocalRecorderState.FINISHED)throw Error("Call 'LocalRecord.stop()' before getting Blob file");return this.blob},e.prototype.uploadAsBinary=function(e,t){var n=this;return new Promise((function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsBinary()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"===typeof t)for(var a=0,c=Object.keys(t);a<c.length;a++){var u=c[a];s.setRequestHeader(u,t[u])}s.onreadystatechange=function(){if(4===s.readyState)return"2"===s.status.toString().charAt(0)?r(s.responseText):o(s.status)},s.send(n.blob)}))},e.prototype.uploadAsMultipartfile=function(e,t){var n=this;return new Promise((function(r,o){if(n.state!==i.LocalRecorderState.FINISHED)return o(Error("'LocalRecord.uploadAsMultipartfile()' needs 'LocalRecord.state' to be 'FINISHED' (current value: '"+n.state+"'). Call 'LocalRecorder.stop()' before"));var s=new XMLHttpRequest;if(s.open("POST",e,!0),"object"===typeof t)for(var c=0,u=Object.keys(t);c<u.length;c++){var d=u[c];s.setRequestHeader(d,t[d])}var l=new FormData;l.append("file",n.blob,n.id+"."+a.getExtension(n.blob.type)),s.onreadystatechange=function(){if(4===s.readyState)return"2"===s.status.toString().charAt(0)?r(s.responseText):o(s.status)},s.send(l)}))},e.prototype.onStopDefault=function(){c.log("MediaRecorder stopped  (state="+this.mediaRecorder.state+")"),this.blob=new Blob(this.chunks,{type:this.mediaRecorder.mimeType}),this.chunks=[],this.videoPreviewSrc=window.URL.createObjectURL(this.blob),this.state=i.LocalRecorderState.FINISHED},e}();t.LocalRecorder=u},4527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenVidu=void 0;var r,i=n(1944),o=n(2917),s=n(8330),a=n(3439),c=n(7614),u=n(7009),d=n(4270),l=n(5364),p=n(5971),h=n(3061),f=n(9544),m=n(327),v=n(4795),g=n(4834),b=n(5549),E=l.OpenViduLogger.getInstance(),y=function(){function e(){var e=this;this.masterNodeHasCrashed=!1,this.publishers=[],this.secret="",this.recorder=!1,this.life=-1,this.advancedConfiguration={},this.webrtcStatsInterval=-1,this.sendBrowserLogs=m.OpenViduLoggerConfiguration.disabled,this.isAtLeastPro=!1,this.isEnterprise=!1,this.ee=new v,r=p.PlatformUtils.getInstance(),this.libraryVersion=b.version,E.info("OpenVidu initialized"),E.info("Platform detected: "+r.getDescription()),E.info("openvidu-browser version: "+this.libraryVersion),(r.isMobileDevice()||r.isReactNative())&&this.onOrientationChanged((function(){e.publishers.forEach((function(t){t.stream.isLocalStreamPublished&&t.stream&&t.stream.hasVideo&&e.sendNewVideoDimensionsIfRequired(t,"deviceRotated",75,10)}))}))}return e.prototype.initSession=function(){return this.session=new s.Session(this),this.session},e.prototype.initPublisher=function(e,t,n){var r;t&&"function"!==typeof t?(r=t,r={audioSource:"undefined"!==typeof r.audioSource?r.audioSource:void 0,frameRate:"undefined"!==typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:"undefined"!==typeof r.frameRate?r.frameRate:void 0,insertMode:"undefined"!==typeof r.insertMode?"string"===typeof r.insertMode?d.VideoInsertMode[r.insertMode]:r.insertMode:d.VideoInsertMode.APPEND,mirror:"undefined"===typeof r.mirror||r.mirror,publishAudio:"undefined"===typeof r.publishAudio||r.publishAudio,publishVideo:"undefined"===typeof r.publishVideo||r.publishVideo,resolution:"undefined"!==typeof MediaStreamTrack&&r.videoSource instanceof MediaStreamTrack?void 0:"undefined"!==typeof r.resolution?r.resolution:"640x480",videoSource:"undefined"!==typeof r.videoSource?r.videoSource:void 0,videoSimulcast:r.videoSimulcast,filter:r.filter}):r={insertMode:d.VideoInsertMode.APPEND,mirror:!0,publishAudio:!0,publishVideo:!0,resolution:"640x480"};var i,s=new o.Publisher(e,r,this);return t&&"function"===typeof t?i=t:n&&(i=n),s.initialize().then((function(){void 0!==i&&i(void 0),s.emitEvent("accessAllowed",[])})).catch((function(e){void 0!==i&&i(e),s.emitEvent("accessDenied",[e])})),this.publishers.push(s),s},e.prototype.initPublisherAsync=function(e,t){var n=this;return new Promise((function(r,i){var o,s=function(e){return e?i(e):r(o)};o=t?n.initPublisher(e,t,s):n.initPublisher(e,s)}))},e.prototype.initLocalRecorder=function(e){return new i.LocalRecorder(e)},e.prototype.checkSystemRequirements=function(){return r.isIPhoneOrIPad()?r.isIOSWithSafari()||r.isIonicIos()||r.isChromeMobileBrowser()||r.isEdgeMobileBrowser()||r.isOperaMobileBrowser()||r.isFirefoxMobileBrowser()?1:0:r.isChromeBrowser()||r.isChromeMobileBrowser()||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||r.isOperaBrowser()||r.isOperaMobileBrowser()||r.isEdgeBrowser()||r.isEdgeMobileBrowser()||r.isSafariBrowser()||r.isAndroidBrowser()||r.isElectron()||r.isSamsungBrowser()?1:0},e.prototype.checkScreenSharingCapabilities=function(){return r.canScreenShare()},e.prototype.getDevices=function(){return new Promise((function(e,t){navigator.mediaDevices.enumerateDevices().then((function(t){var n,i=[];if(!r.isIonicAndroid()||"undefined"==typeof cordova||!(null===(n=null===cordova||void 0===cordova?void 0:cordova.plugins)||void 0===n?void 0:n.EnumerateDevicesPlugin))return t.forEach((function(e){"audioinput"!==e.kind&&"videoinput"!==e.kind||i.push({kind:e.kind,deviceId:e.deviceId,label:e.label})})),e(i);cordova.plugins.EnumerateDevicesPlugin.getEnumerateDevices().then((function(n){var r=[],o=[],s=[];return r=n.filter((function(e){return"audioinput"===e.kind})),o=t.filter((function(e){return"videoinput"===e.kind})),s=t.filter((function(e){return"audioinput"===e.kind})),o.forEach((function(e,t){if(e.label)i.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";n=0===t?"Front Camera":1===t?"Back Camera":"Unknown Camera",i.push({kind:e.kind,deviceId:e.deviceId,label:n})}})),s.forEach((function(e,t){if(e.label)i.push({kind:e.kind,deviceId:e.deviceId,label:e.label});else{var n="";switch(t){case 0:n="Default";break;case 1:var o=r.filter((function(e){return e.label.includes("Built")}))[0];n=o?o.label:"Built-in Microphone";break;case 2:var s=r.filter((function(e){return e.label.includes("Wired")}))[0];n=s?s.label:"Headset earpiece";break;case 3:var a=r.filter((function(e){return e.label.includes("Bluetooth")}))[0];n=a?a.label:"Wireless";break;default:n="Unknown Microphone";break}i.push({kind:e.kind,deviceId:e.deviceId,label:n})}})),e(i)}))})).catch((function(e){return E.error("Error getting devices",e),t(e)}))}))},e.prototype.getUserMedia=function(e){var t=this;return new Promise((function(n,i){var o=function(e,r){var o=void 0===r.audio||r.audio,s={audio:o,video:!1};navigator.mediaDevices.getUserMedia(s).then((function(t){return e.addTrack(t.getAudioTracks()[0]),n(e)})).catch((function(n){return e.getAudioTracks().forEach((function(e){e.stop()})),e.getVideoTracks().forEach((function(e){e.stop()})),i(t.generateAudioDeviceError(n,s))}))};t.generateMediaConstraints(e).then((function(s){var a,c;if(s.videoTrack&&s.audioTrack||s.audioTrack&&!1===(null===(a=s.constraints)||void 0===a?void 0:a.video)||s.videoTrack&&!1===(null===(c=s.constraints)||void 0===c?void 0:c.audio))return n(t.addAlreadyProvidedTracks(s,new MediaStream));s.videoTrack&&delete s.constraints.video,s.audioTrack&&delete s.constraints.audio;var d=!1;if("string"===typeof e.videoSource&&("screen"===e.videoSource||"window"===e.videoSource||r.isElectron()&&e.videoSource.startsWith("screen:"))&&(d=!s.audioTrack&&null!==e.audioSource&&!1!==e.audioSource,navigator.mediaDevices["getDisplayMedia"]&&!r.isElectron()))navigator.mediaDevices["getDisplayMedia"]({video:!0}).then((function(e){return t.addAlreadyProvidedTracks(s,e),d?void o(e,s.constraints):n(e)})).catch((function(e){var t=u.OpenViduErrorName.SCREEN_CAPTURE_DENIED,n=e.toString();return i(new u.OpenViduError(t,n))}));else{var l=d?{video:s.constraints.video}:s.constraints;navigator.mediaDevices.getUserMedia(l).then((function(e){return t.addAlreadyProvidedTracks(s,e),d?void o(e,s.constraints):n(e)})).catch((function(t){var n,r=t.toString();return n="screen"!==e.videoSource?u.OpenViduErrorName.DEVICE_ACCESS_DENIED:u.OpenViduErrorName.SCREEN_CAPTURE_DENIED,i(new u.OpenViduError(n,r))}))}})).catch((function(e){return i(e)}))}))},e.prototype.enableProdMode=function(){E.enableProdMode()},e.prototype.setAdvancedConfiguration=function(e){this.advancedConfiguration=e},e.prototype.onOrientationChanged=function(e){window.addEventListener("orientationchange",e)},e.prototype.sendNewVideoDimensionsIfRequired=function(e,t,n,r){var i=this,o=0,s=e.stream.videoDimensions.width,a=e.stream.videoDimensions.height,c=setInterval((function(){o++,o>r&&clearTimeout(c),e.getVideoDimensions().then((function(n){n.width===s&&n.height===a||(clearTimeout(c),i.sendVideoDimensionsChangedEvent(e,t,s,a,n.width,n.height))}))}),n)},e.prototype.sendVideoDimensionsChangedEvent=function(e,t,n,r,i,o){var s=this;e.stream.videoDimensions={width:i||0,height:o||0},this.sendRequest("streamPropertyChanged",{streamId:e.stream.streamId,property:"videoDimensions",newValue:JSON.stringify(e.stream.videoDimensions),reason:t},(function(i,o){i?E.error("Error sending 'streamPropertyChanged' event",i):(s.session.emitEvent("streamPropertyChanged",[new c.StreamPropertyChangedEvent(s.session,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:r},t)]),e.emitEvent("streamPropertyChanged",[new c.StreamPropertyChangedEvent(e,e.stream,"videoDimensions",e.stream.videoDimensions,{width:n,height:r},t)]),s.session.sendVideoData(e))}))},e.prototype.generateMediaConstraints=function(e){var t=this;return new Promise((function(n,r){var i={audioTrack:void 0,videoTrack:void 0,constraints:{audio:void 0,video:void 0}},o=e.audioSource,s=e.videoSource;if(null!==o&&!1!==o||(i.constraints.audio=!1),null!==s&&!1!==s||(i.constraints.video=!1),!1===i.constraints.audio&&!1===i.constraints.video)return r(new u.OpenViduError(u.OpenViduErrorName.NO_INPUT_SOURCE_SET,"Properties 'audioSource' and 'videoSource' cannot be set to false or null at the same time"));if("undefined"!==typeof MediaStreamTrack&&o instanceof MediaStreamTrack&&(i.audioTrack=o),"undefined"!==typeof MediaStreamTrack&&s instanceof MediaStreamTrack&&(i.videoTrack=s),void 0===o&&(i.constraints.audio=!0),void 0===s&&(i.constraints.video={width:{ideal:640},height:{ideal:480}}),null!==s&&!1!==s){if(e.resolution){var a=e.resolution.toLowerCase().split("x"),c=Number(a[0]),d=Number(a[1]);i.constraints.video={width:{ideal:c},height:{ideal:d}}}e.frameRate&&(i.constraints.video.frameRate={ideal:e.frameRate})}return t.configureDeviceIdOrScreensharing(i,e,n,r),n(i)}))},e.prototype.startWs=function(e){var t={heartbeat:5e3,ws:{uri:this.wsUri+"?sessionId="+this.session.sessionId,onconnected:e,ondisconnect:this.disconnectCallback.bind(this),onreconnecting:this.reconnectingCallback.bind(this),onreconnected:this.reconnectedCallback.bind(this),ismasternodecrashed:this.isMasterNodeCrashed.bind(this)},rpc:{requestTimeout:1e4,heartbeatRequestTimeout:5e3,participantJoined:this.session.onParticipantJoined.bind(this.session),participantPublished:this.session.onParticipantPublished.bind(this.session),participantUnpublished:this.session.onParticipantUnpublished.bind(this.session),participantLeft:this.session.onParticipantLeft.bind(this.session),participantEvicted:this.session.onParticipantEvicted.bind(this.session),recordingStarted:this.session.onRecordingStarted.bind(this.session),recordingStopped:this.session.onRecordingStopped.bind(this.session),sendMessage:this.session.onNewMessage.bind(this.session),streamPropertyChanged:this.session.onStreamPropertyChanged.bind(this.session),connectionPropertyChanged:this.session.onConnectionPropertyChanged.bind(this.session),networkQualityLevelChanged:this.session.onNetworkQualityLevelChangedChanged.bind(this.session),filterEventDispatched:this.session.onFilterEventDispatched.bind(this.session),iceCandidate:this.session.recvIceCandidate.bind(this.session),mediaError:this.session.onMediaError.bind(this.session),masterNodeCrashedNotification:this.onMasterNodeCrashedNotification.bind(this),forciblyReconnectSubscriber:this.session.onForciblyReconnectSubscriber.bind(this.session)}};this.jsonRpcClient=new g.clients.JsonRpcClient(t)},e.prototype.onMasterNodeCrashedNotification=function(e){console.error("Master Node has crashed"),this.masterNodeHasCrashed=!0,this.session.onLostConnection("nodeCrashed"),this.jsonRpcClient.close(4103,"Master Node has crashed")},e.prototype.getWsReadyState=function(){return this.jsonRpcClient.getReadyState()},e.prototype.closeWs=function(){this.jsonRpcClient.close(4102,"Connection closed by client")},e.prototype.sendRequest=function(e,t,n){t&&t instanceof Function&&(n=t,t={}),E.debug('Sending request: {method:"'+e+'", params: '+JSON.stringify(t)+"}"),this.jsonRpcClient.send(e,t,n)},e.prototype.getWsUri=function(){return this.wsUri},e.prototype.getSecret=function(){return this.secret},e.prototype.getRecorder=function(){return this.recorder},e.prototype.generateAudioDeviceError=function(e,t){var n,r;switch("Error"===e.name&&(e.name=e.constructor.name),e.name.toLowerCase()){case"notfounderror":return n=u.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r=e.toString(),new u.OpenViduError(n,r);case"notallowederror":return n=u.OpenViduErrorName.DEVICE_ACCESS_DENIED,r=e.toString(),new u.OpenViduError(n,r);case"overconstrainederror":return"deviceid"===e.constraint.toLowerCase()?(n=u.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,r="Audio input device with deviceId '"+t.audio.deviceId.exact+"' not found"):(n=u.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,r="Audio input device doesn't support the value passed for constraint '"+e.constraint+"'"),new u.OpenViduError(n,r);case"notreadableerror":return n=u.OpenViduErrorName.DEVICE_ALREADY_IN_USE,r=e.toString(),new u.OpenViduError(n,r);default:return new u.OpenViduError(u.OpenViduErrorName.INPUT_AUDIO_DEVICE_GENERIC_ERROR,e.toString())}},e.prototype.addAlreadyProvidedTracks=function(e,t,n){return e.videoTrack&&(t.addTrack(e.videoTrack),n&&(e.constraints.video?n.lastVideoTrackConstraints=e.constraints.video:n.lastVideoTrackConstraints=e.videoTrack.getConstraints())),e.audioTrack&&t.addTrack(e.audioTrack),t},e.prototype.configureDeviceIdOrScreensharing=function(e,t,n,i){var o=this,s=t.audioSource,a=t.videoSource;if("string"===typeof s&&(e.constraints.audio={deviceId:{exact:s}}),"string"===typeof a){if(this.isScreenShare(a)){if(this.checkScreenSharingCapabilities()){if(r.isElectron()){var c="screen:",d=a,l=d.substr(d.indexOf(c)+c.length);return e.constraints.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:l}},n(e)}if(!this.advancedConfiguration.screenShareChromeExtension||r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()||navigator.mediaDevices["getDisplayMedia"]){if(navigator.mediaDevices["getDisplayMedia"])return n(e);var p=r.isFirefoxBrowser()||r.isFirefoxMobileBrowser()?t.videoSource:void 0;return void h.getScreenId(p,(function(t,r,s){if(t){if("not-installed"===t){var a=o.advancedConfiguration.screenShareChromeExtension?o.advancedConfiguration.screenShareChromeExtension:"https://chrome.google.com/webstore/detail/openvidu-screensharing/lfcgfepafnobdloecchnfaclibenjold",c=new u.OpenViduError(u.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,a);return E.error(c),i(c)}if("installed-disabled"===t){c=new u.OpenViduError(u.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return E.error(c),i(c)}if("permission-denied"===t){c=new u.OpenViduError(u.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return E.error(c),i(c)}c=new u.OpenViduError(u.OpenViduErrorName.GENERIC_ERROR,"Unknown error when accessing screen share");return E.error(c),E.error(t),i(c)}return e.constraints.video=s.video,n(e)}))}return void f.getScreenConstraints((function(t,r){if(!(t||r.mandatory&&"screen"===r.mandatory.chromeMediaSource))return e.constraints.video=r,n(e);if("permission-denied"===t||"PermissionDeniedError"===t){var s=new u.OpenViduError(u.OpenViduErrorName.SCREEN_CAPTURE_DENIED,"You must allow access to one window of your desktop");return E.error(s),i(s)}var a=o.advancedConfiguration.screenShareChromeExtension.split("/").pop().trim();f.getChromeExtensionStatus(a,(function(e){if("installed-disabled"===e){var t=new u.OpenViduError(u.OpenViduErrorName.SCREEN_EXTENSION_DISABLED,"You must enable the screen extension");return E.error(t),i(t)}if("not-installed"===e){var n=new u.OpenViduError(u.OpenViduErrorName.SCREEN_EXTENSION_NOT_INSTALLED,o.advancedConfiguration.screenShareChromeExtension);return E.error(n),i(n)}}))}))}var m=new u.OpenViduError(u.OpenViduErrorName.SCREEN_SHARING_NOT_SUPPORTED,"You can only screen share in desktop Chrome, Firefox, Opera, Safari (>=13.0), Edge (>= 80) or Electron. Detected client: "+r.getName()+" "+r.getVersion());return E.error(m),i(m)}this.setVideoSource(e,a)}},e.prototype.setVideoSource=function(e,t){e.constraints.video||(e.constraints.video={}),e.constraints.video["deviceId"]={exact:t}},e.prototype.disconnectCallback=function(){E.warn("Websocket connection lost"),this.isRoomAvailable()?this.session.onLostConnection("networkDisconnect"):alert("Connection error. Please reload page.")},e.prototype.reconnectingCallback=function(){E.warn("Websocket connection lost (reconnecting)"),this.isRoomAvailable()?this.session.emitEvent("reconnecting",[]):alert("Connection error. Please reload page.")},e.prototype.reconnectWebsocketThroughRpcConnectMethod=function(e){var t=this;this.sendRequest("connect",{sessionId:e,reconnect:!0},(function(e,n){if(e)if(t.isMasterNodeCrashed())E.warn("Master Node has crashed!");else{E.error(e);var r=function(e,n){E.warn(n),t.session.onLostConnection(e),t.jsonRpcClient.close(4101,"Reconnection fault: "+n)},i=function(){-1===t.life?r("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):t.sendRequest("sessionStatus",{sessionId:t.session.sessionId},(function(e,n){null!=e?console.error("Error checking session status",e):t.life===n.life?r("networkDisconnect","WS successfully reconnected but the user was already evicted due to timeout"):r("nodeCrashed","WS successfully reconnected to OpenVidu Server but your Master Node crashed")}))};40007===e.code&&"reconnection error"===e.message?(console.error("Invalid RPC sessionId. Client network disconnection or Master Node crash"),i()):i()}else t.jsonRpcClient.resetPing(),t.session.onRecoveredConnection()}))},e.prototype.reconnectedCallback=function(){if(E.warn("Websocket reconnected"),this.isRoomAvailable())if(this.session.connection)this.reconnectWebsocketThroughRpcConnectMethod(this.session.connection.rpcSessionId);else{E.warn("There was no previous connection when running reconnection callback");var e=new a.SessionDisconnectedEvent(this.session,"networkDisconnect");this.session.ee.emitEvent("sessionDisconnected",[e]),e.callDefaultBehavior()}else alert("Connection error. Please reload page.")},e.prototype.isMasterNodeCrashed=function(){return this.masterNodeHasCrashed},e.prototype.isRoomAvailable=function(){return void 0!==this.session&&this.session instanceof s.Session||(E.warn("Session instance not found"),!1)},e.prototype.isScreenShare=function(e){return"screen"===e||"window"===e||r.isElectron()&&e.startsWith("screen:")},e}();t.OpenVidu=y},2917:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Publisher=void 0;var s,a=n(8330),c=n(7686),u=n(2028),d=n(3590),l=n(7614),p=n(7009),h=n(5364),f=n(5971),m=n(1513),v=h.OpenViduLogger.getInstance(),g=function(e){function t(t,n,r){var i=e.call(this,new c.Stream(r.session?r.session:new a.Session(r),{publisherProperties:n,mediaConstraints:{}}),t)||this;return i.accessAllowed=!1,i.isSubscribedToRemote=!1,i.accessDenied=!1,s=f.PlatformUtils.getInstance(),i.properties=n,i.openvidu=r,i.stream.ee.on("local-stream-destroyed",(function(e){i.stream.isLocalStreamPublished=!1;var t=new d.StreamEvent(!0,i,"streamDestroyed",i.stream,e);i.emitEvent("streamDestroyed",[t]),t.callDefaultBehavior()})),i}return r(t,e),t.prototype.publishAudio=function(e){var t=this;if(this.stream.audioActive!==e){var n=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream();n.getAudioTracks().forEach((function(t){t.enabled=e})),this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"audioActive",newValue:e,reason:"publishAudio"},(function(n,r){n?v.error("Error sending 'streamPropertyChanged' event",n):(t.session.emitEvent("streamPropertyChanged",[new l.StreamPropertyChangedEvent(t.session,t.stream,"audioActive",e,!e,"publishAudio")]),t.emitEvent("streamPropertyChanged",[new l.StreamPropertyChangedEvent(t,t.stream,"audioActive",e,!e,"publishAudio")]),t.session.sendVideoData(t.stream.streamManager))})),this.stream.audioActive=e,v.info("'Publisher' has "+(e?"published":"unpublished")+" its audio stream")}},t.prototype.publishVideo=function(e,t){var n=this;return new Promise((function(r,s){return i(n,void 0,void 0,(function(){var n,a,c,u,d,p,h=this;return o(this,(function(f){switch(f.label){case 0:return this.stream.videoActive===e?[3,9]:(n=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),a=!1,n.getVideoTracks().forEach((function(n){n.enabled=e,e||!0!==t?e&&"ended"===n.readyState&&(a=!0):n.stop()})),!e&&!0===t&&this.stream.filter&&this.stream.filter.type.startsWith("VB:")?(this.stream.lastVBFilter=this.stream.filter,[4,this.stream.removeFilterAux(!0)]):[3,2]);case 1:f.sent(),f.label=2;case 2:return a?(c=n.getVideoTracks()[0],n.removeTrack(c),u=function(e){return i(h,void 0,void 0,(function(){var t=this;return o(this,(function(r){switch(r.label){case 0:return n.addTrack(e),this.stream.isLocalStreamPublished?[4,this.replaceTrackInRtcRtpSender(e)]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.stream.lastVBFilter&&setTimeout((function(){return i(t,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return e=this.stream.lastVBFilter.options,t=this.stream.lastVBFilter.lastExecMethod,t&&"update"===t.method&&(e=Object.assign({},e,t.params)),[4,this.stream.applyFilter(this.stream.lastVBFilter.type,e)];case 1:return n.sent(),delete this.stream.lastVBFilter,[2]}}))}))}),1),[2]}}))}))},t&&t instanceof MediaStreamTrack?[4,u(t)]:[3,4]):[3,8];case 3:return f.sent(),[3,8];case 4:return f.trys.push([4,7,,8]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:this.stream.lastVideoTrackConstraints})];case 5:return d=f.sent(),[4,u(d.getVideoTracks()[0])];case 6:return f.sent(),[3,8];case 7:return p=f.sent(),[2,s(p)];case 8:return this.session&&this.stream.streamId&&this.session.openvidu.sendRequest("streamPropertyChanged",{streamId:this.stream.streamId,property:"videoActive",newValue:e,reason:"publishVideo"},(function(t,n){t?v.error("Error sending 'streamPropertyChanged' event",t):(h.session.emitEvent("streamPropertyChanged",[new l.StreamPropertyChangedEvent(h.session,h.stream,"videoActive",e,!e,"publishVideo")]),h.emitEvent("streamPropertyChanged",[new l.StreamPropertyChangedEvent(h,h.stream,"videoActive",e,!e,"publishVideo")]),h.session.sendVideoData(h.stream.streamManager))})),this.stream.videoActive=e,v.info("'Publisher' has "+(e?"published":"unpublished")+" its video stream"),[2,r()];case 9:return[2]}}))}))}))},t.prototype.subscribeToRemote=function(e){e=void 0===e||e,this.isSubscribedToRemote=e,this.stream.subscribeToMyRemote(e)},t.prototype.on=function(t,n){var r=this;return e.prototype.on.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new d.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.on("stream-created-by-publisher",(function(){r.emitEvent("streamCreated",[new d.StreamEvent(!1,r,"streamCreated",r.stream,"")])}))),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.once=function(t,n){var r=this;return e.prototype.once.call(this,t,n),"streamCreated"===t&&(this.stream&&this.stream.isLocalStreamPublished?this.emitEvent("streamCreated",[new d.StreamEvent(!1,this,"streamCreated",this.stream,"")]):this.stream.ee.once("stream-created-by-publisher",(function(){r.emitEvent("streamCreated",[new d.StreamEvent(!1,r,"streamCreated",r.stream,"")])}))),"accessAllowed"===t&&this.accessAllowed&&this.emitEvent("accessAllowed",[]),"accessDenied"===t&&this.accessDenied&&this.emitEvent("accessDenied",[]),this},t.prototype.off=function(t,n){return e.prototype.off.call(this,t,n),this},t.prototype.replaceTrack=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){return[2,this.replaceTrackAux(e,!0)]}))}))},t.prototype.initialize=function(){var e=this;return new Promise((function(t,n){var r,i={},o={},a=2e3,c=function(t){return e.accessDenied=!0,e.accessAllowed=!1,v.error("Publisher initialization failed. ".concat(t.name,": ").concat(t.message)),n(t)},u=function(n){var r,i;if(e.accessAllowed=!0,e.accessDenied=!1,"undefined"!==typeof MediaStreamTrack&&e.properties.audioSource instanceof MediaStreamTrack&&(n.removeTrack(n.getAudioTracks()[0]),n.addTrack(e.properties.audioSource)),"undefined"!==typeof MediaStreamTrack&&e.properties.videoSource instanceof MediaStreamTrack&&(n.removeTrack(n.getVideoTracks()[0]),n.addTrack(e.properties.videoSource)),n.getAudioTracks()[0]){var o=void 0!==e.stream.audioActive&&null!==e.stream.audioActive?e.stream.audioActive:!!e.stream.outboundStreamOpts.publisherProperties.publishAudio;n.getAudioTracks()[0].enabled=o}if(n.getVideoTracks()[0]){o=void 0!==e.stream.videoActive&&null!==e.stream.videoActive?e.stream.videoActive:!!e.stream.outboundStreamOpts.publisherProperties.publishVideo;n.getVideoTracks()[0].enabled=o}for(var s=0,a=n.getAudioTracks();s<a.length;s++){var c=a[s];(null===(r=c.contentHint)||void 0===r?void 0:r.length)||(c.contentHint="",v.info("Audio track Content Hint set: '".concat(c.contentHint,"'")))}for(var u=0,d=n.getVideoTracks();u<d.length;u++){c=d[u];if(!(null===(i=c.contentHint)||void 0===i?void 0:i.length)){switch(e.stream.typeOfVideo){case m.TypeOfVideo.SCREEN:c.contentHint="detail";break;case m.TypeOfVideo.CUSTOM:v.warn("CUSTOM type video track was provided without Content Hint!"),c.contentHint="motion";break;case m.TypeOfVideo.CAMERA:case m.TypeOfVideo.IPCAM:default:c.contentHint="motion";break}v.info("Video track Content Hint set: '".concat(c.contentHint,"'"))}}return e.initializeVideoReference(n),e.stream.displayMyRemote()||e.stream.updateMediaStreamInVideos(),delete e.firstVideoElement,e.stream.isSendVideo()?e.getVideoDimensions().then((function(t){e.stream.videoDimensions={width:t.width,height:t.height},e.stream.isSendScreen()&&(e.screenShareResizeInterval=setInterval((function(){var t=n.getVideoTracks()[0].getSettings(),r=t.width,i=t.height,o=null!=r&&r!==e.stream.videoDimensions.width,s=null!=i&&i!==e.stream.videoDimensions.height;e.stream.isLocalStreamPublished&&(o||s)&&e.openvidu.sendVideoDimensionsChangedEvent(e,"screenResized",e.stream.videoDimensions.width,e.stream.videoDimensions.height,r||0,i||0)}),650)),e.stream.isLocalStreamReadyToPublish=!0,e.stream.ee.emitEvent("stream-ready-to-publish",[])})):(e.stream.isLocalStreamReadyToPublish=!0,e.stream.ee.emitEvent("stream-ready-to-publish",[])),t()},d=function(t,n){e.clearPermissionDialogTimer(r,a),e.stream.isSendScreen()&&e.stream.isSendAudio()?(o.audio=n,o.video=!1,r=Date.now(),e.setPermissionDialogTimer(a),navigator.mediaDevices.getUserMedia(o).then((function(n){e.clearPermissionDialogTimer(r,a),t.addTrack(n.getAudioTracks()[0]),u(t)})).catch((function(n){e.clearPermissionDialogTimer(r,a),t.getAudioTracks().forEach((function(e){e.stop()})),t.getVideoTracks().forEach((function(e){e.stop()})),c(e.openvidu.generateAudioDeviceError(n,i))}))):u(t)},l=function(t){var n,o;switch(v.error("getMediaError: ".concat(t.toString())),e.clearPermissionDialogTimer(r,a),"Error"===t.name&&(t.name=t.constructor.name),t.name.toLowerCase()){case"notfounderror":navigator.mediaDevices.getUserMedia({audio:!1,video:i.video}).then((function(e){e.getVideoTracks().forEach((function(e){e.stop()})),n=p.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,o=t.toString(),c(new p.OpenViduError(n,o))})).catch((function(e){n=p.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,o=t.toString(),c(new p.OpenViduError(n,o))}));break;case"notallowederror":n=e.stream.isSendScreen()?p.OpenViduErrorName.SCREEN_CAPTURE_DENIED:p.OpenViduErrorName.DEVICE_ACCESS_DENIED,o=t.toString(),c(new p.OpenViduError(n,o));break;case"overconstrainederror":navigator.mediaDevices.getUserMedia({audio:!1,video:i.video}).then((function(e){e.getVideoTracks().forEach((function(e){e.stop()})),"deviceid"===t.constraint.toLowerCase()?(n=p.OpenViduErrorName.INPUT_AUDIO_DEVICE_NOT_FOUND,o="Audio input device with deviceId '"+i.audio.deviceId.exact+"' not found"):(n=p.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,o="Audio input device doesn't support the value passed for constraint '"+t.constraint+"'"),c(new p.OpenViduError(n,o))})).catch((function(e){"deviceid"===t.constraint.toLowerCase()?(n=p.OpenViduErrorName.INPUT_VIDEO_DEVICE_NOT_FOUND,o="Video input device with deviceId '"+i.video.deviceId.exact+"' not found"):(n=p.OpenViduErrorName.PUBLISHER_PROPERTIES_ERROR,o="Video input device doesn't support the value passed for constraint '"+t.constraint+"'"),c(new p.OpenViduError(n,o))}));break;case"aborterror":case"notreadableerror":n=p.OpenViduErrorName.DEVICE_ALREADY_IN_USE,o=t.toString(),c(new p.OpenViduError(n,o));break;default:n=p.OpenViduErrorName.GENERIC_ERROR,o=t.toString(),c(new p.OpenViduError(n,o));break}};e.openvidu.generateMediaConstraints(e.properties).then((function(t){var n,c;if(t.videoTrack&&t.audioTrack||t.audioTrack&&!1===(null===(n=t.constraints)||void 0===n?void 0:n.video)||t.videoTrack&&!1===(null===(c=t.constraints)||void 0===c?void 0:c.audio))u(e.openvidu.addAlreadyProvidedTracks(t,new MediaStream,e.stream));else{i=t.constraints;var p={mediaConstraints:i,publisherProperties:e.properties};e.stream.setOutboundStreamOptions(p);var h=void 0===i.audio||i.audio;o.audio=!e.stream.isSendScreen()&&h,o.video=i.video,r=Date.now(),e.setPermissionDialogTimer(a),e.stream.isSendScreen()&&navigator.mediaDevices["getDisplayMedia"]&&!s.isElectron()?navigator.mediaDevices["getDisplayMedia"]({video:!0}).then((function(n){e.openvidu.addAlreadyProvidedTracks(t,n),d(n,h)})).catch((function(e){l(e)})):(e.stream.lastVideoTrackConstraints=o.video,navigator.mediaDevices.getUserMedia(o).then((function(n){e.openvidu.addAlreadyProvidedTracks(t,n,e.stream),d(n,h)})).catch((function(e){l(e)})))}})).catch((function(e){c(e)}))}))},t.prototype.replaceTrackAux=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){switch(i.label){case 0:n=e.enabled,"video"===e.kind?e.enabled=this.stream.videoActive:"audio"===e.kind&&(e.enabled=this.stream.audioActive),i.label=1;case 1:return i.trys.push([1,7,,8]),this.stream.isLocalStreamPublished?[4,this.replaceTrackInMediaStream(e,t)]:[3,4];case 2:return i.sent(),[4,this.replaceTrackInRtcRtpSender(e)];case 3:return[2,i.sent()];case 4:return[4,this.replaceTrackInMediaStream(e,t)];case 5:return[2,i.sent()];case 6:return[3,8];case 7:throw r=i.sent(),e.enabled=n,r;case 8:return[2]}}))}))},t.prototype.getVideoDimensions=function(){var e=this;return new Promise((function(t,n){var r,i=s.isIonicIos()||s.isIOSWithSafari(),o=function(){var n,o;if("function"===typeof e.stream.getMediaStream().getVideoTracks()[0].getSettings){var a=e.stream.getMediaStream().getVideoTracks()[0].getSettings();n=a.width||e.videoReference.videoWidth,o=a.height||e.videoReference.videoHeight}else v.warn("MediaStreamTrack does not have getSettings method on "+s.getDescription()),n=e.videoReference.videoWidth,o=e.videoReference.videoHeight;return null!=r&&e.videoReference.removeEventListener("loadedmetadata",r),i&&document.body.removeChild(e.videoReference),t({width:n,height:o})};e.videoReference.readyState>=1?o():(r=function(){if(e.videoReference.videoWidth)o();else var t=setInterval((function(){e.videoReference.videoWidth&&(clearInterval(t),o())}),40)},e.videoReference.addEventListener("loadedmetadata",r),i&&document.body.appendChild(e.videoReference))}))},t.prototype.reestablishStreamPlayingEvent=function(){this.ee.getListeners("streamPlaying").length>0&&this.addPlayEventToFirstVideo()},t.prototype.initializeVideoReference=function(e){this.videoReference=document.createElement("video"),this.videoReference.setAttribute("muted","true"),this.videoReference.style.display="none",(s.isSafariBrowser()||s.isIPhoneOrIPad()&&(s.isChromeMobileBrowser()||s.isEdgeMobileBrowser()||s.isOperaMobileBrowser()||s.isFirefoxMobileBrowser()))&&this.videoReference.setAttribute("playsinline","true"),this.stream.setMediaStream(e),this.firstVideoElement&&this.createVideoElement(this.firstVideoElement.targetElement,this.properties.insertMode),this.videoReference.srcObject=e},t.prototype.replaceTrackInMediaStream=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){return n=this.stream.displayMyRemote()?this.stream.localMediaStreamWhenSubscribedToRemote:this.stream.getMediaStream(),"video"===e.kind?(r=n.getVideoTracks()[0],t&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):r=n.getAudioTracks()[0],n.removeTrack(r),r.stop(),n.addTrack(e),"video"===e.kind&&this.stream.isLocalStreamPublished&&t&&(this.openvidu.sendNewVideoDimensionsIfRequired(this,"trackReplaced",50,30),this.session.sendVideoData(this.stream.streamManager,5,!0,5)),[2]}))}))},t.prototype.setPermissionDialogTimer=function(e){var t=this;this.permissionDialogTimeout=setTimeout((function(){t.emitEvent("accessDialogOpened",[])}),e)},t.prototype.clearPermissionDialogTimer=function(e,t){clearTimeout(this.permissionDialogTimeout),Date.now()-e>t&&this.emitEvent("accessDialogClosed",[])},t.prototype.replaceTrackInRtcRtpSender=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:if(t=this.stream.getRTCPeerConnection().getSenders(),"video"===e.kind){if(n=t.find((function(e){return!!e.track&&"video"===e.track.kind})),!n)throw new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}else{if("audio"!==e.kind)throw new Error("Unknown track kind "+e.kind);if(n=t.find((function(e){return!!e.track&&"audio"===e.track.kind})),!n)throw new Error("There's no replaceable track for that kind of MediaStreamTrack in this Publisher object")}return[4,n.replaceTrack(e)];case 1:return r.sent(),[2]}}))}))},t}(u.StreamManager);t.Publisher=g},8330:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var s,a=n(3274),c=n(6153),u=n(5251),d=n(3013),l=n(5223),p=n(146),h=n(8856),f=n(3439),m=n(3685),v=n(3590),g=n(7614),b=n(6203),E=n(9233),y=n(7009),S=n(4270),w=n(5364),O=n(5971),C=n(6455),R=n(5919),I=w.OpenViduLogger.getInstance(),k=function(e){function t(t){var n=e.call(this)||this;return n.streamManagers=[],n.remoteStreamsCreated=new Map,n.remoteConnections=new Map,s=O.PlatformUtils.getInstance(),n.openvidu=t,n}return r(t,e),t.prototype.connect=function(e,t){var n=this;return new Promise((function(r,i){if(n.processToken(e),!n.openvidu.checkSystemRequirements())return i(new y.OpenViduError(y.OpenViduErrorName.BROWSER_NOT_SUPPORTED,"Browser "+s.getName()+" (version "+s.getVersion()+") for "+s.getFamily()+" is not supported in OpenVidu"));n.options={sessionId:n.sessionId,participantId:e,metadata:t?n.stringClientMetadata(t):""},n.connectAux(e).then((function(){return r()})).catch((function(e){return i(e)}))}))},t.prototype.disconnect=function(){this.leave(!1,"disconnect")},t.prototype.subscribe=function(e,t,n,r){var i={};i=n&&"function"!==typeof n?{insertMode:"undefined"!==typeof n.insertMode?"string"===typeof n.insertMode?S.VideoInsertMode[n.insertMode]:i.insertMode:S.VideoInsertMode.APPEND,subscribeToAudio:"undefined"===typeof n.subscribeToAudio||n.subscribeToAudio,subscribeToVideo:"undefined"===typeof n.subscribeToVideo||n.subscribeToVideo}:{insertMode:S.VideoInsertMode.APPEND,subscribeToAudio:!0,subscribeToVideo:!0};var o=void 0;if(n&&"function"===typeof n?o=n:r&&(o=r),!this.sessionConnected())throw void 0!==o&&o(this.notConnectedError()),this.notConnectedError();I.info("Subscribing to "+e.connection.connectionId),e.subscribe().then((function(){I.info("Subscribed correctly to "+e.connection.connectionId),void 0!==o&&o(void 0)})).catch((function(e){void 0!==o&&o(e)}));var s=new u.Subscriber(e,t,i);return s.targetElement&&e.streamManager.createVideoElement(s.targetElement,i.insertMode),s},t.prototype.subscribeAsync=function(e,t,n){var r=this;return new Promise((function(i,o){if(!r.sessionConnected())return o(r.notConnectedError());var s,a=function(e){return e?o(e):i(s)};s=n?r.subscribe(e,t,n,a):r.subscribe(e,t,a)}))},t.prototype.unsubscribe=function(e){var t=this;return new Promise((function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());var i=e.stream.connection.connectionId;I.info("Unsubscribing from "+i),t.openvidu.sendRequest("unsubscribeFromVideo",{sender:e.stream.connection.connectionId},(function(t,o){return t?(I.error("Error unsubscribing from "+i),r(t)):(I.info("Unsubscribed correctly from "+i),e.stream.streamManager.removeAllVideos(),e.stream.disposeWebRtcPeer(),e.stream.disposeMediaStream(),n())}))}))},t.prototype.publish=function(e){var t=this;return new Promise((function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());e.session=t,e.stream.session=t,e.stream.publishedOnce?e.initialize().then((function(){t.connection.addStream(e.stream),e.reestablishStreamPlayingEvent(),e.stream.publish().then((function(){return t.sendVideoData(e,8,!0,5),n()})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)})):(t.connection.addStream(e.stream),e.stream.publish().then((function(){return t.sendVideoData(e,8,!0,5),n()})).catch((function(e){return r(e)})))}))},t.prototype.unpublish=function(e){var t=this;return new Promise((function(n,r){if(!t.sessionConnected())throw t.notConnectedError();var i=e.stream;return i.connection?i.connection!==t.connection?r(new Error("The associated Connection object of this Publisher is not your local Connection.Only moderators can force unpublish on remote Streams via 'forceUnpublish' method")):(I.info("Unpublishing local media ("+i.connection.connectionId+")"),void t.openvidu.sendRequest("unpublishVideo",(function(t,o){if(t)return r(t);I.info("Media unpublished correctly"),i.disposeWebRtcPeer(),i.connection.stream==i&&delete i.connection.stream;var s=new v.StreamEvent(!0,e,"streamDestroyed",e.stream,"unpublish");return e.emitEvent("streamDestroyed",[s]),s.callDefaultBehavior(),n()}))):r(new Error("The associated Connection object of this Publisher is null"))}))},t.prototype.forceDisconnect=function(e){var t=this;return new Promise((function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());I.info("Forcing disconnect for connection "+e.connectionId),t.openvidu.sendRequest("forceDisconnect",{connectionId:e.connectionId},(function(t,i){return t?(I.error("Error forcing disconnect for Connection "+e.connectionId,t),401===t.code?r(new y.OpenViduError(y.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force a disconnection")):r(t)):(I.info("Forcing disconnect correctly for Connection "+e.connectionId),n())}))}))},t.prototype.forceUnpublish=function(e){var t=this;return new Promise((function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());I.info("Forcing unpublish for stream "+e.streamId),t.openvidu.sendRequest("forceUnpublish",{streamId:e.streamId},(function(t,i){return t?(I.error("Error forcing unpublish for Stream "+e.streamId,t),401===t.code?r(new y.OpenViduError(y.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to force an unpublishing")):r(t)):(I.info("Forcing unpublish correctly for Stream "+e.streamId),n())}))}))},t.prototype.signal=function(e){var t=this;return new Promise((function(n,r){if(!t.sessionConnected())return r(t.notConnectedError());var i={};if(e.to&&e.to.length>0){var o=[];e.to.forEach((function(e){e.connectionId&&o.push(e.connectionId)})),i["to"]=o}else i["to"]=[];i["data"]=e.data?e.data:"";var s=e.type?e.type:"signal";s&&"signal:"!==s.substring(0,7)&&(s="signal:"+s),i["type"]=s,t.openvidu.sendRequest("sendMessage",{message:JSON.stringify(i)},(function(e,t){return e?r(e):n()}))}))},t.prototype.on=function(t,n){var r,i,o,s;return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkSpeakingEvent()})),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableHarkStoppedSpeakingEvent()})),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableHarkStoppedSpeakingEvent()),this},t.prototype.once=function(t,n){var r,i,o,s;return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by 'Session'",n),"publisherStartSpeaking"===t&&(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkSpeakingEvent()})),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.hasAudio)&&this.connection.stream.enableOnceHarkSpeakingEvent()),"publisherStopSpeaking"===t&&(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.hasAudio)&&e.stream.enableOnceHarkStoppedSpeakingEvent()})),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.hasAudio)&&this.connection.stream.enableOnceHarkStoppedSpeakingEvent()),this},t.prototype.off=function(t,n){var r,i,o,s,a=this;return e.prototype.offAux.call(this,t,n),"publisherStartSpeaking"===t&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1)||(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&(a.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,e.stream.streamManager)||e.stream.disableHarkSpeakingEvent(!1))})),(null===(i=null===(r=this.connection)||void 0===r?void 0:r.stream)||void 0===i?void 0:i.streamManager)&&(this.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkSpeakingEvent(!1)))),"publisherStopSpeaking"===t&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1)||(this.remoteConnections.forEach((function(e){var t;(null===(t=e.stream)||void 0===t?void 0:t.streamManager)&&(a.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,e.stream.streamManager)||e.stream.disableHarkStoppedSpeakingEvent(!1))})),(null===(s=null===(o=this.connection)||void 0===o?void 0:o.stream)||void 0===s?void 0:s.streamManager)&&(this.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.connection.stream.streamManager)||this.connection.stream.disableHarkStoppedSpeakingEvent(!1)))),this},t.prototype.onParticipantJoined=function(e){var t=this;this.getConnection(e.id,"").then((function(e){I.warn("Connection "+e.connectionId+" already exists in connections list")})).catch((function(n){var r=new a.Connection(t,e);t.remoteConnections.set(e.id,r),t.ee.emitEvent("connectionCreated",[new l.ConnectionEvent(!1,t,"connectionCreated",r,"")])}))},t.prototype.onParticipantLeft=function(e){var t=this;this.getRemoteConnection(e.connectionId,"onParticipantLeft").then((function(n){if(n.stream){var r=n.stream,i=new v.StreamEvent(!0,t,"streamDestroyed",r,e.reason);t.ee.emitEvent("streamDestroyed",[i]),i.callDefaultBehavior(),t.remoteStreamsCreated.delete(r.streamId)}t.remoteConnections.delete(n.connectionId),t.ee.emitEvent("connectionDestroyed",[new l.ConnectionEvent(!1,t,"connectionDestroyed",n,e.reason)])})).catch((function(e){I.error(e)}))},t.prototype.onParticipantPublished=function(e){var t,n=this,r=function(e){n.remoteConnections.set(e.connectionId,e),n.remoteStreamsCreated.get(e.stream.streamId)||n.ee.emitEvent("streamCreated",[new v.StreamEvent(!1,n,"streamCreated",e.stream,"")]),n.remoteStreamsCreated.set(e.stream.streamId,!0)};this.getRemoteConnection(e.id,"onParticipantPublished").then((function(n){t=n,e.metadata=n.data,t.remoteOptions=e,t.initRemoteStreams(e.streams),r(t)})).catch((function(i){t=new a.Connection(n,e),r(t)}))},t.prototype.onParticipantUnpublished=function(e){var t=this;e.connectionId===this.connection.connectionId?this.stopPublisherStream(e.reason):this.getRemoteConnection(e.connectionId,"onParticipantUnpublished").then((function(n){var r=new v.StreamEvent(!0,t,"streamDestroyed",n.stream,e.reason);t.ee.emitEvent("streamDestroyed",[r]),r.callDefaultBehavior();var i=n.stream.streamId;t.remoteStreamsCreated.delete(i),n.removeStream(i)})).catch((function(e){I.error(e)}))},t.prototype.onParticipantEvicted=function(e){e.connectionId===this.connection.connectionId&&this.sessionId&&!this.connection.disposed&&this.leave(!0,e.reason)},t.prototype.onNewMessage=function(e){var t=this;I.info("New signal: "+JSON.stringify(e));var n=e.type?e.type.replace(/^(signal:)/,""):void 0;e.from?this.getConnection(e.from,"Connection '"+e.from+"' unknown when 'onNewMessage'. Existing remote connections: "+JSON.stringify(this.remoteConnections.keys())+". Existing local connection: "+this.connection.connectionId).then((function(r){t.ee.emitEvent("signal",[new m.SignalEvent(t,n,e.data,r)]),e.type&&"signal"!==e.type&&t.ee.emitEvent(e.type,[new m.SignalEvent(t,n,e.data,r)])})).catch((function(e){I.error(e)})):(this.ee.emitEvent("signal",[new m.SignalEvent(this,n,e.data,void 0)]),e.type&&"signal"!==e.type&&this.ee.emitEvent(e.type,[new m.SignalEvent(this,n,e.data,void 0)]))},t.prototype.onStreamPropertyChanged=function(e){var t=this,n=function(n){if(n.stream&&n.stream.streamId===e.streamId){var r=n.stream,i=void 0;switch(e.property){case"audioActive":i=r.audioActive,e.newValue="true"===e.newValue,r.audioActive=e.newValue;break;case"videoActive":i=r.videoActive,e.newValue="true"===e.newValue,r.videoActive=e.newValue;break;case"videoDimensions":i=r.videoDimensions,e.newValue=JSON.parse(JSON.parse(e.newValue)),r.videoDimensions=e.newValue;break;case"filter":i=r.filter,e.newValue=Object.keys(e.newValue).length>0?e.newValue:void 0,void 0!==e.newValue?(r.filter=new c.Filter(e.newValue.type,e.newValue.options),r.filter.stream=r,e.newValue.lastExecMethod&&(r.filter.lastExecMethod=e.newValue.lastExecMethod)):delete r.filter,e.newValue=r.filter;break}t.ee.emitEvent("streamPropertyChanged",[new g.StreamPropertyChangedEvent(t,r,e.property,e.newValue,i,e.reason)]),r.streamManager&&r.streamManager.emitEvent("streamPropertyChanged",[new g.StreamPropertyChangedEvent(r.streamManager,r,e.property,e.newValue,i,e.reason)])}else I.error("No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event")};e.connectionId===this.connection.connectionId?n(this.connection):this.getRemoteConnection(e.connectionId,"onStreamPropertyChanged").then((function(e){n(e)})).catch((function(e){I.error(e)}))},t.prototype.onConnectionPropertyChanged=function(e){var t;switch(e.property){case"role":t=this.connection.role.slice(),this.connection.role=e.newValue,this.connection.localOptions.role=e.newValue;break;case"record":t=this.connection.record,e.newValue="true"===e.newValue,this.connection.record=e.newValue,this.connection.localOptions.record=e.newValue;break}this.ee.emitEvent("connectionPropertyChanged",[new b.ConnectionPropertyChangedEvent(this,this.connection,e.property,e.newValue,t)])},t.prototype.onNetworkQualityLevelChangedChanged=function(e){var t=this;e.connectionId===this.connection.connectionId?this.ee.emitEvent("networkQualityLevelChanged",[new E.NetworkQualityLevelChangedEvent(this,e.newValue,e.oldValue,this.connection)]):this.getConnection(e.connectionId,"Connection not found for connectionId "+e.connectionId).then((function(n){t.ee.emitEvent("networkQualityLevelChanged",[new E.NetworkQualityLevelChangedEvent(t,e.newValue,e.oldValue,n)])})).catch((function(e){I.error(e)}))},t.prototype.recvIceCandidate=function(e){var t={candidate:e.candidate,sdpMLineIndex:e.sdpMLineIndex,sdpMid:e.sdpMid},n=new RTCIceCandidate(t);this.getConnection(e.senderConnectionId,"Connection not found for connectionId "+e.senderConnectionId+" owning endpoint "+e.endpointName+". Ice candidate will be ignored: "+n).then((function(t){var r=t.stream;r.getWebRtcPeer().addIceCandidate(n).catch((function(t){I.error("Error adding candidate for "+r.streamId+" stream of endpoint "+e.endpointName+": "+t)}))})).catch((function(e){I.error(e)}))},t.prototype.onSessionClosed=function(e){I.info("Session closed: "+JSON.stringify(e));var t=e.sessionId;void 0!==t?this.ee.emitEvent("session-closed",[{session:t}]):I.warn("Session undefined on session closed",e)},t.prototype.onLostConnection=function(e){I.warn("Lost connection in Session "+this.sessionId),this.sessionId&&this.connection&&!this.connection.disposed&&this.leave(!0,e)},t.prototype.onRecoveredConnection=function(){I.info("Recovered connection in Session "+this.sessionId),this.reconnectBrokenStreams(),this.ee.emitEvent("reconnected",[])},t.prototype.onMediaError=function(e){I.error("Media error: "+JSON.stringify(e));var t=e.error;t?this.ee.emitEvent("error-media",[{error:t}]):I.warn("Received undefined media error:",e)},t.prototype.onRecordingStarted=function(e){this.ee.emitEvent("recordingStarted",[new h.RecordingEvent(this,"recordingStarted",e.id,e.name)])},t.prototype.onRecordingStopped=function(e){this.ee.emitEvent("recordingStopped",[new h.RecordingEvent(this,"recordingStopped",e.id,e.name,e.reason)])},t.prototype.onFilterEventDispatched=function(e){var t=this,n=e.connectionId;this.getConnection(n,"No connection found for connectionId "+n).then((function(n){I.info('Filter event of type "'.concat(e.eventType,'" dispatched'));var r=n.stream;if(!r||!r.filter)return I.error('Filter event of type "'.concat(e.eventType,'" dispatched for stream ').concat(r.streamId," but there is no ").concat(r?"filter":"stream"," defined"));var i=r.filter.handlers.get(e.eventType);if(!i||"function"!==typeof i){var o=Array.from(r.filter.handlers.keys());return I.error('Filter event of type "'.concat(e.eventType,'" not handled or not a function! Active filter events: ').concat(o.join(",")))}i.call(t,new p.FilterEvent(r.filter,e.eventType,e.data))}))},t.prototype.onForciblyReconnectSubscriber=function(e){var t=this;return new Promise((function(n,r){t.getRemoteConnection(e.connectionId,"onForciblyReconnectSubscriber").then((function(i){if(!i.stream||i.stream.streamId!==e.streamId){var o="No stream with streamId '"+e.streamId+"' found for connection '"+e.connectionId+"' on 'streamPropertyChanged' event";return I.error(o),r(o)}var s=i.stream;if(s.setupReconnectionEventEmitter(n,r)){if(null!=s.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"])return s.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"]=e,r("Ongoing forced subscriber reconnection");s.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"]=e;var a=function(){var e=s.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"];delete s.reconnectionEventEmitter["onForciblyReconnectSubscriberLastEvent"],t.onForciblyReconnectSubscriber(e)};return s.reconnectionEventEmitter.once("success",(function(){a()})),void s.reconnectionEventEmitter.once("error",(function(){a()}))}s.completeWebRtcPeerReceive(!0,!0,e.sdpOffer).then((function(){return s.finalResolveForSubscription(!0,n)})).catch((function(t){return s.finalRejectForSubscription(!0,"Error while forcibly reconnecting remote stream ".concat(e.streamId,": ").concat(t.toString()),r)}))})).catch((function(e){return I.error(e),r(e)}))}))},t.prototype.reconnectBrokenStreams=function(){I.info("Re-establishing media connections...");var e=!1;this.connection.stream&&this.connection.stream.streamIceConnectionStateBroken()&&(I.warn("Re-establishing Publisher "+this.connection.stream.streamId),this.connection.stream.initWebRtcPeerSend(!0),e=!0),this.remoteConnections.forEach((function(t){t.stream&&t.stream.streamIceConnectionStateBroken()&&(I.warn("Re-establishing Subscriber "+t.stream.streamId),t.stream.initWebRtcPeerReceive(!0),e=!0)})),e||I.info("There were no media streams in need of a reconnection")},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.leave=function(e,t){var n=this;if(e=!!e,I.info("Leaving Session (forced="+e+")"),this.stopVideoDataIntervals(),this.connection){if(this.connection.disposed||e?this.openvidu.closeWs():this.openvidu.sendRequest("leaveRoom",(function(e,t){e&&I.error("leaveRoom error: ".concat(JSON.stringify(e))),n.openvidu.closeWs()})),this.stopPublisherStream(t),!this.connection.disposed){var r=new f.SessionDisconnectedEvent(this,t);this.ee.emitEvent("sessionDisconnected",[r]),r.callDefaultBehavior()}}else I.warn("You were not connected to the session "+this.sessionId);I.flush()},t.prototype.initializeParams=function(e){var t={token:e||"",session:this.sessionId,platform:s.getDescription()?s.getDescription():"unknown",sdkVersion:this.openvidu.libraryVersion,metadata:this.options.metadata?this.options.metadata:"",secret:this.openvidu.getSecret(),recorder:this.openvidu.getRecorder()};return t},t.prototype.sendVideoData=function(e,t,n,r){var a,c,u=this;if(void 0===t&&(t=1),void 0===n&&(n=!1),void 0===r&&(r=1),s.isChromeBrowser()||s.isChromeMobileBrowser()||s.isOperaBrowser()||s.isOperaMobileBrowser()||s.isEdgeBrowser()||s.isEdgeMobileBrowser()||s.isElectron()||s.isSafariBrowser()&&!s.isIonicIos()||s.isAndroidBrowser()||s.isSamsungBrowser()||s.isIonicAndroid()||s.isIOSWithSafari()){var d=function(){return i(u,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:return t=e.stream.getRTCPeerConnection(),"connected"!==t.connectionState?[3,2]:[4,t.getStats()];case 1:n=i.sent(),r=[],n.forEach((function(e){"frameWidth"in e&&"frameHeight"in e&&0===r.length&&r.push(e)})),r.length>0&&this.openvidu.sendRequest("videoData",{height:r[0].frameHeight,width:r[0].frameWidth,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},(function(e,t){e&&I.error("Error sending 'videoData' event",e)})),i.label=2;case 2:return[2]}}))}))};if(n){var l=1;this.videoDataInterval=setInterval((function(){l<r?(l++,d()):clearInterval(u.videoDataInterval)}),1e3*t)}else this.videoDataTimeout=setTimeout(d,1e3*t)}else s.isFirefoxBrowser()||s.isFirefoxMobileBrowser()||s.isIonicIos()||s.isReactNative()?this.openvidu.sendRequest("videoData",{height:(null===(a=e.stream.videoDimensions)||void 0===a?void 0:a.height)||0,width:(null===(c=e.stream.videoDimensions)||void 0===c?void 0:c.width)||0,videoActive:null!=e.stream.videoActive&&e.stream.videoActive,audioActive:null!=e.stream.audioActive&&e.stream.audioActive},(function(e,t){e&&I.error("Error sending 'videoData' event",e)})):I.error("Browser "+s.getName()+" (version "+s.getVersion()+") for "+s.getFamily()+" is not supported in OpenVidu for Network Quality")},t.prototype.sessionConnected=function(){return null!=this.connection},t.prototype.notConnectedError=function(){return new y.OpenViduError(y.OpenViduErrorName.OPENVIDU_NOT_CONNECTED,"There is no connection to the session. Method 'Session.connect' must be successfully completed first")},t.prototype.anySpeechEventListenerEnabled=function(e,t,n){var r=this.ee.getListeners(e);t&&(r=r.filter((function(e){return e.once})));var i=r.length;if(i>0)return!0;var o=0;if(n){var s=n.ee.getListeners(e);t&&(s=s.filter((function(e){return e.once}))),o=s.length}return o>0},t.prototype.getTokenParams=function(e){var t=e.match(/^(wss?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);if(t){var n={protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7]},r=e.split("?"),i=decodeURI(r[1]).split("&").map((function(e){return e.split("=")})).reduce((function(e,t){var n=t[0],r=t[1];return e[n]=r,e}),{});return{sessionId:i["sessionId"],secret:i["secret"],recorder:i["recorder"],webrtcStatsInterval:i["webrtcStatsInterval"],sendBrowserLogs:i["sendBrowserLogs"],edition:i["edition"],wsUri:"wss://"+n.host+"/openvidu",httpUri:"https://"+n.host}}throw new Error('Token not valid: "'.concat(e,'"'))},t.prototype.connectAux=function(e){var t=this;return new Promise((function(n,r){t.openvidu.startWs((function(i){if(i)return r(i);var o=t.initializeParams(e);t.openvidu.sendRequest("joinRoom",o,(function(i,o){if(i)return r(i);t.processJoinRoomResponse(o,e),t.connection=new a.Connection(t,o);var s={connections:new Array,streams:new Array},c=o.value;return c.forEach((function(e){var n=new a.Connection(t,e);t.remoteConnections.set(n.connectionId,n),s.connections.push(n),n.stream&&(t.remoteStreamsCreated.set(n.stream.streamId,!0),s.streams.push(n.stream))})),t.ee.emitEvent("connectionCreated",[new l.ConnectionEvent(!1,t,"connectionCreated",t.connection,"")]),s.connections.forEach((function(e){t.ee.emitEvent("connectionCreated",[new l.ConnectionEvent(!1,t,"connectionCreated",e,"")])})),s.streams.forEach((function(e){t.ee.emitEvent("streamCreated",[new v.StreamEvent(!1,t,"streamCreated",e,"")])})),n()}))}))}))},t.prototype.stopPublisherStream=function(e){this.connection.stream&&(this.connection.stream.disposeWebRtcPeer(),this.connection.stream.isLocalStreamPublished&&this.connection.stream.ee.emitEvent("local-stream-destroyed",[e]))},t.prototype.stopVideoDataIntervals=function(){clearInterval(this.videoDataInterval),clearTimeout(this.videoDataTimeout)},t.prototype.stringClientMetadata=function(e){return"string"!==typeof e?JSON.stringify(e):e},t.prototype.getConnection=function(e,t){var n=this;return new Promise((function(r,i){var o=n.remoteConnections.get(e);return o?r(o):n.connection.connectionId===e?r(n.connection):i(new y.OpenViduError(y.OpenViduErrorName.GENERIC_ERROR,t))}))},t.prototype.getRemoteConnection=function(e,t){var n=this;return new Promise((function(r,i){var o=n.remoteConnections.get(e);if(o)return r(o);var s="Remote connection "+e+" unknown when '"+t+"'. Existing remote connections: "+JSON.stringify(n.remoteConnections.keys());return i(new y.OpenViduError(y.OpenViduErrorName.GENERIC_ERROR,s))}))},t.prototype.processToken=function(e){var t=this.getTokenParams(e);this.sessionId=t.sessionId,t.secret&&(this.openvidu.secret=t.secret),t.recorder&&(this.openvidu.recorder=!0),t.webrtcStatsInterval&&(this.openvidu.webrtcStatsInterval=t.webrtcStatsInterval),t.sendBrowserLogs&&(this.openvidu.sendBrowserLogs=t.sendBrowserLogs),this.openvidu.isAtLeastPro="pro"===t.edition||"enterprise"===t.edition,this.openvidu.isEnterprise="enterprise"===t.edition,this.openvidu.wsUri=t.wsUri,this.openvidu.httpUri=t.httpUri},t.prototype.processJoinRoomResponse=function(e,t){if(this.sessionId=e.session,null!=e.customIceServers&&e.customIceServers.length>0){this.openvidu.iceServers=[];for(var n=0,r=e.customIceServers;n<r.length;n++){var i=r[n],o={urls:[i.url]};I.log("STUN/TURN server IP: "+i.url),null!=i.username&&null!=i.credential&&(o.username=i.username,o.credential=i.credential,I.log("TURN credentials ["+i.username+":"+i.credential+"]")),this.openvidu.iceServers.push(o)}}else if(null!=e.coturnIp&&null!=e.coturnPort&&null!=e.turnUsername&&null!=e.turnCredential){var s="turn:"+e.coturnIp+":"+e.coturnPort;this.openvidu.iceServers=[{urls:[s],username:e.turnUsername,credential:e.turnCredential}],I.log("STUN/TURN server IP: "+e.coturnIp),I.log("TURN temp credentials ["+e.turnUsername+":"+e.turnCredential+"]")}this.openvidu.role=e.role,this.openvidu.finalUserId=e.finalUserId,this.openvidu.mediaServer=e.mediaServer,this.openvidu.videoSimulcast=e.videoSimulcast,this.capabilities={subscribe:!0,publish:"SUBSCRIBER"!==this.openvidu.role,forceUnpublish:"MODERATOR"===this.openvidu.role,forceDisconnect:"MODERATOR"===this.openvidu.role},I.info("openvidu-server version: "+e.version),null!=e.life&&(this.openvidu.life=e.life);var a=R(e.version)-R(this.openvidu.libraryVersion);C(e.version)!==C(this.openvidu.libraryVersion)||0!=a&&1!=a?I.error("openvidu-browser (".concat(this.openvidu.libraryVersion,") and openvidu-server (").concat(e.version,") versions are incompatible. ")+"Errors are likely to occur. openvidu-browser SDK is only compatible with the same version or the immediately following minor version of an OpenVidu deployment"):1==a&&I.warn("openvidu-browser version ".concat(this.openvidu.libraryVersion," does not match openvidu-server version ").concat(e.version,". ")+"These versions are still compatible with each other, but openvidu-browser version must be updated as soon as possible to ".concat(C(e.version),".").concat(R(e.version),".x. ")+"This client using openvidu-browser ".concat(this.openvidu.libraryVersion," will become incompatible with the next release of openvidu-server")),w.OpenViduLogger.configureJSNLog(this.openvidu,t),this.token=t},t}(d.EventDispatcher);t.Session=k},7686:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Stream=void 0;var o,s=n(6153),a=n(5251),c=n(734),u=n(7137),d=n(6056),l=n(8271),p=n(3977),h=n(7614),f=n(7009),m=n(1513),v=n(5364),g=n(5971),b=n(812),E=n(8233),y=n(4795),S=v.OpenViduLogger.getInstance(),w=function(){function e(e,t){var n=this;this.isSubscribeToRemote=!1,this.isLocalStreamReadyToPublish=!1,this.isLocalStreamPublished=!1,this.publishedOnce=!1,this.harkSpeakingEnabled=!1,this.harkSpeakingEnabledOnce=!1,this.harkStoppedSpeakingEnabled=!1,this.harkStoppedSpeakingEnabledOnce=!1,this.harkVolumeChangeEnabled=!1,this.harkVolumeChangeEnabledOnce=!1,this.ee=new y,o=g.PlatformUtils.getInstance(),this.session=e,t.hasOwnProperty("id")?(this.inboundStreamOpts=t,this.streamId=this.inboundStreamOpts.id,this.creationTime=this.inboundStreamOpts.createdAt,this.hasAudio=this.inboundStreamOpts.hasAudio,this.hasVideo=this.inboundStreamOpts.hasVideo,this.hasAudio&&(this.audioActive=this.inboundStreamOpts.audioActive),this.hasVideo&&(this.videoActive=this.inboundStreamOpts.videoActive,this.typeOfVideo=this.inboundStreamOpts.typeOfVideo?this.inboundStreamOpts.typeOfVideo:void 0,this.frameRate=-1===this.inboundStreamOpts.frameRate?void 0:this.inboundStreamOpts.frameRate,this.videoDimensions=this.inboundStreamOpts.videoDimensions),this.inboundStreamOpts.filter&&Object.keys(this.inboundStreamOpts.filter).length>0&&(this.inboundStreamOpts.filter.lastExecMethod&&0===Object.keys(this.inboundStreamOpts.filter.lastExecMethod).length&&delete this.inboundStreamOpts.filter.lastExecMethod,this.filter=this.inboundStreamOpts.filter)):(this.outboundStreamOpts=t,this.hasAudio=this.isSendAudio(),this.hasVideo=this.isSendVideo(),this.hasAudio&&(this.audioActive=!!this.outboundStreamOpts.publisherProperties.publishAudio),this.hasVideo&&(this.videoActive=!!this.outboundStreamOpts.publisherProperties.publishVideo,this.frameRate=this.outboundStreamOpts.publisherProperties.frameRate,"undefined"!==typeof MediaStreamTrack&&this.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?this.typeOfVideo=m.TypeOfVideo.CUSTOM:this.typeOfVideo=this.isSendScreen()?m.TypeOfVideo.SCREEN:m.TypeOfVideo.CAMERA),this.outboundStreamOpts.publisherProperties.filter&&(this.filter=this.outboundStreamOpts.publisherProperties.filter)),this.ee.on("mediastream-updated",(function(){var e;n.streamManager.updateMediaStream(n.mediaStream),S.debug("Video srcObject ["+(null===(e=n.mediaStream)||void 0===e?void 0:e.id)+"] updated in stream ["+n.streamId+"]")}))}return e.prototype.reconnect=function(){return this.reconnectStream("API")},e.prototype.applyFilter=function(e,t){var n=this;return new Promise((function(o,a){return r(n,void 0,void 0,(function(){var n,c,u,d,l,p,m=this;return i(this,(function(v){if(this.filter)return[2,a(new f.OpenViduError(f.OpenViduErrorName.GENERIC_ERROR,"There is already a filter applied to Stream "+this.streamId))];if(n=function(n,r){if(n)return S.error("Error applying filter for Stream "+m.streamId,n),401===n.code?a(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to apply a filter")):a(n);S.info("Filter successfully applied on Stream "+m.streamId);var i=m.filter;return m.filter=new s.Filter(e,t),m.filter.stream=m,r&&(m.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(m.session,m,"filter",m.filter,i,"applyFilter")]),m.streamManager.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(m.streamManager,m,"filter",m.filter,i,"applyFilter")])),o(m.filter)},e.startsWith("VB:")){if(!this.hasVideo)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The Virtual Background filter requires a video track to be applied"))];if(!this.mediaStream||0===this.streamManager.videos.length)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"The StreamManager requires some video element to be attached to it in order to apply a Virtual Background filter"))];if(c=this.session.token?this.session.token:t["token"],!c)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,'Virtual Background requires the client to be connected to a Session or to have a "token" property available in "options" parameter with a valid OpenVidu token'))];if(u=this.session.getTokenParams(c),"pro"!==u.edition&&"enterprise"!==u.edition)return[2,a(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,"OpenVidu Virtual Background API is available from OpenVidu Pro edition onwards"))];c=encodeURIComponent(btoa(c)),S.info("Applying Virtual Background to stream "+this.streamId),d=function(){return r(m,void 0,void 0,(function(){var r,o,s,a,d,l,p;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,8,,9]),r=this.streamId+"_"+(0,b.v4)(),o=this.mediaStream.clone(),s=this.streamManager.videos[0].video.cloneNode(!1),s.id=VirtualBackground.VirtualBackground.SOURCE_VIDEO_PREFIX+r,s.srcObject=o,s.muted=!0,this.virtualBackgroundSourceElements={videoClone:s,mediaStreamClone:o},VirtualBackground.VirtualBackground.hideHtmlElement(s,!1),VirtualBackground.VirtualBackground.appendHtmlElementToHiddenContainer(s,r),[4,s.play()];case 1:switch(i.sent(),a=new VirtualBackground.VirtualBackground({id:r,openviduServerUrl:new URL(u.httpUri),openviduToken:c,inputVideo:s,inputResolution:"160x96",outputFramerate:24}),d=void 0,l=e,l){case"VB:blur":return[3,2];case"VB:image":return[3,4]}return[3,6];case 2:return[4,a.backgroundBlur(t)];case 3:return d=i.sent(),[3,7];case 4:return[4,a.backgroundImage(t)];case 5:return d=i.sent(),[3,7];case 6:throw new Error("Unknown Virtual Background filter: "+e);case 7:return this.virtualBackgroundSinkElements={VB:a,video:d},s.style.display="none",this.streamManager.remote?this.streamManager.replaceTrackInMediaStream(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1):this.streamManager.replaceTrackAux(this.virtualBackgroundSinkElements.video.srcObject.getVideoTracks()[0],!1),n(void 0,!1),[3,9];case 8:return p=i.sent(),p.name===f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR?n(new f.OpenViduError(f.OpenViduErrorName.VIRTUAL_BACKGROUND_ERROR,p.message),!1):n(p,!1),[3,9];case 9:return[2]}}))}))},"undefined"===typeof VirtualBackground?(l=document.createElement("script"),l.type="text/javascript",l.src=u.httpUri+"/openvidu/virtual-background/openvidu-virtual-background.js?token="+c,l.onload=function(){return r(m,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,d()];case 1:return r.sent(),o(new s.Filter(e,t)),[3,3];case 2:return n=r.sent(),a(n),[3,3];case 3:return[2]}}))}))},document.body.appendChild(l)):d().then((function(){return o(new s.Filter(e,t))})).catch((function(e){return a(e)}))}else{if(!this.session.sessionConnected())return[2,a(this.session.notConnectedError())];S.info("Applying server filter to stream "+this.streamId),t=null!=t?t:{},p=t,"string"!==typeof p&&(p=JSON.stringify(p)),this.session.openvidu.sendRequest("applyFilter",{streamId:this.streamId,type:e,options:p},(function(e,t){n(e,!0)}))}return[2]}))}))}))},e.prototype.removeFilter=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.removeFilterAux(!1)];case 1:return[2,e.sent()]}}))}))},e.prototype.getRTCPeerConnection=function(){return this.webRtcPeer.pc},e.prototype.getMediaStream=function(){return this.mediaStream},e.prototype.removeFilterAux=function(e){var t=this;return new Promise((function(n,o){return r(t,void 0,void 0,(function(){var t,r,s,a,c=this;return i(this,(function(i){switch(i.label){case 0:if(t=function(e,t){if(e)return delete c.filter,S.error("Error removing filter for Stream "+c.streamId,e),401===e.code?o(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to remove a filter")):o(e);S.info("Filter successfully removed from Stream "+c.streamId);var r=c.filter;return delete c.filter,t&&(c.session.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(c.session,c,"filter",c.filter,r,"applyFilter")]),c.streamManager.emitEvent("streamPropertyChanged",[new h.StreamPropertyChangedEvent(c.streamManager,c,"filter",c.filter,r,"applyFilter")])),n()},!this.filter)return[3,12];if(!(null===(a=this.filter)||void 0===a?void 0:a.type.startsWith("VB:")))return[3,10];i.label=1;case 1:return i.trys.push([1,8,,9]),r=this.virtualBackgroundSourceElements.mediaStreamClone,e?[3,6]:this.streamManager.remote?[4,this.streamManager.replaceTrackInMediaStream(r.getVideoTracks()[0],!1)]:[3,3];case 2:return i.sent(),[3,5];case 3:return[4,this.streamManager.replaceTrackAux(r.getVideoTracks()[0],!1)];case 4:i.sent(),i.label=5;case 5:return[3,7];case 6:r.getTracks().forEach((function(e){return e.stop()})),i.label=7;case 7:return this.virtualBackgroundSinkElements.VB.cleanUp(),delete this.virtualBackgroundSinkElements,delete this.virtualBackgroundSourceElements,[2,t(void 0,!1)];case 8:return s=i.sent(),[2,t(s,!1)];case 9:return[3,11];case 10:if(!this.session.sessionConnected())return[2,o(this.session.notConnectedError())];S.info("Removing filter of stream "+this.streamId),this.session.openvidu.sendRequest("removeFilter",{streamId:this.streamId},(function(e,n){return t(e,!0)})),i.label=11;case 11:return[3,13];case 12:return[2,o(new f.OpenViduError(f.OpenViduErrorName.GENERIC_ERROR,"Stream "+this.streamId+" has no filter applied"))];case 13:return[2]}}))}))}))},e.prototype.setMediaStream=function(e){this.mediaStream=e},e.prototype.updateMediaStreamInVideos=function(){this.ee.emitEvent("mediastream-updated",[])},e.prototype.getWebRtcPeer=function(){return this.webRtcPeer},e.prototype.subscribeToMyRemote=function(e){this.isSubscribeToRemote=e},e.prototype.setOutboundStreamOptions=function(e){this.outboundStreamOpts=e},e.prototype.subscribe=function(){var e=this;return new Promise((function(t,n){e.initWebRtcPeerReceive(!1).then((function(){return t()})).catch((function(e){return n(e)}))}))},e.prototype.publish=function(){var e=this;return new Promise((function(t,n){e.isLocalStreamReadyToPublish?e.initWebRtcPeerSend(!1).then((function(){return t()})).catch((function(e){return n(e)})):e.ee.once("stream-ready-to-publish",(function(){e.publish().then((function(){return t()})).catch((function(e){return n(e)}))}))}))},e.prototype.disposeWebRtcPeer=function(){var e;this.webRtcPeer&&(this.webRtcPeer.dispose(),e=this.webRtcPeer.getId()),this.stopWebRtcStats(),S.info((this.outboundStreamOpts?"Outbound ":"Inbound ")+"RTCPeerConnection with id ["+e+"] from 'Stream' with id ["+this.streamId+"] is now closed")},e.prototype.disposeMediaStream=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:if(!this.filter||!this.filter.type.startsWith("VB:"))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.removeFilterAux(!0)];case 2:return t.sent(),console.debug("Success removing Virtual Background filter for stream ".concat(this.streamId)),[3,4];case 3:return e=t.sent(),console.error("Error removing Virtual Background filter for stream ".concat(this.streamId),e),[3,4];case 4:return this.mediaStream&&(this.mediaStream.getAudioTracks().forEach((function(e){e.stop()})),this.mediaStream.getVideoTracks().forEach((function(e){e.stop()})),delete this.mediaStream),this.localMediaStreamWhenSubscribedToRemote&&(this.localMediaStreamWhenSubscribedToRemote.getAudioTracks().forEach((function(e){e.stop()})),this.localMediaStreamWhenSubscribedToRemote.getVideoTracks().forEach((function(e){e.stop()})),delete this.localMediaStreamWhenSubscribedToRemote),this.speechEvent&&(this.speechEvent.stop&&this.speechEvent.stop(),delete this.speechEvent),S.info((this.outboundStreamOpts?"Local ":"Remote ")+"MediaStream from 'Stream' with id ["+this.streamId+"] is now disposed"),[2]}}))}))},e.prototype.displayMyRemote=function(){return this.isSubscribeToRemote},e.prototype.isSendAudio=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.audioSource&&!1!==this.outboundStreamOpts.publisherProperties.audioSource},e.prototype.isSendVideo=function(){return!!this.outboundStreamOpts&&null!==this.outboundStreamOpts.publisherProperties.videoSource&&!1!==this.outboundStreamOpts.publisherProperties.videoSource},e.prototype.isSendScreen=function(){var e="screen"===this.outboundStreamOpts.publisherProperties.videoSource;return o.isElectron()&&(e="string"===typeof this.outboundStreamOpts.publisherProperties.videoSource&&this.outboundStreamOpts.publisherProperties.videoSource.startsWith("screen:")),!!this.outboundStreamOpts&&e},e.prototype.enableHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabled&&this.speechEvent&&(this.harkSpeakingEnabled=!0,this.speechEvent.on("speaking",(function(){e.session.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)]),e.harkSpeakingEnabledOnce=!1})))},e.prototype.enableOnceHarkSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkSpeakingEnabledOnce&&this.speechEvent&&(this.harkSpeakingEnabledOnce=!0,this.speechEvent.once("speaking",(function(){e.harkSpeakingEnabledOnce&&(e.session.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStartSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStartSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStartSpeaking",e.connection,e.streamId)])),e.disableHarkSpeakingEvent(!0)})))},e.prototype.disableHarkSpeakingEvent=function(e){if(this.speechEvent){if(this.harkSpeakingEnabledOnce=!1,e){if(this.harkSpeakingEnabled)return}else this.harkSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabled&&this.speechEvent&&(this.harkStoppedSpeakingEnabled=!0,this.speechEvent.on("stopped_speaking",(function(){e.session.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)]),e.harkStoppedSpeakingEnabledOnce=!1})))},e.prototype.enableOnceHarkStoppedSpeakingEvent=function(){var e=this;this.setHarkListenerIfNotExists(),!this.harkStoppedSpeakingEnabledOnce&&this.speechEvent&&(this.harkStoppedSpeakingEnabledOnce=!0,this.speechEvent.once("stopped_speaking",(function(){e.harkStoppedSpeakingEnabledOnce&&(e.session.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.session,"publisherStopSpeaking",e.connection,e.streamId)]),e.streamManager.emitEvent("publisherStopSpeaking",[new l.PublisherSpeakingEvent(e.streamManager,"publisherStopSpeaking",e.connection,e.streamId)])),e.disableHarkStoppedSpeakingEvent(!0)})))},e.prototype.disableHarkStoppedSpeakingEvent=function(e){if(this.speechEvent){if(this.harkStoppedSpeakingEnabledOnce=!1,e){if(this.harkStoppedSpeakingEnabled)return}else this.harkStoppedSpeakingEnabled=!1;this.harkVolumeChangeEnabled||this.harkVolumeChangeEnabledOnce||this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce?this.speechEvent.off("stopped_speaking"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.enableHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?this.harkVolumeChangeEnabled&&!e||(this.harkVolumeChangeEnabled=!0,this.speechEvent.on("volume_change",(function(e){var n=t.speechEvent.oldVolumeValue,r={newValue:e,oldValue:n};t.speechEvent.oldVolumeValue=e,t.streamManager.emitEvent("streamAudioVolumeChange",[new p.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",r)])}))):this.harkVolumeChangeEnabled=!0},e.prototype.enableOnceHarkVolumeChangeEvent=function(e){var t=this;this.setHarkListenerIfNotExists()?this.harkVolumeChangeEnabledOnce&&!e||(this.harkVolumeChangeEnabledOnce=!0,this.speechEvent.once("volume_change",(function(e){var n=t.speechEvent.oldVolumeValue,r={newValue:e,oldValue:n};t.speechEvent.oldVolumeValue=e,t.disableHarkVolumeChangeEvent(!0),t.streamManager.emitEvent("streamAudioVolumeChange",[new p.StreamManagerEvent(t.streamManager,"streamAudioVolumeChange",r)])}))):this.harkVolumeChangeEnabledOnce=!0},e.prototype.disableHarkVolumeChangeEvent=function(e){if(this.speechEvent){if(this.harkVolumeChangeEnabledOnce=!1,e){if(this.harkVolumeChangeEnabled)return}else this.harkVolumeChangeEnabled=!1;this.harkSpeakingEnabled||this.harkSpeakingEnabledOnce||this.harkStoppedSpeakingEnabled||this.harkStoppedSpeakingEnabledOnce?this.speechEvent.off("volume_change"):(this.speechEvent.stop(),delete this.speechEvent)}},e.prototype.isLocal=function(){return!this.inboundStreamOpts&&!!this.outboundStreamOpts},e.prototype.getSelectedIceCandidate=function(){var e=this;return new Promise((function(t,n){e.webRtcStats.getSelectedIceCandidateInfo().then((function(e){return t(e)})).catch((function(e){return n(e)}))}))},e.prototype.getRemoteIceCandidateList=function(){return this.webRtcPeer.remoteCandidatesQueue},e.prototype.getLocalIceCandidateList=function(){return this.webRtcPeer.localCandidatesQueue},e.prototype.streamIceConnectionStateBroken=function(){if(!this.getWebRtcPeer()||!this.getRTCPeerConnection())return!1;if(this.isLocal()&&this.session.openvidu.advancedConfiguration.forceMediaReconnectionAfterNetworkDrop)return S.warn('OpenVidu Browser advanced configuration option "forceMediaReconnectionAfterNetworkDrop" is enabled. Stream '.concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") will force a reconnection")),!0;var e=this.getRTCPeerConnection().iceConnectionState;return"connected"!==e&&"completed"!==e},e.prototype.setHarkListenerIfNotExists=function(){if(this.mediaStream){if(!this.speechEvent){var e=this.harkOptions?this.harkOptions:this.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{};e.interval="number"===typeof e.interval?e.interval:100,e.threshold="number"===typeof e.threshold?e.threshold:-50,this.speechEvent=E(this.mediaStream,e)}return!0}return!1},e.prototype.setupReconnectionEventEmitter=function(e,t){return void 0==this.reconnectionEventEmitter?(this.reconnectionEventEmitter=new y,!1):(console.warn("Trying to reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but an ongoing reconnection process is active. Waiting for response...")),this.reconnectionEventEmitter.once("success",(function(){return e()})),this.reconnectionEventEmitter.once("error",(function(e){return t(e)})),!0)},e.prototype.initWebRtcPeerSend=function(e){var t=this;return new Promise((function(n,r){var i;if(e){if(t.setupReconnectionEventEmitter(n,r))return}else t.initHarkEvents();var o=function(){var r;return e&&(null===(r=t.reconnectionEventEmitter)||void 0===r||r.emitEvent("success"),delete t.reconnectionEventEmitter),n()},s=function(n){var i;return e&&(null===(i=t.reconnectionEventEmitter)||void 0===i||i.emitEvent("error",[n]),delete t.reconnectionEventEmitter),r(n)},a=function(n){S.debug("Sending SDP offer to publish as "+t.streamId,n);var r,i=e?"reconnectStream":"publishVideo";if(e)r={stream:t.streamId,sdpString:n};else{var a=void 0;t.isSendVideo()&&(a="undefined"!==typeof MediaStreamTrack&&t.outboundStreamOpts.publisherProperties.videoSource instanceof MediaStreamTrack?m.TypeOfVideo.CUSTOM:t.isSendScreen()?m.TypeOfVideo.SCREEN:m.TypeOfVideo.CAMERA),r={doLoopback:t.displayMyRemote()||!1,hasAudio:t.isSendAudio(),hasVideo:t.isSendVideo(),audioActive:t.audioActive,videoActive:t.videoActive,typeOfVideo:a,frameRate:t.frameRate?t.frameRate:-1,videoDimensions:JSON.stringify(t.videoDimensions),filter:t.outboundStreamOpts.publisherProperties.filter,sdpOffer:n}}t.session.openvidu.sendRequest(i,r,(function(n,r){n?401===n.code?s(new f.OpenViduError(f.OpenViduErrorName.OPENVIDU_PERMISSION_DENIED,"You don't have permissions to publish")):s("Error on publishVideo: "+JSON.stringify(n)):t.webRtcPeer.processRemoteAnswer(r.sdpAnswer).then((function(){t.streamId=r.id,t.creationTime=r.createdAt,t.isLocalStreamPublished=!0,t.publishedOnce=!0,t.displayMyRemote()&&(t.localMediaStreamWhenSubscribedToRemote=t.mediaStream,t.remotePeerSuccessfullyEstablished(e)),e?t.ee.emitEvent("stream-reconnected-by-publisher",[]):t.ee.emitEvent("stream-created-by-publisher",[]),t.initWebRtcStats(),S.info("'Publisher' ("+t.streamId+") successfully "+(e?"reconnected":"published")+" to session"),o()})).catch((function(e){s(e)}))}))},u={mediaConstraints:{audio:t.hasAudio,video:t.hasVideo},simulcast:null!==(i=t.outboundStreamOpts.publisherProperties.videoSimulcast)&&void 0!==i?i:t.session.openvidu.videoSimulcast,onIceCandidate:t.connection.sendIceCandidate.bind(t.connection),onIceConnectionStateException:function(e,n,r){t.session.emitEvent("exception",[new d.ExceptionEvent(t.session,e,t,n,r)])},iceServers:t.getIceServersConf(),mediaStream:t.mediaStream,mediaServer:t.session.openvidu.mediaServer,typeOfVideo:t.typeOfVideo?m.TypeOfVideo[t.typeOfVideo]:void 0};"mediasoup"!==t.session.openvidu.mediaServer&&(u.simulcast=!1),e&&t.disposeWebRtcPeer(),t.displayMyRemote()?t.webRtcPeer=new c.WebRtcPeerSendrecv(u):t.webRtcPeer=new c.WebRtcPeerSendonly(u),t.webRtcPeer.addIceConnectionStateChangeListener("publisher of "+t.connection.connectionId),t.webRtcPeer.createOffer().then((function(e){t.webRtcPeer.processLocalOffer(e).then((function(){a(e.sdp)})).catch((function(e){s(new Error("(publish) SDP process local offer error: "+JSON.stringify(e)))}))})).catch((function(e){s(new Error("(publish) SDP create offer error: "+JSON.stringify(e)))}))}))},e.prototype.finalResolveForSubscription=function(e,t){var n;return S.info("'Subscriber' ("+this.streamId+") successfully "+(e?"reconnected":"subscribed")),this.remotePeerSuccessfullyEstablished(e),this.initWebRtcStats(),e&&(null===(n=this.reconnectionEventEmitter)||void 0===n||n.emitEvent("success"),delete this.reconnectionEventEmitter),t()},e.prototype.finalRejectForSubscription=function(e,t,n){var r;return S.error("Error for 'Subscriber' ("+this.streamId+") while trying to "+(e?"reconnect":"subscribe")+": "+t.toString()),e&&(null===(r=this.reconnectionEventEmitter)||void 0===r||r.emitEvent("error",[t]),delete this.reconnectionEventEmitter),n(t)},e.prototype.initWebRtcPeerReceive=function(e){var t=this;return new Promise((function(n,r){e&&t.setupReconnectionEventEmitter(n,r)||("mediasoup"===t.session.openvidu.mediaServer?t.initWebRtcPeerReceiveFromServer(e).then((function(){return t.finalResolveForSubscription(e,n)})).catch((function(n){return t.finalRejectForSubscription(e,n,r)})):t.initWebRtcPeerReceiveFromClient(e).then((function(){return t.finalResolveForSubscription(e,n)})).catch((function(n){return t.finalRejectForSubscription(e,n,r)})))}))},e.prototype.initWebRtcPeerReceiveFromClient=function(e){var t=this;return new Promise((function(n,r){t.completeWebRtcPeerReceive(e,!1).then((function(e){t.webRtcPeer.processRemoteAnswer(e.sdpAnswer).then((function(){return n()})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)}))}))},e.prototype.initWebRtcPeerReceiveFromServer=function(e){var t=this;return new Promise((function(n,r){t.session.openvidu.sendRequest("prepareReceiveVideoFrom",{sender:t.streamId,reconnect:e},(function(i,o){if(i)return r(new Error("Error on prepareReceiveVideoFrom: "+JSON.stringify(i)));t.completeWebRtcPeerReceive(e,!1,o.sdpOffer).then((function(){return n()})).catch((function(e){return r(e)}))}))}))},e.prototype.completeWebRtcPeerReceive=function(e,t,n){var r=this;return new Promise((function(i,o){S.debug("'Session.subscribe(Stream)' called");var s=function(s){S.debug("Sending local SDP ".concat(n?"answer":"offer"," to subscribe to ").concat(r.streamId),s);var a=e?"reconnectStream":"receiveVideoFrom",c={};c[e?"stream":"sender"]=r.streamId,n?c[e?"sdpString":"sdpAnswer"]=s:c["sdpOffer"]=s,e&&(c["forciblyReconnect"]=t),r.session.openvidu.sendRequest(a,c,(function(e,t){return e?o(new Error("Error on "+a+" : "+JSON.stringify(e))):i(t)}))},a={mediaConstraints:{audio:r.hasAudio,video:r.hasVideo},simulcast:!1,onIceCandidate:r.connection.sendIceCandidate.bind(r.connection),onIceConnectionStateException:function(e,t,n){r.session.emitEvent("exception",[new d.ExceptionEvent(r.session,e,r,t,n)])},iceServers:r.getIceServersConf(),mediaServer:r.session.openvidu.mediaServer,typeOfVideo:r.typeOfVideo?m.TypeOfVideo[r.typeOfVideo]:void 0};e&&r.disposeWebRtcPeer(),r.webRtcPeer=new c.WebRtcPeerRecvonly(a),r.webRtcPeer.addIceConnectionStateChangeListener(r.streamId),n?r.webRtcPeer.processRemoteOffer(n).then((function(){r.webRtcPeer.createAnswer().then((function(e){r.webRtcPeer.processLocalAnswer(e).then((function(){s(e.sdp)})).catch((function(e){return o(new Error("(subscribe) SDP process local answer error: "+JSON.stringify(e)))}))})).catch((function(e){return o(new Error("(subscribe) SDP create answer error: "+JSON.stringify(e)))}))})).catch((function(e){return o(new Error("(subscribe) SDP process remote offer error: "+JSON.stringify(e)))})):r.webRtcPeer.createOffer().then((function(e){r.webRtcPeer.processLocalOffer(e).then((function(){s(e.sdp)})).catch((function(e){return o(new Error("(subscribe) SDP process local offer error: "+JSON.stringify(e)))}))})).catch((function(e){return o(new Error("(subscribe) SDP create offer error: "+JSON.stringify(e)))}))}))},e.prototype.remotePeerSuccessfullyEstablished=function(e){var t;e&&null!=this.mediaStream&&this.disposeMediaStream(),this.mediaStream=new MediaStream;for(var n=0,r=this.webRtcPeer.pc.getReceivers();n<r.length;n++)t=r[n],t.track&&this.mediaStream.addTrack(t.track);if(S.debug("Peer remote stream",this.mediaStream),this.mediaStream){if(this.streamManager instanceof a.Subscriber){if(this.mediaStream.getAudioTracks()[0]){var i=e?this.audioActive:!!this.streamManager.properties.subscribeToAudio;this.mediaStream.getAudioTracks()[0].enabled=i}if(this.mediaStream.getVideoTracks()[0]){i=e?this.videoActive:!!this.streamManager.properties.subscribeToVideo;this.mediaStream.getVideoTracks()[0].enabled=i}}this.updateMediaStreamInVideos(),this.initHarkEvents()}},e.prototype.initHarkEvents=function(){this.mediaStream.getAudioTracks()[0]&&(this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!0,this.streamManager)&&this.enableOnceHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStartSpeaking",!1,this.streamManager)&&this.enableHarkSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!0,this.streamManager)&&this.enableOnceHarkStoppedSpeakingEvent(),this.session.anySpeechEventListenerEnabled("publisherStopSpeaking",!1,this.streamManager)&&this.enableHarkStoppedSpeakingEvent(),this.harkVolumeChangeEnabledOnce&&this.enableOnceHarkVolumeChangeEvent(!0),this.harkVolumeChangeEnabled&&this.enableHarkVolumeChangeEvent(!0))},e.prototype.onIceConnectionStateExceptionHandler=function(e,t,n){switch(e){case d.ExceptionEventName.ICE_CONNECTION_FAILED:this.onIceConnectionFailed();break;case d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED:this.onIceConnectionDisconnected();break}this.session.emitEvent("exception",[new d.ExceptionEvent(this.session,e,this,t,n)])},e.prototype.onIceConnectionFailed=function(){S.log("[ICE_CONNECTION_FAILED] Handling ICE_CONNECTION_FAILED event. Reconnecting stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",")")),this.reconnectStreamAndLogResultingIceConnectionState(d.ExceptionEventName.ICE_CONNECTION_FAILED)},e.prototype.onIceConnectionDisconnected=function(){var e=this;S.log("[ICE_CONNECTION_DISCONNECTED] Handling ICE_CONNECTION_DISCONNECTED event. Waiting for ICE to be restored and reconnect stream ".concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") if not possible"));var t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3;this.awaitWebRtcPeerConnectionState(t).then((function(n){switch(n){case"failed":S.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") is now failed after ICE_CONNECTION_DISCONNECTED"));break;case"connected":case"completed":S.log("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") automatically restored after ICE_CONNECTION_DISCONNECTED. Current ICE connection state: ").concat(n));break;case"closed":case"checking":case"new":case"disconnected":S.warn("[ICE_CONNECTION_DISCONNECTED] ICE connection of stream ".concat(e.streamId," (").concat(e.isLocal()?"Publisher":"Subscriber",") couldn't be restored after ICE_CONNECTION_DISCONNECTED event. Current ICE connection state after ").concat(t," ms: ").concat(n)),e.reconnectStreamAndLogResultingIceConnectionState(d.ExceptionEventName.ICE_CONNECTION_DISCONNECTED);break}}))},e.prototype.reconnectStreamAndLogResultingIceConnectionState=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.reconnectStreamAndReturnIceConnectionState(e)];case 1:switch(t=r.sent(),t){case"connected":case"completed":S.log("[".concat(e,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") successfully reconnected after ").concat(e,". Current ICE connection state: ").concat(t));break;default:S.error("[".concat(e,"] Stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") failed to reconnect after ").concat(e,". Current ICE connection state: ").concat(t));break}return[3,3];case 2:return n=r.sent(),S.error("[".concat(e,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after ").concat(e,": ").concat(n)),[3,3];case 3:return[2]}}))}))},e.prototype.reconnectStreamAndReturnIceConnectionState=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:S.log("[".concat(e,"] Reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") after event ").concat(e)),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.reconnectStream(e)];case 2:return r.sent(),t=this.session.openvidu.advancedConfiguration.iceConnectionDisconnectedExceptionTimeout||4e3,[2,this.awaitWebRtcPeerConnectionState(t)];case 3:return n=r.sent(),S.warn("[".concat(e,"] Error reconnecting stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber","). Reason: ").concat(n)),[2,this.awaitWebRtcPeerConnectionState(1)];case 4:return[2]}}))}))},e.prototype.reconnectStream=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return[4,this.isWebsocketConnected(e,3e3)];case 1:if(t=r.sent(),t)return S.log("[".concat(e,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") and the websocket is opened")),this.isLocal()?[2,this.initWebRtcPeerSend(!0)]:[2,this.initWebRtcPeerReceive(!0)];throw n="[".concat(e,"] Trying to reconnect stream ").concat(this.streamId," (").concat(this.isLocal()?"Publisher":"Subscriber",") but the websocket wasn't opened"),S.error(n),Error(n)}}))}))},e.prototype.isWebsocketConnected=function(e,t){var n=this;return new Promise((function(r,i){var o=n.session.openvidu.getWsReadyState();if(1!==o)return console.warn("[".concat(e,"] Websocket readyState is ").concat(o)),r(!1);var s=setTimeout((function(){return console.warn("[".concat(e,"] Websocket timeout of ").concat(t,"ms")),r(!1)}),t);n.session.openvidu.sendRequest("echo",{},(function(t,n){return clearTimeout(s),t?(console.warn("[".concat(e,"] Websocket 'echo' returned error: ").concat(t)),r(!1)):r(!0)}))}))},e.prototype.awaitWebRtcPeerConnectionState=function(e){return r(this,void 0,void 0,(function(){var t,n,r,o;return i(this,(function(i){switch(i.label){case 0:t=this.getRTCPeerConnection().iceConnectionState,n=150,r=Math.ceil(e/n),o=0,i.label=1;case 1:return o<r?(t=this.getRTCPeerConnection().iceConnectionState,"connected"===t||"completed"===t?[3,4]:[4,new Promise((function(e){return setTimeout(e,n)}))]):[3,4];case 2:i.sent(),i.label=3;case 3:return o++,[3,1];case 4:return[2,t]}}))}))},e.prototype.initWebRtcStats=function(){this.webRtcStats=new u.WebRtcStats(this),this.webRtcStats.initWebRtcStats()},e.prototype.stopWebRtcStats=function(){this.webRtcStats&&this.webRtcStats.isEnabled()&&this.webRtcStats.stopWebRtcStats()},e.prototype.getIceServersConf=function(){var e;return e=this.session.openvidu.advancedConfiguration.iceServers?"freeice"===this.session.openvidu.advancedConfiguration.iceServers?void 0:this.session.openvidu.advancedConfiguration.iceServers:this.session.openvidu.iceServers?this.session.openvidu.iceServers:void 0,e},e.prototype.gatherStatsForPeer=function(){var e=this;return new Promise((function(t,n){e.isLocal()?e.getRTCPeerConnection().getSenders().forEach((function(t){return t.getStats().then((function(t){t.forEach((function(t){if(e.isReportWanted(t)){var n={};n["type"]=t.type,n["timestamp"]=t.timestamp,n["id"]=t.id,"outbound-rtp"===t.type&&(n["ssrc"]=t.ssrc,n["firCount"]=t.firCount,n["pliCount"]=t.pliCount,n["nackCount"]=t.nackCount,n["qpSum"]=t.qpSum,t.kind?n["mediaType"]=t.kind:t.mediaType?n["mediaType"]=t.mediaType:n["mediaType"]=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n["mediaType"]&&(n["framesEncoded"]=t.framesEncoded),n["packetsSent"]=t.packetsSent,n["bytesSent"]=t.bytesSent),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n["availableOutgoingBitrate"]=t.availableOutgoingBitrate,n["rtt"]=t.currentRoundTripTime,n["averageRtt"]=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,S.log(n)}}))}))})):e.getRTCPeerConnection().getReceivers().forEach((function(t){return t.getStats().then((function(t){t.forEach((function(t){if(e.isReportWanted(t)){var n={};n["type"]=t.type,n["timestamp"]=t.timestamp,n["id"]=t.id,"inbound-rtp"===t.type&&(n["ssrc"]=t.ssrc,n["firCount"]=t.firCount,n["pliCount"]=t.pliCount,n["nackCount"]=t.nackCount,n["qpSum"]=t.qpSum,t.kind?n["mediaType"]=t.kind:t.mediaType?n["mediaType"]=t.mediaType:n["mediaType"]=-1!==t.id.indexOf("VideoStream")?"video":"audio","video"===n["mediaType"]&&(n["framesDecoded"]=t.framesDecoded),n["packetsReceived"]=t.packetsReceived,n["packetsLost"]=t.packetsLost,n["jitter"]=t.jitter,n["bytesReceived"]=t.bytesReceived),"candidate-pair"===t.type&&void 0!==t.totalRoundTripTime&&(n["availableIncomingBitrate"]=t.availableIncomingBitrate,n["rtt"]=t.currentRoundTripTime,n["averageRtt"]=t.totalRoundTripTime/t.responsesReceived),"remote-inbound-rtp"===t.type||t.type,S.log(n)}}))}))}))}))},e.prototype.isReportWanted=function(e){return"inbound-rtp"===e.type&&!this.isLocal()||"outbound-rtp"===e.type&&this.isLocal()||"candidate-pair"===e.type&&e.nominated&&e.bytesSent>0},e}();t.Stream=w},2028:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=void 0;var i,o=n(3013),s=n(3977),a=n(6367),c=n(6056),u=n(4270),d=n(5364),l=n(5971),p=d.OpenViduLogger.getInstance(),h=function(e){function t(t,n){var r=e.call(this)||this;if(r.videos=[],r.lazyLaunchVideoElementCreatedEvent=!1,i=l.PlatformUtils.getInstance(),r.stream=t,r.stream.streamManager=r,r.remote=!r.stream.isLocal(),n){var o=void 0;"string"===typeof n?o=document.getElementById(n):n instanceof HTMLElement&&(o=n),o&&(r.firstVideoElement={targetElement:o,video:document.createElement("video"),id:"",canplayListenerAdded:!1},(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&r.firstVideoElement.video.setAttribute("playsinline","true"),r.targetElement=o,r.element=o)}return r.canPlayListener=function(){r.deactivateStreamPlayingEventExceptionTimeout(),r.ee.emitEvent("streamPlaying",[new s.StreamManagerEvent(r,"streamPlaying",void 0)])},r}return r(t,e),t.prototype.on=function(t,n){return e.prototype.onAux.call(this,t,"Event '"+t+"' triggered by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&(this.ee.emitEvent("videoElementCreated",[new a.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!1),"streamPlaying"===t&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.ee.emitEvent("streamPlaying",[new s.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableHarkVolumeChangeEvent(!1)),this},t.prototype.once=function(t,n){return e.prototype.onceAux.call(this,t,"Event '"+t+"' triggered once by '"+(this.remote?"Subscriber":"Publisher")+"'",n),"videoElementCreated"===t&&this.stream&&this.lazyLaunchVideoElementCreatedEvent&&this.ee.emitEvent("videoElementCreated",[new a.VideoElementEvent(this.videos[0].video,this,"videoElementCreated")]),"streamPlaying"===t&&this.videos[0]&&this.videos[0].video&&this.videos[0].video.currentTime>0&&!1===this.videos[0].video.paused&&!1===this.videos[0].video.ended&&4===this.videos[0].video.readyState&&this.ee.emitEvent("streamPlaying",[new s.StreamManagerEvent(this,"streamPlaying",void 0)]),this.stream.hasAudio&&("publisherStartSpeaking"===t&&this.stream.enableOnceHarkSpeakingEvent(),"publisherStopSpeaking"===t&&this.stream.enableOnceHarkStoppedSpeakingEvent(),"streamAudioVolumeChange"===t&&this.stream.enableOnceHarkVolumeChangeEvent(!1)),this},t.prototype.off=function(t,n){if(e.prototype.offAux.call(this,t,n),"publisherStartSpeaking"===t){var r=this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length;0===r&&this.stream.disableHarkSpeakingEvent(!1)}if("publisherStopSpeaking"===t){var i=this.ee.getListeners(t).length+this.stream.session.ee.getListeners(t).length;0===i&&this.stream.disableHarkStoppedSpeakingEvent(!1)}if("streamAudioVolumeChange"===t){var o=this.ee.getListeners(t).length;0===o&&this.stream.disableHarkVolumeChangeEvent(!1)}return this},t.prototype.addVideoElement=function(e){this.initializeVideoProperties(e),!this.remote&&this.stream.displayMyRemote()&&e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream());for(var t=0,n=this.videos;t<n.length;t++){var r=n[t];if(r.video===e)return 0}for(var i=1,o=0,s=this.stream.session.streamManagers;o<s.length;o++){var a=s[o];if(a.disassociateVideo(e)){i=-1;break}}return this.stream.session.streamManagers.forEach((function(t){t.disassociateVideo(e)})),this.pushNewStreamManagerVideo({video:e,id:e.id,canplayListenerAdded:!1}),p.info("New video element associated to ",this),i},t.prototype.createVideoElement=function(e,t){var n;if("string"===typeof e){if(n=document.getElementById(e),!n)throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e)}else{if(!(e instanceof HTMLElement))throw new Error("The provided 'targetElement' couldn't be resolved to any HTML element: "+e);n=e}var r=this.createVideo();this.initializeVideoProperties(r);var i=t||u.VideoInsertMode.APPEND;switch(i){case u.VideoInsertMode.AFTER:n.parentNode.insertBefore(r,n.nextSibling);break;case u.VideoInsertMode.APPEND:n.appendChild(r);break;case u.VideoInsertMode.BEFORE:n.parentNode.insertBefore(r,n);break;case u.VideoInsertMode.PREPEND:n.insertBefore(r,n.childNodes[0]);break;case u.VideoInsertMode.REPLACE:n.parentNode.replaceChild(r,n);break;default:i=u.VideoInsertMode.APPEND,n.appendChild(r);break}var o={targetElement:n,video:r,insertMode:i,id:r.id,canplayListenerAdded:!1};return this.pushNewStreamManagerVideo(o),this.ee.emitEvent("videoElementCreated",[new a.VideoElementEvent(o.video,this,"videoElementCreated")]),this.lazyLaunchVideoElementCreatedEvent=!!this.firstVideoElement,r},t.prototype.updatePublisherSpeakingEventsOptions=function(e){var t=this.stream.harkOptions?this.stream.harkOptions:this.stream.session.openvidu.advancedConfiguration.publisherSpeakingEventsOptions||{},n="number"===typeof e.interval?e.interval:"number"===typeof t.interval?t.interval:100,r="number"===typeof e.threshold?e.threshold:"number"===typeof t.threshold?t.threshold:-50;this.stream.harkOptions={interval:n,threshold:r},this.stream.speechEvent&&(this.stream.speechEvent.setInterval(n),this.stream.speechEvent.setThreshold(r))},t.prototype.initializeVideoProperties=function(e){!this.remote&&this.stream.displayMyRemote()||e.srcObject!==this.stream.getMediaStream()&&(e.srcObject=this.stream.getMediaStream()),e.autoplay=!0,e.controls=!1,(i.isSafariBrowser()||i.isIPhoneOrIPad()&&(i.isChromeMobileBrowser()||i.isEdgeMobileBrowser()||i.isOperaMobileBrowser()||i.isFirefoxMobileBrowser()))&&e.setAttribute("playsinline","true"),e.id||(e.id=(this.remote?"remote-":"local-")+"video-"+this.stream.streamId,!this.id&&this.targetElement&&(this.id=e.id)),this.remote&&this.isMirroredVideo(e)?this.removeMirrorVideo(e):this.remote||this.stream.displayMyRemote()||(e.muted=!0,this.isMirroredVideo(e)&&!this.stream.outboundStreamOpts.publisherProperties.mirror?this.removeMirrorVideo(e):this.stream.outboundStreamOpts.publisherProperties.mirror&&!this.stream.isSendScreen()&&this.mirrorVideo(e))},t.prototype.removeAllVideos=function(){for(var e=this,t=this.stream.session.streamManagers.length-1;t>=0;--t)this.stream.session.streamManagers[t]===this&&this.stream.session.streamManagers.splice(t,1);this.videos.forEach((function(t){t.video&&t.video.removeEventListener&&t.video.removeEventListener("canplay",e.canPlayListener),t.canplayListenerAdded=!1,t.targetElement&&(t.video.parentNode.removeChild(t.video),e.ee.emitEvent("videoElementDestroyed",[new a.VideoElementEvent(t.video,e,"videoElementDestroyed")])),e.removeSrcObject(t),e.videos.filter((function(e){return!e.targetElement}))}))},t.prototype.disassociateVideo=function(e){for(var t=!1,n=0;n<this.videos.length;n++)if(this.videos[n].video===e){this.videos[n].video.removeEventListener("canplay",this.canPlayListener),this.videos.splice(n,1),t=!0,p.info("Video element disassociated from ",this);break}return t},t.prototype.addPlayEventToFirstVideo=function(){this.videos[0]&&this.videos[0].video&&!this.videos[0].canplayListenerAdded&&(this.activateStreamPlayingEventExceptionTimeout(),this.videos[0].video.addEventListener("canplay",this.canPlayListener),this.videos[0].canplayListenerAdded=!0)},t.prototype.updateMediaStream=function(e){this.videos.forEach((function(t){if(t.video.srcObject=e,i.isIonicIos()){var n=t.video.parentElement,r=t.video;n.replaceChild(r,t.video),t.video=r}}))},t.prototype.emitEvent=function(e,t){this.ee.emitEvent(e,t)},t.prototype.createVideo=function(){return document.createElement("video")},t.prototype.removeSrcObject=function(e){e.video.srcObject=null,this.deactivateStreamPlayingEventExceptionTimeout()},t.prototype.pushNewStreamManagerVideo=function(e){this.videos.push(e),this.addPlayEventToFirstVideo(),-1===this.stream.session.streamManagers.indexOf(this)&&this.stream.session.streamManagers.push(this)},t.prototype.mirrorVideo=function(e){i.isIonicIos()||(e.style.transform="rotateY(180deg)",e.style.webkitTransform="rotateY(180deg)")},t.prototype.removeMirrorVideo=function(e){e.style.transform="unset",e.style.webkitTransform="unset"},t.prototype.isMirroredVideo=function(e){return"rotateY(180deg)"===e.style.transform||"rotateY(180deg)"===e.style.webkitTransform},t.prototype.activateStreamPlayingEventExceptionTimeout=function(){var e=this;if(this.remote&&null==this.streamPlayingEventExceptionTimeout){var t=this.stream.session.openvidu.advancedConfiguration.noStreamPlayingEventExceptionTimeout||4e3;this.streamPlayingEventExceptionTimeout=setTimeout((function(){var n="StreamManager of Stream "+e.stream.streamId+" ("+(e.remote?"Subscriber":"Publisher")+') did not trigger "streamPlaying" event in '+t+" ms";p.warn(n),e.stream.session.emitEvent("exception",[new c.ExceptionEvent(e.stream.session,c.ExceptionEventName.NO_STREAM_PLAYING_EVENT,e,n)]),delete e.streamPlayingEventExceptionTimeout}),t)}},t.prototype.deactivateStreamPlayingEventExceptionTimeout=function(){clearTimeout(this.streamPlayingEventExceptionTimeout),delete this.streamPlayingEventExceptionTimeout},t}(o.EventDispatcher);t.StreamManager=h},5251:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriber=void 0;var s=n(2028),a=n(5364),c=a.OpenViduLogger.getInstance(),u=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.element=i.targetElement,i.stream=t,i.properties=r,i}return r(t,e),t.prototype.subscribeToAudio=function(e){return this.stream.getMediaStream().getAudioTracks().forEach((function(t){t.enabled=e})),this.stream.audioActive=e,c.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its audio stream"),this},t.prototype.subscribeToVideo=function(e){return this.stream.getMediaStream().getVideoTracks().forEach((function(t){t.enabled=e})),this.stream.videoActive=e,c.info("'Subscriber' has "+(e?"subscribed to":"unsubscribed from")+" its video stream"),this},t.prototype.replaceTrackInMediaStream=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){return n=this.stream.getMediaStream(),"video"===e.kind?(r=n.getVideoTracks()[0],t&&(this.stream.lastVideoTrackConstraints=e.getConstraints())):r=n.getAudioTracks()[0],n.removeTrack(r),r.stop(),n.addTrack(e),[2]}))}))},t}(s.StreamManager);t.Subscriber=u},4905:function(e,t,n){"use strict";t.Dn=void 0;var r=n(3129),i=n(4527);Object.defineProperty(t,"Dn",{enumerable:!0,get:function(){return i.OpenVidu}});var o=n(8330);var s=n(2917);var a=n(5251);var c=n(2028);var u=n(7686);var d=n(3274);var l=n(1944);var p=n(6153);var h=n(9690);var f=n(7009);var m=n(1513);var v=n(4270);var g=n(6300);var b=n(5223);var E=n(8271);var y=n(8856);var S=n(3439);var w=n(3685);var O=n(3590);var C=n(3977);var R=n(6367);var I=n(7614);var k=n(6203);var x=n(146);var P=n(9233);var T=n(6056);var N=n(3013);r.JL.setOptions({enabled:!1})},6728:function(e){"use strict";function t(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}t.prototype.define=function(e,t){for(let n in e){let r=e[n].map((function(e){return e.toLowerCase()}));n=n.toLowerCase();for(let e=0;e<r.length;e++){const i=r[e];if("*"!==i[0]){if(!t&&i in this._types)throw new Error('Attempt to change mapping for "'+i+'" extension from "'+this._types[i]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+i+'" from the list of extensions for "'+n+'".');this._types[i]=n}}if(t||!this._extensions[n]){const e=r[0];this._extensions[n]="*"!==e[0]?e:e.substr(1)}}},t.prototype.getType=function(e){e=String(e);let t=e.replace(/^.*[/\\]/,"").toLowerCase(),n=t.replace(/^.*\./,"").toLowerCase(),r=t.length<e.length,i=n.length<t.length-1;return(i||!r)&&this._types[n]||null},t.prototype.getExtension=function(e){return e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1,e&&this._extensions[e.toLowerCase()]||null},e.exports=t},4026:function(e,t,n){"use strict";let r=n(6728);e.exports=new r(n(1071))},1071:function(e){e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}},6902:function(e,t,n){const r=n(6537),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(9571),{re:s,t:a}=n(6893),c=n(8356),{compareIdentifiers:u}=n(3465);class d{constructor(e,t){if(t=c(t),e instanceof d){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!==typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof d)){if("string"===typeof e&&e===this.version)return 0;e=new d(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof d||(e=new d(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof d||(e=new d(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof d||(e=new d(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;while(--e>=0)"number"===typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=d},6455:function(e,t,n){const r=n(6902),i=(e,t)=>new r(e,t).major;e.exports=i},5919:function(e,t,n){const r=n(6902),i=(e,t)=>new r(e,t).minor;e.exports=i},9571:function(e){const t="2.0.0",n=256,r=Number.MAX_SAFE_INTEGER||9007199254740991,i=16;e.exports={SEMVER_SPEC_VERSION:t,MAX_LENGTH:n,MAX_SAFE_INTEGER:r,MAX_SAFE_COMPONENT_LENGTH:i}},6537:function(e){const t="object"===typeof process&&{NODE_ENV:"production",BASE_URL:"/"}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",BASE_URL:"/"}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},3465:function(e){const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1},r=(e,t)=>n(t,e);e.exports={compareIdentifiers:n,rcompareIdentifiers:r}},8356:function(e){const t=["includePrerelease","loose","rtl"],n=e=>e?"object"!==typeof e?{loose:!0}:t.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{};e.exports=n},6893:function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:r}=n(9571),i=n(6537);t=e.exports={};const o=t.re=[],s=t.src=[],a=t.t={};let c=0;const u=(e,t,n)=>{const r=c++;i(r,t),a[e]=r,s[r]=t,o[r]=new RegExp(t,n?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),u("FULL",`^${s[a.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),u("LOOSE",`^${s[a.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),u("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),u("COERCERTL",s[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},1795:function(e,t,n){var r;
/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */e=n.nmd(e),function(){"use strict";var i={function:!0,object:!0},o=i[typeof window]&&window||this,s=i[typeof t]&&t,a=i["object"]&&e&&!e.nodeType&&e,c=s&&a&&"object"==typeof n.g&&n.g;!c||c.global!==c&&c.window!==c&&c.self!==c||(o=c);var u=Math.pow(2,53)-1,d=/\bOpera/,l=Object.prototype,p=l.hasOwnProperty,h=l.toString;function f(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function m(e,t,n){var r={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(r=r[/[\d.]+$/.exec(e)])&&(e="Windows "+r),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=g(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),e}function v(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=u)while(++n<r)t(e[n],n,e);else b(e,t)}function g(e){return e=O(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:f(e)}function b(e,t){for(var n in e)p.call(e,n)&&t(e[n],n,e)}function E(e){return null==e?f(e):h.call(e).slice(8,-1)}function y(e,t){var n=null!=e?typeof e[t]:"number";return!/^(?:boolean|number|string|undefined)$/.test(n)&&("object"!=n||!!e[t])}function S(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function w(e,t){var n=null;return v(e,(function(r,i){n=t(n,r,i,e)})),n}function O(e){return String(e).replace(/^ +| +$/g,"")}function C(e){var t=o,n=e&&"object"==typeof e&&"String"!=E(e);n&&(t=e,e=null);var r=t.navigator||{},i=r.userAgent||"";e||(e=i);var s,a,c=n?!!r.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(h.toString()),u="Object",l=n?u:"ScriptBridgingProxyObject",p=n?u:"Environment",f=n&&t.java?"JavaPackage":E(t.java),v=n?u:"RuntimeObject",R=/\bJava/.test(f)&&t.java,I=R&&E(t.environment)==p,k=R?"a":"α",x=R?"b":"β",P=t.document||{},T=t.operamini||t.opera,N=d.test(N=n&&T?T["[[Class]]"]:E(T))?N:T=null,_=e,L=[],A=null,M=e==i,V=M&&T&&"function"==typeof T.version&&T.version(),D=W([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),j=G(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),B=$([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),U=H({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),F=q(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function W(t){return w(t,(function(t,n){return t||RegExp("\\b"+(n.pattern||S(n))+"\\b","i").exec(e)&&(n.label||n)}))}function H(t){return w(t,(function(t,n,r){return t||(n[B]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(B)]||RegExp("\\b"+S(r)+"(?:\\b|\\w*\\d)","i").exec(e))&&r}))}function G(t){return w(t,(function(t,n){return t||RegExp("\\b"+(n.pattern||S(n))+"\\b","i").exec(e)&&(n.label||n)}))}function q(t){return w(t,(function(t,n){var r=n.pattern||S(n);return!t&&(t=RegExp("\\b"+r+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=m(t,r,n.label||n)),t}))}function $(t){return w(t,(function(t,n){var r=n.pattern||S(n);return!t&&(t=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),n=n.label||n,t=g(t[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),t}))}function J(t){return w(t,(function(t,n){return t||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null}))}function z(){return this.description||""}if(D&&(D=[D]),/\bAndroid\b/.test(F)&&!B&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(e))&&(B=O(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),U&&!B?B=$([U]):U&&B&&(B=B.replace(RegExp("^("+S(U)+")[-_.\\s]","i"),U+" ").replace(RegExp("^("+S(U)+")[-_.]?(\\w)","i"),U+" $2")),(s=/\bGoogle TV\b/.exec(B))&&(B=s[0]),/\bSimulator\b/i.test(e)&&(B=(B?B+" ":"")+"Simulator"),"Opera Mini"==j&&/\bOPiOS\b/.test(e)&&L.push("running in Turbo/Uncompressed mode"),"IE"==j&&/\blike iPhone OS\b/.test(e)?(s=C(e.replace(/like iPhone OS/,"")),U=s.manufacturer,B=s.product):/^iP/.test(B)?(j||(j="Safari"),F="iOS"+((s=/ OS ([\d_]+)/i.exec(e))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==j&&/^Linux\b/i.test(F)?F="Kubuntu":U&&"Google"!=U&&(/Chrome/.test(j)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(B))||/\bAndroid\b/.test(F)&&/^Chrome/.test(j)&&/\bVersion\//i.test(e)?(j="Android Browser",F=/\bAndroid\b/.test(F)?F:"Android"):"Silk"==j?(/\bMobi/i.test(e)||(F="Android",L.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&L.unshift("accelerated")):"UC Browser"==j&&/\bUCWEB\b/.test(e)?L.push("speed mode"):"PaleMoon"==j&&(s=/\bFirefox\/([\d.]+)\b/.exec(e))?L.push("identifying as Firefox "+s[1]):"Firefox"==j&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(F||(F="Firefox OS"),B||(B=s[1])):!j||(s=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(j))?(j&&!B&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(s+"/")+8))&&(j=null),(s=B||U||F)&&(B||U||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(F))&&(j=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(F)?F:s)+" Browser")):"Electron"==j&&(s=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&L.push("Chromium "+s),V||(V=J(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",S(j),"(?:Firefox|Minefield|NetFront)"])),(s=("iCab"==D&&parseFloat(V)>3?"WebKit":/\bOpera\b/.test(j)&&(/\bOPR\b/.test(e)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(D)&&"WebKit"||!D&&/\bMSIE\b/i.test(e)&&("Mac OS"==F?"Tasman":"Trident")||"WebKit"==D&&/\bPlayStation\b(?! Vita\b)/i.test(j)&&"NetFront")&&(D=[s]),"IE"==j&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(j+=" Mobile",F="Windows Phone "+(/\+$/.test(s)?s:s+".x"),L.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(j="IE Mobile",F="Windows Phone 8.x",L.unshift("desktop mode"),V||(V=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=j&&"Trident"==D&&(s=/\brv:([\d.]+)/.exec(e))&&(j&&L.push("identifying as "+j+(V?" "+V:"")),j="IE",V=s[1]),M){if(y(t,"global"))if(R&&(s=R.lang.System,_=s.getProperty("os.arch"),F=F||s.getProperty("os.name")+" "+s.getProperty("os.version")),I){try{V=t.require("ringo/engine").version.join("."),j="RingoJS"}catch(Y){(s=t.system)&&s.global.system==t.system&&(j="Narwhal",F||(F=s[0].os||null))}j||(j="Rhino")}else"object"==typeof t.process&&!t.process.browser&&(s=t.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(L.push("Node "+s.versions.node),j="Electron",V=s.versions.electron):"string"==typeof s.versions.nw&&(L.push("Chromium "+V,"Node "+s.versions.node),j="NW.js",V=s.versions.nw)),j||(j="Node.js",_=s.arch,F=s.platform,V=/[\d.]+/.exec(s.version),V=V?V[0]:null));else E(s=t.runtime)==l?(j="Adobe AIR",F=s.flash.system.Capabilities.os):E(s=t.phantom)==v?(j="PhantomJS",V=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof P.documentMode&&(s=/\bTrident\/(\d+)/i.exec(e))?(V=[V,P.documentMode],(s=+s[1]+4)!=V[1]&&(L.push("IE "+V[1]+" mode"),D&&(D[1]=""),V[1]=s),V="IE"==j?String(V[1].toFixed(1)):V[0]):"number"==typeof P.documentMode&&/^(?:Chrome|Firefox)\b/.test(j)&&(L.push("masking as "+j+" "+V),j="IE",V="11.0",D=["Trident"],F="Windows");F=F&&g(F)}if(V&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(V)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(M&&r.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(A=/b/i.test(s)?"beta":"alpha",V=V.replace(RegExp(s+"\\+?$"),"")+("beta"==A?x:k)+(/\d+\+?/.exec(s)||"")),"Fennec"==j||"Firefox"==j&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(F))j="Firefox Mobile";else if("Maxthon"==j&&V)V=V.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(B))"Xbox 360"==B&&(F=null),"Xbox 360"==B&&/\bIEMobile\b/.test(e)&&L.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(j)&&(!j||B||/Browser|Mobi/.test(j))||"Windows CE"!=F&&!/Mobi/i.test(e))if("IE"==j&&M)try{null===t.external&&L.unshift("platform preview")}catch(Y){L.unshift("embedded")}else(/\bBlackBerry\b/.test(B)||/\bBB10\b/.test(e))&&(s=(RegExp(B.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||V)?(s=[s,/BB10/.test(e)],F=(s[1]?(B=null,U="BlackBerry"):"Device Software")+" "+s[0],V=null):this!=b&&"Wii"!=B&&(M&&T||/Opera/.test(j)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==j&&/\bOS X (?:\d+\.){2,}/.test(F)||"IE"==j&&(F&&!/^Win/.test(F)&&V>5.5||/\bWindows XP\b/.test(F)&&V>8||8==V&&!/\bTrident\b/.test(e)))&&!d.test(s=C.call(b,e.replace(d,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),d.test(j)?(/\bIE\b/.test(s)&&"Mac OS"==F&&(F=null),s="identify"+s):(s="mask"+s,j=N?g(N.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(F=null),M||(V=null)),D=["Presto"],L.push(s));else j+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==j&&"+"==s[1].slice(-1)?(j="WebKit Nightly",A="alpha",V=s[1].slice(0,-1)):V!=s[1]&&V!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(V=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(e)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==D&&(D=["Blink"]),M&&(c||s[1])?(D&&(D[1]="like Chrome"),s=s[1]||(s=s[0],s<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=D?"27":"28")):(D&&(D[1]="like Safari"),s=s[0],s=s<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),D&&(D[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==j&&(!V||parseInt(V)>45)?V=s:"Chrome"==j&&/\bHeadlessChrome/i.test(e)&&L.unshift("headless")),"Opera"==j&&(s=/\bzbov|zvav$/.exec(F))?(j+=" ",L.unshift("desktop mode"),"zvav"==s?(j+="Mini",V=null):j+="Mobile",F=F.replace(RegExp(" *"+s+"$"),"")):"Safari"==j&&/\bChrome\b/.exec(D&&D[1])?(L.unshift("desktop mode"),j="Chrome Mobile",V=null,/\bOS X\b/.test(F)?(U="Apple",F="iOS 4.3+"):F=null):/\bSRWare Iron\b/.test(j)&&!V&&(V=J("Chrome")),V&&0==V.indexOf(s=/[\d.]+$/.exec(F))&&e.indexOf("/"+s+"-")>-1&&(F=O(F.replace(s,""))),F&&-1!=F.indexOf(j)&&!RegExp(j+" OS").test(F)&&(F=F.replace(RegExp(" *"+S(j)+" *"),"")),D&&!/\b(?:Avant|Nook)\b/.test(j)&&(/Browser|Lunascape|Maxthon/.test(j)||"Safari"!=j&&/^iOS/.test(F)&&/\bSafari\b/.test(D[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(j)&&D[1])&&(s=D[D.length-1])&&L.push(s),L.length&&(L=["("+L.join("; ")+")"]),U&&B&&B.indexOf(U)<0&&L.push("on "+U),B&&L.push((/^on /.test(L[L.length-1])?"":"on ")+B),F&&(s=/ ([\d.+]+)$/.exec(F),a=s&&"/"==F.charAt(F.length-s[0].length-1),F={architecture:32,family:s&&!a?F.replace(s[0],""):F,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!a?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(_))&&!/\bi686\b/i.test(_)?(F&&(F.architecture=64,F.family=F.family.replace(RegExp(" *"+s),"")),j&&(/\bWOW64\b/i.test(e)||M&&/\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\bWin64; x64\b/i.test(e))&&L.unshift("32-bit")):F&&/^OS X/.test(F.family)&&"Chrome"==j&&parseFloat(V)>=39&&(F.architecture=64),e||(e=null);var X={};return X.description=e,X.layout=D&&D[0],X.manufacturer=U,X.name=j,X.prerelease=A,X.product=B,X.ua=e,X.version=j&&V,X.os=F||{architecture:null,family:null,version:null,toString:function(){return"null"}},X.parse=C,X.toString=z,X.version&&L.unshift(V),X.name&&L.unshift(j),F&&j&&(F!=String(F).split(" ")[0]||F!=j.split(" ")[0]&&!B)&&L.push(B?"("+F+")":"on "+F),L.length&&(X.description=L.join(" ")),X}var R=C();o.platform=R,r=function(){return R}.call(t,n,t,e),void 0===r||(e.exports=r)}.call(this)},812:function(e,t,n){"use strict";var r;n.r(t),n.d(t,{NIL:function(){return z},parse:function(){return y},stringify:function(){return f},v1:function(){return b},v3:function(){return B},v4:function(){return F},v5:function(){return J},validate:function(){return c},version:function(){return Y}});var i=new Uint8Array(16);function o(){if(!r&&(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}var s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function a(e){return"string"===typeof e&&s.test(e)}for(var c=a,u=[],d=0;d<256;++d)u.push((d+256).toString(16).substr(1));function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!c(n))throw TypeError("Stringified UUID is invalid");return n}var p,h,f=l,m=0,v=0;function g(e,t,n){var r=t&&n||0,i=t||new Array(16);e=e||{};var s=e.node||p,a=void 0!==e.clockseq?e.clockseq:h;if(null==s||null==a){var c=e.random||(e.rng||o)();null==s&&(s=p=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==a&&(a=h=16383&(c[6]<<8|c[7]))}var u=void 0!==e.msecs?e.msecs:Date.now(),d=void 0!==e.nsecs?e.nsecs:v+1,l=u-m+(d-v)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||u>m)&&void 0===e.nsecs&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=u,v=d,h=a,u+=122192928e5;var g=(1e4*(268435455&u)+d)%4294967296;i[r++]=g>>>24&255,i[r++]=g>>>16&255,i[r++]=g>>>8&255,i[r++]=255&g;var b=u/4294967296*1e4&268435455;i[r++]=b>>>8&255,i[r++]=255&b,i[r++]=b>>>24&15|16,i[r++]=b>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var E=0;E<6;++E)i[r+E]=s[E];return t||f(i)}var b=g;function E(e){if(!c(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}var y=E;function S(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}var w="6ba7b810-9dad-11d1-80b4-00c04fd430c8",O="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function C(e,t,n){function r(e,r,i,o){if("string"===typeof e&&(e=S(e)),"string"===typeof r&&(r=y(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(r),s.set(e,r.length),s=n(s),s[6]=15&s[6]|t,s[8]=63&s[8]|128,i){o=o||0;for(var a=0;a<16;++a)i[o+a]=s[a];return i}return f(s)}try{r.name=e}catch(i){}return r.DNS=w,r.URL=O,r}function R(e){if("string"===typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return I(x(P(e),8*e.length))}function I(e){for(var t=[],n=32*e.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=e[i>>5]>>>i%32&255,s=parseInt(r.charAt(o>>>4&15)+r.charAt(15&o),16);t.push(s)}return t}function k(e){return 14+(e+64>>>9<<4)+1}function x(e,t){e[t>>5]|=128<<t%32,e[k(t)-1]=t;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=n,c=r,u=i,d=o;n=L(n,r,i,o,e[s],7,-680876936),o=L(o,n,r,i,e[s+1],12,-389564586),i=L(i,o,n,r,e[s+2],17,606105819),r=L(r,i,o,n,e[s+3],22,-1044525330),n=L(n,r,i,o,e[s+4],7,-176418897),o=L(o,n,r,i,e[s+5],12,1200080426),i=L(i,o,n,r,e[s+6],17,-1473231341),r=L(r,i,o,n,e[s+7],22,-45705983),n=L(n,r,i,o,e[s+8],7,1770035416),o=L(o,n,r,i,e[s+9],12,-1958414417),i=L(i,o,n,r,e[s+10],17,-42063),r=L(r,i,o,n,e[s+11],22,-1990404162),n=L(n,r,i,o,e[s+12],7,1804603682),o=L(o,n,r,i,e[s+13],12,-40341101),i=L(i,o,n,r,e[s+14],17,-1502002290),r=L(r,i,o,n,e[s+15],22,1236535329),n=A(n,r,i,o,e[s+1],5,-165796510),o=A(o,n,r,i,e[s+6],9,-1069501632),i=A(i,o,n,r,e[s+11],14,643717713),r=A(r,i,o,n,e[s],20,-373897302),n=A(n,r,i,o,e[s+5],5,-701558691),o=A(o,n,r,i,e[s+10],9,38016083),i=A(i,o,n,r,e[s+15],14,-660478335),r=A(r,i,o,n,e[s+4],20,-405537848),n=A(n,r,i,o,e[s+9],5,568446438),o=A(o,n,r,i,e[s+14],9,-1019803690),i=A(i,o,n,r,e[s+3],14,-187363961),r=A(r,i,o,n,e[s+8],20,1163531501),n=A(n,r,i,o,e[s+13],5,-1444681467),o=A(o,n,r,i,e[s+2],9,-51403784),i=A(i,o,n,r,e[s+7],14,1735328473),r=A(r,i,o,n,e[s+12],20,-1926607734),n=M(n,r,i,o,e[s+5],4,-378558),o=M(o,n,r,i,e[s+8],11,-2022574463),i=M(i,o,n,r,e[s+11],16,1839030562),r=M(r,i,o,n,e[s+14],23,-35309556),n=M(n,r,i,o,e[s+1],4,-1530992060),o=M(o,n,r,i,e[s+4],11,1272893353),i=M(i,o,n,r,e[s+7],16,-155497632),r=M(r,i,o,n,e[s+10],23,-1094730640),n=M(n,r,i,o,e[s+13],4,681279174),o=M(o,n,r,i,e[s],11,-358537222),i=M(i,o,n,r,e[s+3],16,-722521979),r=M(r,i,o,n,e[s+6],23,76029189),n=M(n,r,i,o,e[s+9],4,-640364487),o=M(o,n,r,i,e[s+12],11,-421815835),i=M(i,o,n,r,e[s+15],16,530742520),r=M(r,i,o,n,e[s+2],23,-995338651),n=V(n,r,i,o,e[s],6,-198630844),o=V(o,n,r,i,e[s+7],10,1126891415),i=V(i,o,n,r,e[s+14],15,-1416354905),r=V(r,i,o,n,e[s+5],21,-57434055),n=V(n,r,i,o,e[s+12],6,1700485571),o=V(o,n,r,i,e[s+3],10,-1894986606),i=V(i,o,n,r,e[s+10],15,-1051523),r=V(r,i,o,n,e[s+1],21,-2054922799),n=V(n,r,i,o,e[s+8],6,1873313359),o=V(o,n,r,i,e[s+15],10,-30611744),i=V(i,o,n,r,e[s+6],15,-1560198380),r=V(r,i,o,n,e[s+13],21,1309151649),n=V(n,r,i,o,e[s+4],6,-145523070),o=V(o,n,r,i,e[s+11],10,-1120210379),i=V(i,o,n,r,e[s+2],15,718787259),r=V(r,i,o,n,e[s+9],21,-343485551),n=T(n,a),r=T(r,c),i=T(i,u),o=T(o,d)}return[n,r,i,o]}function P(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(k(t)),r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}function T(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function N(e,t){return e<<t|e>>>32-t}function _(e,t,n,r,i,o){return T(N(T(T(t,e),T(r,o)),i),n)}function L(e,t,n,r,i,o,s){return _(t&n|~t&r,e,t,i,o,s)}function A(e,t,n,r,i,o,s){return _(t&r|n&~r,e,t,i,o,s)}function M(e,t,n,r,i,o,s){return _(t^n^r,e,t,i,o,s)}function V(e,t,n,r,i,o,s){return _(n^(t|~r),e,t,i,o,s)}var D=R,j=C("v3",48,D),B=j;function U(e,t,n){e=e||{};var r=e.random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return f(r)}var F=U;function W(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function H(e,t){return e<<t|e>>>32-t}function G(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"===typeof e){var r=unescape(encodeURIComponent(e));e=[];for(var i=0;i<r.length;++i)e.push(r.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,s=Math.ceil(o/16),a=new Array(s),c=0;c<s;++c){for(var u=new Uint32Array(16),d=0;d<16;++d)u[d]=e[64*c+4*d]<<24|e[64*c+4*d+1]<<16|e[64*c+4*d+2]<<8|e[64*c+4*d+3];a[c]=u}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(var l=0;l<s;++l){for(var p=new Uint32Array(80),h=0;h<16;++h)p[h]=a[l][h];for(var f=16;f<80;++f)p[f]=H(p[f-3]^p[f-8]^p[f-14]^p[f-16],1);for(var m=n[0],v=n[1],g=n[2],b=n[3],E=n[4],y=0;y<80;++y){var S=Math.floor(y/20),w=H(m,5)+W(S,v,g,b)+E+t[S]+p[y]>>>0;E=b,b=g,g=H(v,30)>>>0,v=m,m=w}n[0]=n[0]+m>>>0,n[1]=n[1]+v>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+b>>>0,n[4]=n[4]+E>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}var q=G,$=C("v5",80,q),J=$,z="00000000-0000-0000-0000-000000000000";function X(e){if(!c(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}var Y=X},4114:function(e){function t(){}e.exports=t,t.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3===arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return o._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(e,t,n){var r=this,i=3===arguments.length,o=i?arguments[1]:void 0,s=i?arguments[2]:arguments[1];function a(){r.off(e,a),s.apply(this,arguments)}return this.on(e,o,a),this},t.releaseGroup=function(e){var t,n,r,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(i=this.callbacks[t],n=0,r=i.length;n<r;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r?1===arguments.length?(delete this.callbacks[e],this):(n=r.indexOf(t),-1!==n&&(r.splice(n,1),0===r.length&&delete this.callbacks[e]),this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),o=this.callbacks[e],s=this.getWildcardCallbacks(e);if(o)for(r=o.slice(),t=0,n=r.length;t<n;++t){if(!r[t])break;r[t].apply(this,i)}if(s)for(n=s.length,r=s.slice(),t=0,n=r.length;t<n;++t){if(!r[t])break;r[t].apply(this,[e].concat(i))}return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},t.mixin(t)},4795:function(e,t,n){var r;
/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(t){"use strict";function i(){}var o=i.prototype,s=t.EventEmitter;function a(e,t){var n=e.length;while(n--)if(e[n].listener===t)return n;return-1}function c(e){return function(){return this[e].apply(this,arguments)}}function u(e){return"function"===typeof e||e instanceof RegExp||!(!e||"object"!==typeof e)&&u(e.listener)}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},o.addListener=function(e,t){if(!u(t))throw new TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"===typeof t;for(n in r)r.hasOwnProperty(n)&&-1===a(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&(n=a(i[r],t),-1!==n&&i[r].splice(n,1));return this},o.off=c("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!==typeof t||t instanceof RegExp){r=n.length;while(r--)o.call(this,t,n[r])}else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"===typeof i?o.call(this,r,i):s.call(this,r,i));return this},o.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,s,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].slice(0),i=0;i<n.length;i++)r=n[i],!0===r.once&&this.removeListener(e,r.listener),s=r.listener.apply(this,t||[]),s===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=c("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=s,i},r=function(){return i}.call(t,n,t,e),void 0===r||(e.exports=r)})("undefined"!==typeof window?window:this||{})},9713:function(e,t,n){"use strict";e.exports=n.p+"img/openvidu_grey_bg_transp_cropped.9bbabff2.png"},8808:function(e){"use strict";e.exports=JSON.parse('["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]')},4576:function(e){"use strict";e.exports=[]},5549:function(e){"use strict";e.exports=JSON.parse('{"_from":"openvidu-browser@2.22.0","_id":"openvidu-browser@2.22.0","_inBundle":false,"_integrity":"sha512-fug7V5WZPwEXCF4im6RzhWSbv9nYB4QWMXrEQBEsh7RI1VPQ5Jl2VcindiUeMtN+quLqeTjXSRUh4lfkrTlQSQ==","_location":"/openvidu-browser","_phantomChildren":{"lru-cache":"6.0.0"},"_requested":{"type":"version","registry":true,"raw":"openvidu-browser@2.22.0","name":"openvidu-browser","escapedName":"openvidu-browser","rawSpec":"2.22.0","saveSpec":null,"fetchSpec":"2.22.0"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/openvidu-browser/-/openvidu-browser-2.22.0.tgz","_shasum":"e20d269228da6a91675f8cadfa785b48ac6ede40","_spec":"openvidu-browser@2.22.0","_where":"C:\\\\SSAFY\\\\S07P12A307-front\\\\frontend","author":{"name":"OpenVidu"},"bugs":{"url":"https://github.com/OpenVidu/openvidu/issues"},"bundleDependencies":false,"dependencies":{"events":"3.3.0","freeice":"2.2.2","hark":"1.2.3","inherits":"2.0.4","jsnlog":"2.30.0","mime":"3.0.0","platform":"1.3.6","semver":"7.3.5","uuid":"8.3.2","wolfy87-eventemitter":"5.2.9"},"deprecated":false,"description":"OpenVidu Browser","devDependencies":{"@types/node":"17.0.8","@types/platform":"1.3.4","browserify":"17.0.0","grunt":"1.4.1","grunt-cli":"1.4.3","grunt-contrib-copy":"1.0.0","grunt-contrib-sass":"2.0.0","grunt-contrib-uglify":"5.0.1","grunt-contrib-watch":"1.1.0","grunt-postcss":"0.9.0","grunt-string-replace":"1.3.1","grunt-ts":"6.0.0-beta.22","terser":"5.10.0","tsify":"5.0.4","tslint":"6.1.3","typedoc":"0.22.10","typescript":"4.5.4"},"homepage":"https://github.com/OpenVidu/openvidu#readme","license":"Apache-2.0","main":"lib/index.js","name":"openvidu-browser","repository":{"type":"git","url":"git://github.com/OpenVidu/openvidu.git"},"scripts":{"browserify":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js Main.ts -p [ tsify ] --exclude kurento-browser-extensions --debug -o ../static/js/openvidu-browser-$VERSION.js -v","browserify-prod":"VERSION=${VERSION:-dev}; mkdir -p static/js/ && cd src && ../node_modules/browserify/bin/cmd.js --debug Main.ts -p [ tsify ] --exclude kurento-browser-extensions | ../node_modules/terser/bin/terser --source-map content=inline --output ../static/js/openvidu-browser-$VERSION.min.js","build":"cd src/OpenVidu && ./../../node_modules/typescript/bin/tsc && cd ../.. && ./node_modules/typescript/bin/tsc --declaration src/index.ts --outDir ./lib --sourceMap --target es5 --lib dom,es5,es2015.promise,scripthost && rm -rf ./ts4.4 && mkdir -p ./ts4.4/lib && cp -r ./lib ./ts4.4 && find ./ts4.4/lib -type f ! -iname \'*.d.ts\' -delete && ./config/replace_for_ts44.sh","docs":"./generate-docs.sh"},"types":"lib/index.d.ts","typesVersions":{"<4.4":{"*":["ts4.4/*"]}},"version":"2.22.0"}')}}]);
//# sourceMappingURL=488.54b60270.js.map