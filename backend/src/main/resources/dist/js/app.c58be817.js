(function(){"use strict";var t={5646:function(t,e,s){var n=s(144),o=function(){var t=this,e=t._self._c;return e("div",{style:{backgroundImage:"url("+s(5665)+")"},attrs:{id:"app"}},[e("nav",[e("router-link",{attrs:{to:"/"}},[t._v("Home")]),t._v(" | "),e("router-link",{attrs:{to:"/waiting"}},[t._v("WaitingRoom")])],1),e("router-view")],1)},i=[],a=s(1001),r={},l=(0,a.Z)(r,o,i,!1,null,null,null),u=l.exports,c=s(8345),d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("router-link",{attrs:{to:"/login"}},[t._v("로그인")])],1)},m=[],p={name:"HomeView",components:{}},h=p,v=(0,a.Z)(h,d,m,!1,null,null,null),g=v.exports,f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login"},[e("h1",[t._v("로그인")]),e("form",{staticClass:"loginform"},[e("p",[e("label",{attrs:{for:"memberIdInput"}},[t._v("이메일")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.memberId,expression:"memberId",modifiers:{trim:!0}}],ref:"memberIdInput",staticClass:"input_text",attrs:{type:"text",id:"memberIdInput",placeholder:"email"},domProps:{value:t.memberId},on:{input:function(e){e.target.composing||(t.memberId=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),e("p",[e("label",{attrs:{for:"memberPasswordInput"}},[t._v("패스워드")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.memberPassword,expression:"memberPassword",modifiers:{trim:!0}}],ref:"memberPasswordInput",staticClass:"input_text",attrs:{type:"password",id:"memberPasswordInput",placeholder:"password"},domProps:{value:t.memberPassword},on:{input:function(e){e.target.composing||(t.memberPassword=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),e("p",{staticClass:"buttons"},[e("button",{staticClass:"button blue",on:{click:function(e){return e.preventDefault(),t.doLogin.apply(null,arguments)}}},[t._v("로그인")]),e("button",{staticClass:"button",on:{click:function(e){return e.preventDefault(),t.doCancel.apply(null,arguments)}}},[t._v("취소")])])]),e("p",[t._v(t._s(t.errorMessage))]),e("button",{staticClass:"button"},[e("router-link",{attrs:{to:"/signup"}},[t._v("회원가입")])],1)])},b=[],_={name:"LoginPage",data:function(){return{memberId:"",memberPassword:"",errorMessage:""}},methods:{doLogin(){return""==this.memberId?(alert("아이디를 입력하세요."),void this.$refs.memberIdInput.focus()):""==this.memberPassword?(alert("패스워드를 입력하세요."),void this.$refs.memberPasswordInput.focus()):void 0},doCancel(){this.$router.push("/")}},mounted(){this.$refs.memberIdInput.focus()}},y=_,w=(0,a.Z)(y,f,b,!1,null,"4c4136de",null),k=w.exports,x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"signup"},[e("h1",[t._v("회원가입")]),e("form",{staticClass:"signupform"},[e("p",[e("label",{attrs:{for:"emailInput"}},[t._v("EMAIL")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.email,expression:"email",modifiers:{trim:!0}}],staticClass:"input_text",attrs:{type:"text",id:"emailInput",placeholder:"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),e("p",[e("label",{attrs:{for:"nicknameInput"}},[t._v("NICKNAME")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.nickname,expression:"nickname",modifiers:{trim:!0}}],staticClass:"input_text",attrs:{type:"text",id:"nicknameInput",placeholder:"nickname"},domProps:{value:t.nickname},on:{input:function(e){e.target.composing||(t.nickname=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),e("p",[e("label",{attrs:{for:"PWInput"}},[t._v("PW")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],staticClass:"input_text",attrs:{type:"password",id:"PWInput",placeholder:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),e("p",[e("label",{attrs:{for:"PWCheckInput"}},[t._v("PW 확인")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.checkPassword,expression:"checkPassword",modifiers:{trim:!0}}],staticClass:"input_text",attrs:{type:"password",id:"PWCheckInput",placeholder:"password"},domProps:{value:t.checkPassword},on:{input:function(e){e.target.composing||(t.checkPassword=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t._m(0)]),e("button",[e("router-link",{attrs:{to:"/login"}},[t._v("로그인")])],1)])},C=[function(){var t=this,e=t._self._c;return e("p",{staticClass:"buttons"},[e("button",{staticClass:"button"},[t._v("가입하기")])])}],S={name:"SignupPage",data(){return{email:"",nickname:"",password:"",checkPassword:""}},methods:{}},P=S,M=(0,a.Z)(P,x,C,!1,null,null,null),I=M.exports,O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"waiting-room"},[e("chatting"),e("br"),e("room-list"),e("br"),e("user-list"),e("br"),e("router-link",{attrs:{to:"/room"}},[t._v("게임방 입장")])],1)},N=[],Z=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"chatting"}},[e("h2",[t._v("Vue.js WebSocket Tutorial")]),e("div",{staticStyle:{width:"800px",height:"700px",padding:"10px",border:"solid 1px"}},[e("div",{attrs:{id:"divChatData"}},[t._v(t._s(t.text))])]),e("div",{staticStyle:{width:"100%",height:"10%",padding:"10px"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{type:"text",id:"message",size:"110"},domProps:{value:t.message},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage.apply(null,arguments)},input:function(e){e.target.composing||(t.message=e.target.value)}}}),e("button",{on:{click:t.sendMessage}},[t._v("Send")])])])},j=[],L={name:"ChattingStage",data:function(){return{message:"",text:"hello"}},methods:{sendMessage:function(t){console.log(t),this.message=this.connection.send(this.message)}},created:function(){console.log("Starting connection to WebSocket Server"),this.connection=new WebSocket("wss://localhost:8080/ws/chat"),this.connection.onmessage=t=>{console.log(t),this.text+=t.data,this.text+="\n"},this.connection.onopen=function(t){console.log(t),console.log("Successfully connected to the echo websocket server...")}}},U=L,V=(0,a.Z)(U,Z,j,!1,null,null,null),$=V.exports,D=function(){var t=this,e=t._self._c;return e("div",{staticClass:"room-list"},[e("room-list-item")],1)},T=[],E=function(){var t=this,e=t._self._c;return e("div",{staticClass:"room-list-item"})},W=[],A={name:"RoomListItem"},R=A,F=(0,a.Z)(R,E,W,!1,null,null,null),q=F.exports,J={name:"RoomList",components:{RoomListItem:q}},H=J,B=(0,a.Z)(H,D,T,!1,null,null,null),G=B.exports,K=function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-list"})},z=[],Y={name:"UserList"},Q=Y,X=(0,a.Z)(Q,K,z,!1,null,null,null),tt=X.exports,et={name:"WaitingRoomView",components:{Chatting:$,RoomList:G,UserList:tt}},st=et,nt=(0,a.Z)(st,O,N,!1,null,null,null),ot=nt.exports,it=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container",attrs:{id:"main-container"}},[t.session?t._e():e("div",{attrs:{id:"join"}},[t._m(0),e("div",{staticClass:"jumbotron vertical-center",attrs:{id:"join-dialog"}},[e("h1",[t._v("Join a video session")]),e("div",{staticClass:"form-group"},[e("p",[e("label",[t._v("Participant")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.myUserName,expression:"myUserName"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.myUserName},on:{input:function(e){e.target.composing||(t.myUserName=e.target.value)}}})]),e("p",[e("label",[t._v("Session")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.mySessionId,expression:"mySessionId"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.mySessionId},on:{input:function(e){e.target.composing||(t.mySessionId=e.target.value)}}})]),e("p",{staticClass:"text-center"},[e("button",{staticClass:"btn btn-lg btn-success",on:{click:function(e){return t.joinSession()}}},[t._v("Join!")])])])])]),t.session?e("div",{attrs:{id:"session"}},[e("div",{attrs:{id:"session-header"}},[e("h1",{attrs:{id:"session-title"}},[t._v(t._s(t.mySessionId))]),e("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"Leave session"},on:{click:t.leaveSession}}),t.videoMute?t._e():e("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"비디오 중지"},on:{click:t.videoControl}}),t.videoMute?e("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"비디오 시작"},on:{click:t.videoControl}}):t._e(),t.audioMute?t._e():e("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"오디오 중지"},on:{click:t.audioControl}}),t.audioMute?e("input",{staticClass:"btn btn-large btn-danger",attrs:{type:"button",id:"buttonLeaveSession",value:"오디오 시작"},on:{click:t.audioControl}}):t._e(),e("input",{directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],attrs:{type:"text"},domProps:{value:t.msg},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMSG.apply(null,arguments)},input:function(e){e.target.composing||(t.msg=e.target.value)}}}),e("h1",[t._v("팀 점수")]),e("h2",[t._v("team1 "+t._s(t.score1))]),e("h2",[t._v("team2 "+t._s(t.score2))])]),e("div",{staticClass:"col-md-6",attrs:{id:"main-video"}},[e("user-video",{attrs:{"stream-manager":t.mainStreamManager}}),e("canvas",{staticStyle:{display:"none"},attrs:{id:"main-video-canvas"}})],1),e("div",{attrs:{id:"label-container"}}),e("div",{staticClass:"col-md-6",attrs:{id:"video-container"}},[e("user-video",{attrs:{"stream-manager":t.publisher},nativeOn:{click:function(e){return t.updateMainVideoStreamManager(t.publisher)}}}),t._l(t.subscribers,(function(s){return e("user-video",{key:s.stream.connection.connectionId,attrs:{"stream-manager":s},nativeOn:{click:function(e){return t.updateMainVideoStreamManager(s)}}})}))],2)]):t._e(),t.session?e("div",[e("h2",[t._v("채팅")]),t._l(t.chat,(function(s){return e("p",{key:s},[t._v(t._s(s))])})),e("h1",[t._v("개인 점수")]),t._l(t.personalScore,(function(s,n){return e("p",{key:n},[t._v(t._s(s))])}))],2):t._e()])},at=[function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"img-div"}},[e("img",{attrs:{src:s(9713)}})])}],rt=(s(6699),s(9669)),lt=s.n(rt),ut=s(4905),ct=function(){var t=this,e=t._self._c;return t.streamManager?e("div",[e("ov-video",{attrs:{"stream-manager":t.streamManager}}),e("div",[e("p",[t._v(t._s(t.clientData))])])],1):t._e()},dt=[],mt=function(){var t=this,e=t._self._c;return e("video",{attrs:{autoplay:""}})},pt=[],ht={name:"OvVideo",props:{streamManager:Object},mounted(){this.streamManager.addVideoElement(this.$el)}},vt=ht,gt=(0,a.Z)(vt,mt,pt,!1,null,null,null),ft=gt.exports,bt={name:"UserVideo",components:{OvVideo:ft},props:{streamManager:Object},computed:{clientData(){const{clientData:t}=this.getConnectionData();return t}},methods:{getConnectionData(){const{connection:t}=this.streamManager.stream;return JSON.parse(t.data.split("%/%")[0])}}},_t=bt,yt=(0,a.Z)(_t,ct,dt,!1,null,null,null),wt=yt.exports;lt().defaults.headers.post["Content-Type"]="application/json";const kt="https://teachablemachine.withgoogle.com/models/w6iITyYRf/";let xt,Ct,St,Pt,Mt;var It={name:"App",components:{UserVideo:wt},data(){return{OV:void 0,session:void 0,mainStreamManager:void 0,publisher:void 0,subscribers:[],mySessionId:"SessionA",myUserName:"Participant"+Math.floor(100*Math.random()),videoMute:!1,audioMute:!1,msg:"",chat:[],status:0,team1:[],team2:[],personalScore:{a:0,b:0,c:0,d:0,e:0,f:0},score1:0,score2:0}},methods:{sendMSG(){this.session.signal({data:`${this.myUserName} : ${this.msg}`,to:[],type:"my-chat"}).then((()=>{console.log("Message successfully sent")})).catch((t=>{console.error(t)})),this.msg=""},joinSession(){this.OV=new ut.Dn,this.session=this.OV.initSession(),this.session.on("streamCreated",(t=>{console.log(t),console.log("hear");const e=this.session.subscribe(t.stream);this.subscribers.push(e);const{connection:s}=t.stream,{clientData:n,team_num:o}=JSON.parse(s.data.split("%/%")[0]);o%2==1?this.team1.push(n):this.team2.push(n)})),this.session.on("streamDestroyed",(({stream:t})=>{const e=this.subscribers.indexOf(t.streamManager,0);e>=0&&this.subscribers.splice(e,1)})),this.session.on("exception",(({exception:t})=>{console.warn(t)})),this.session.on("signal:my-chat",(t=>{console.log(`메시지 수신: ${t.data}`),this.chat.push(t.data),console.log(t.from),console.log(t.type)})),this.session.on("signal:score",(t=>{console.log(t.data),this.team1.includes(t.data)?this.score1+=1:this.score2+=1,this.personalScore[`${t.data}`]+=1,console.log(t.from),console.log(t.type)})),this.getToken(this.mySessionId,this.myUserName),this.init(),window.addEventListener("beforeunload",this.leaveSession)},leaveSession(){this.session&&this.session.disconnect(),this.session=void 0,this.mainStreamManager=void 0,this.publisher=void 0,this.subscribers=[],this.OV=void 0,window.removeEventListener("beforeunload",this.leaveSession)},updateMainVideoStreamManager(t){this.mainStreamManager!==t&&(this.mainStreamManager=t)},videoControl(){this.videoMute?(this.publisher.publishVideo(!0),this.videoMute=!1):(this.publisher.publishVideo(!1),this.videoMute=!0)},audioControl(){this.audioMute?(this.publisher.publishAudio(!0),this.audioMute=!1):(this.publisher.publishAudio(!1),this.audioMute=!0)},getToken(t,e){lt().post("https://localhost:8080/api/v1/rooms/get-token",{sessionName:t,id:e}).then((t=>{console.log(t.data.response);const s=t.data.response[0],n=t.data.response[1];n%2==1?this.team1.push(e):this.team2.push(e),this.session.connect(s,{clientData:this.myUserName,team_num:n}).then((()=>{let t=this.OV.initPublisher(void 0,{audioSource:void 0,videoSource:void 0,publishAudio:!0,publishVideo:!0,resolution:"640x480",frameRate:30,insertMode:"APPEND",mirror:!0});this.mainStreamManager=t,console.log(this.mainStreamManager),this.publisher=t,this.session.publish(this.publisher)})).catch((t=>{console.log("There was an error connecting to the session:",t.code,t.message)}))}))},async init(){const t=kt+"model.json",e=kt+"metadata.json";xt=await tmPose.load(t,e),Mt=xt.getTotalClasses();const s=!0;Ct=new tmPose.Webcam(200,200,s),await Ct.setup(),Ct.play(),window.requestAnimationFrame(this.loop);const n=document.getElementById("main-video-canvas");n.width=200,n.height=200,St=n.getContext("2d"),Pt=document.getElementById("label-container");for(let o=0;o<Mt;o++)Pt.appendChild(document.createElement("div"))},async loop(t){Ct.update(),await this.predict(),window.requestAnimationFrame(this.loop)},async predict(){const{pose:t,posenetOutput:e}=await xt.estimatePose(Ct.canvas),s=await xt.predict(e);s[0].probability.toFixed(2)>=.99?(1==this.status&&this.session.signal({data:this.myUserName,to:[],type:"score"}).then((()=>{console.log("Message successfully sent")})).catch((t=>{console.error(t)})),this.status=0):s[1].probability.toFixed(2)>=.99&&(this.status=1);for(let n=0;n<Mt;n++){const t=s[n].className+": "+s[n].probability.toFixed(2);Pt.childNodes[n].innerHTML=t}},drawPose(t){if(St.drawImage(Ct.canvas,0,0),t){const e=.5;tmPose.drawKeypoints(t.keypoints,e,St),tmPose.drawSkeleton(t.keypoints,e,St)}}}},Ot=It,Nt=(0,a.Z)(Ot,it,at,!1,null,null,null),Zt=Nt.exports;n.ZP.use(c.Z);const jt=[{path:"/",name:"home",component:g},{path:"/login",name:"login",component:k},{path:"/signup",name:"signup",component:I},{path:"/waiting",name:"waiting",component:ot},{path:"/room",name:"room",component:Zt}],Lt=new c.Z({mode:"history",base:"/",routes:jt});var Ut=Lt,Vt=s(629),$t={state:{},getters:{},mutations:{},actions:{}};n.ZP.use(Vt.ZP);var Dt=new Vt.ZP.Store({modules:{accounts:$t}});n.ZP.config.productionTip=!1,new n.ZP({router:Ut,store:Dt,render:t=>t(u)}).$mount("#app")},9713:function(t,e,s){t.exports=s.p+"img/openvidu_grey_bg_transp_cropped.9bbabff2.png"},5665:function(t,e,s){t.exports=s.p+"img/background.40d47c0d.png"}},e={};function s(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(i.exports,i,i.exports,s),i.loaded=!0,i.exports}s.m=t,function(){var t=[];s.O=function(e,n,o,i){if(!n){var a=1/0;for(c=0;c<t.length;c++){n=t[c][0],o=t[c][1],i=t[c][2];for(var r=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(s.O).every((function(t){return s.O[t](n[l])}))?n.splice(l--,1):(r=!1,i<a&&(a=i));if(r){t.splice(c--,1);var u=o();void 0!==u&&(e=u)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[n,o,i]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){s.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){s.p="/"}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,n){var o,i,a=n[0],r=n[1],l=n[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(l)var c=l(s)}for(e&&e(n);u<a.length;u++)i=a[u],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(c)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=s.O(void 0,[998],(function(){return s(5646)}));n=s.O(n)})();
//# sourceMappingURL=app.c58be817.js.map