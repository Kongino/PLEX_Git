(function(e){function n(n){for(var i,s,a=n[0],c=n[1],d=n[2],l=0,b=[];l<a.length;l++)s=a[l],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&b.push(r[s][0]),r[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(n);while(b.length)b.shift()();return o.push.apply(o,d||[]),t()}function t(){for(var e,n=0;n<o.length;n++){for(var t=o[n],i=!0,a=1;a<t.length;a++){var c=t[a];0!==r[c]&&(i=!1)}i&&(o.splice(n--,1),e=s(s.s=t[0]))}return e}var i={},r={app:0},o=[];function s(n){if(i[n])return i[n].exports;var t=i[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=i,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)s.d(t,i,function(n){return e[n]}.bind(null,i));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=n,a=a.slice();for(var d=0;d<a.length;d++)n(a[d]);var u=c;o.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var i=t("7a23"),r={id:"main-container",class:"container"},o={key:0,id:"join"},s=Object(i["d"])("div",{id:"img-div"},[Object(i["d"])("img",{src:"resources/images/openvidu_grey_bg_transp_cropped.png"})],-1),a={id:"join-dialog",class:"jumbotron vertical-center"},c=Object(i["d"])("h1",null,"Join a video session",-1),d={class:"form-group"},u=Object(i["d"])("label",null,"Participant",-1),l=Object(i["d"])("label",null,"Session",-1),b={class:"text-center"},p={key:1,id:"session"},m={id:"session-header"},v={id:"session-title"},f={id:"main-video",class:"col-md-6"},h={id:"video-container",class:"col-md-6"};function O(e,n,t,O,j,g){var y=Object(i["h"])("user-video");return Object(i["f"])(),Object(i["b"])("div",r,[j.session?Object(i["c"])("",!0):(Object(i["f"])(),Object(i["b"])("div",o,[s,Object(i["d"])("div",a,[c,Object(i["d"])("div",d,[Object(i["d"])("p",null,[u,Object(i["k"])(Object(i["d"])("input",{"onUpdate:modelValue":n[1]||(n[1]=function(e){return j.myUserName=e}),class:"form-control",type:"text",required:""},null,512),[[i["j"],j.myUserName]])]),Object(i["d"])("p",null,[l,Object(i["k"])(Object(i["d"])("input",{"onUpdate:modelValue":n[2]||(n[2]=function(e){return j.mySessionId=e}),class:"form-control",type:"text",required:""},null,512),[[i["j"],j.mySessionId]])]),Object(i["d"])("p",b,[Object(i["d"])("button",{class:"btn btn-lg btn-success",onClick:n[3]||(n[3]=function(e){return g.joinSession()})},"Join!")])])])])),j.session?(Object(i["f"])(),Object(i["b"])("div",p,[Object(i["d"])("div",m,[Object(i["d"])("h1",v,Object(i["i"])(j.mySessionId),1),Object(i["d"])("input",{class:"btn btn-large btn-danger",type:"button",id:"buttonLeaveSession",onClick:n[4]||(n[4]=function(){return g.leaveSession&&g.leaveSession.apply(g,arguments)}),value:"Leave session"})]),Object(i["d"])("div",f,[Object(i["d"])(y,{"stream-manager":j.mainStreamManager},null,8,["stream-manager"])]),Object(i["d"])("div",h,[Object(i["d"])(y,{"stream-manager":j.publisher,onClick:n[5]||(n[5]=function(e){return g.updateMainVideoStreamManager(j.publisher)})},null,8,["stream-manager"]),(Object(i["f"])(!0),Object(i["b"])(i["a"],null,Object(i["g"])(j.subscribers,(function(e){return Object(i["f"])(),Object(i["b"])(y,{key:e.stream.connection.connectionId,"stream-manager":e,onClick:function(n){return g.updateMainVideoStreamManager(e)}},null,8,["stream-manager","onClick"])})),128))])])):Object(i["c"])("",!0)])}t("a434");var j=t("bc3a"),g=t.n(j),y=t("3d9c"),S={key:0};function M(e,n,t,r,o,s){var a=Object(i["h"])("ov-video");return t.streamManager?(Object(i["f"])(),Object(i["b"])("div",S,[Object(i["d"])(a,{"stream-manager":t.streamManager},null,8,["stream-manager"]),Object(i["d"])("div",null,[Object(i["d"])("p",null,Object(i["i"])(s.clientData),1)])])):Object(i["c"])("",!0)}t("ac1f"),t("1276");var w={autoplay:""};function k(e,n,t,r,o,s){return Object(i["f"])(),Object(i["b"])("video",w)}var V={name:"OvVideo",props:{streamManager:Object},mounted:function(){this.streamManager.addVideoElement(this.$el)}},x=t("6b0d"),P=t.n(x);const _=P()(V,[["render",k]]);var C=_,U={name:"UserVideo",components:{OvVideo:C},props:{streamManager:Object},computed:{clientData:function(){var e=this.getConnectionData(),n=e.clientData;return n}},methods:{getConnectionData:function(){var e=this.streamManager.stream.connection;return JSON.parse(e.data.split("%/%")[0])}}};const D=P()(U,[["render",M]]);var N=D;g.a.defaults.headers.post["Content-Type"]="application/json";var T={name:"App",components:{UserVideo:N},data:function(){return{OV:void 0,session:void 0,mainStreamManager:void 0,publisher:void 0,subscribers:[],mySessionId:"SessionA",myUserName:"Participant"+Math.floor(100*Math.random())}},methods:{joinSession:function(){var e=this;this.OV=new y["OpenVidu"],this.session=this.OV.initSession(),this.session.on("streamCreated",(function(n){var t=n.stream,i=e.session.subscribe(t);e.subscribers.push(i)})),this.session.on("streamDestroyed",(function(n){var t=n.stream,i=e.subscribers.indexOf(t.streamManager,0);i>=0&&e.subscribers.splice(i,1)})),this.session.on("exception",(function(e){var n=e.exception;console.warn(n)})),this.getToken(this.mySessionId,this.myUserName),window.addEventListener("beforeunload",this.leaveSession)},leaveSession:function(){this.session&&this.session.disconnect(),this.session=void 0,this.mainStreamManager=void 0,this.publisher=void 0,this.subscribers=[],this.OV=void 0,window.removeEventListener("beforeunload",this.leaveSession)},updateMainVideoStreamManager:function(e){this.mainStreamManager!==e&&(this.mainStreamManager=e)},getToken:function(e,n){var t=this;g.a.post("https://localhost:8080/api/v1/rooms/get-token",{sessionName:e,id:n}).then((function(e){console.log(e.data[0]);var n=e.data[0];t.session.connect(n,{clientData:t.myUserName}).then((function(){var e=t.OV.initPublisher(void 0,{audioSource:void 0,videoSource:void 0,publishAudio:!0,publishVideo:!0,resolution:"640x480",frameRate:30,insertMode:"APPEND",mirror:!1});t.mainStreamManager=e,console.log(t.mainStreamManager),t.publisher=e,t.session.publish(t.publisher)})).catch((function(e){console.log("There was an error connecting to the session:",e.code,e.message)}))}))}}};const I=P()(T,[["render",O]]);var J=I;i["default"].config.productionTip=!1,new i["default"]({render:function(e){return e(J)}}).$mount("#app")}});
//# sourceMappingURL=app.c6a6f830.js.map